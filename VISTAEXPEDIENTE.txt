@model BP.SIREC.UI.Models.Consultas.Pestañas.ExpedienteJudicialViewModel
@using BP.SIREC.SHARED.Entities.Catalogo;
@using BP.SIREC.SHARED.Entities.Cobro;
@using BP.SIREC.UI.Models.Components.GridView;
@using BP.SIREC.SHARED.Entities.RematesAdjudicaciones;

<style>
    .btn-outline-bp-primary {
        background-color: white
    }
</style>

@{
    int contadorExpedienteHeader = 0;
    int contadorExpedienteBody = 0;

    Dictionary<int, string> Condicion = new Dictionary<int, string>();
    Condicion.Add(0, "Adjudicado al banco");
    Condicion.Add(1, "Adjudicado a un tercero");

    Dictionary<bool, string> Estado = new Dictionary<bool, string>();
    Estado.Add(true, "Activo");
    Estado.Add(false, "Inactivo");

    int estadoTramite = ViewBag.EstadoTramite;

    GridViewModel<VI_Rel_Expediente_CodigoGestion> RegistroNuevoCodGR = new GridViewModel<VI_Rel_Expediente_CodigoGestion>();
    string controllerName = "CalculadoraDemandaLiquidacion";

    int TabFechaSentencia = (ViewBag.TabFechaSentencia != 0 ? ViewBag.TabFechaSentencia : 0);
}

<h6 class="titulo">Expedientes Judiciales</h6>

<button id="btnCrearExpediente" type="button" class="btn btn-outline-bp-primary mt-2">
    <i class="fas fa-plus mr-2"></i> Agregar Expediente
</button>

<button id="btnExpedienteExistente" type="button" class="btn btn-outline-bp-primary mt-2">
    <i class="fas fa-plus mr-2"></i> Agregar Expediente Existente
</button>

<div class="container-fluid mt-3" id="tabs">

    <ul class="nav nav-tabs nav-justified" role="tablist">

        @if (Model.LstExpedientes != null)
        {
            @foreach (var expediente in Model.LstExpedientes)
            {
                contadorExpedienteHeader++;

                <li class="nav-item">
                    <a class="@(contadorExpedienteHeader == 1 ? "nav-link navTabsExpedienteCJ active" : "navTabsExpedienteCJ nav-link")" data-toggle="tab" role="tab" href=@("#expediente-" + expediente.IdExpediente) aria-selected="@(contadorExpedienteHeader == 0 ? "true" : "false")">Expediente @contadorExpedienteHeader</a>
                </li>
            }
        }

        <li class="nav-item d-none" id="tabExpedienteNuevo">
            <a class="nav-link" id="linkNuevoExpediente" data-toggle="tab" role="tab" href="#nuevoExpediente">Nuevo Expediente</a>
        </li>
    </ul>


    <div class="tab-content">
        @if (Model.LstExpedientes != null)
        {
            @foreach (var expedienteRegistrado in Model.LstExpedientes)
            {
                contadorExpedienteBody++;

                <div class="@(contadorExpedienteBody == 1 ? "tabsExpedienteCJ tab-pane fade show active" : "tabsExpedienteCJ tab-pane fade")" role="tabpanel" id=@("expediente-" + expedienteRegistrado.IdExpediente)>
                    <ul class="nav nav-pills nav-fill">
                        <li class="nav-item">
                            <a class="nav-link active lnkOpciones btn btn-outline-bp-primary mt-2" aria-current="page" href="#" data-showtab=@("contenedorExp"+ expedienteRegistrado.IdExpediente) style="border-radius: 0; box-shadow: 3px 3px 5px lightgrey;">Datos Expediente</a>
                        </li>
                        <li class="nav-item" style="@( expedienteRegistrado.FechaPresentacionDemanda != null ? "" : "display:none")">
                            <a class="nav-link lnkOpciones btn btn-outline-bp-primary mt-2" href="#" data-showtab=@("calcint" + expedienteRegistrado.IdExpediente) style="border-radius: 0; box-shadow: 3px 3px 5px lightgrey; ">Cálculo Intereses</a>
                        </li>
                    </ul>
                    <hr />

                    <div class="container-fluid mt-2 containerExpediente" id="@("ActualizarExpedienteModel-" + @expedienteRegistrado.IdExpediente)">

                        <div id=@("contenedorExp"+ expedienteRegistrado.IdExpediente) class="panelExp">

                            <div id=@("datosExp"+ expedienteRegistrado.IdExpediente)>

                                <div class="row mb-2">
                                    @*<div class="col-12 col-md-3">*@
                                        <input type="hidden" asp-name="@expedienteRegistrado.IdExpediente" value="@expedienteRegistrado.IdExpediente" />
                                    @*</div>*@

                                    @if (estadoTramite == 5)
                                    {
                                        <div class="col-12 col-md-3">
                                            <select id="cboEtapa" class="selectpicker show-tick" title="..." asp-label="Etapa" asp-name="@expedienteRegistrado.Etapa"
                                                    select-items="@Model.LstEtapas" select-item-value="IdEtapa" select-item-name="NombreEtapa" select-selected-value="@expedienteRegistrado.Etapa"
                                                    data-width="100%" data-style="border" disabled></select>
                                        </div>
                                    }
                                    <div class="col-12 col-md-3">
                                        <select id="cboTipoGarantia" class="selectpicker show-tick" title="Seleccione una opción..." asp-label="Tipo de Garantía" asp-name="@expedienteRegistrado.TipoGarantia"
                                                select-items="@Model.LstGarantias" select-item-value="Codigo" select-item-name="Descripcion" select-selected-value="@expedienteRegistrado.TipoGarantia"
                                                data-width="100%" data-style="border" asp-validate="true"></select>
                                    </div>

                                    <div class="col-12 col-md-3">
                                        <RadioButtonsGroup class="radio" asp-label="Aprobado" asp-name="@expedienteRegistrado.ChecklistAprobado" asp-value="@expedienteRegistrado.ChecklistAprobado" asp-validate="true">
                                            <RadioButtonItem class="btn btn-outline-info" data-type="boolean" data-nullable="true" value="true" label="Sí" />
                                            <RadioButtonItem class="btn btn-outline-info" data-type="boolean" data-nullable="true" value="false" label="No" />
                                        </RadioButtonsGroup>
                                    </div>

                                </div>
                                <div id="@("cuantiaGrp-" + expedienteRegistrado.IdExpediente)">
                                    <div class="row mb-2">

                                        @if (estadoTramite == 5)
                                        {

                                            <div class="col-12 col-md-4">
                                                <input id="@("txtCuantia-" + expedienteRegistrado.IdExpediente)" class="form-control" asp-label="Cuantía" asp-name="@expedienteRegistrado.Cuantia"
                                                       data-type="decimal" value="@expedienteRegistrado.Cuantia" asp-decimal-digits="2" asp-validate="true" disabled />
                                            </div>

                                            <div class="col-12 col-md-3">
                                                <input id="fechatraslado" type="date" class="form-control" asp-label="Fecha de traslado"
                                                       asp-name="@expedienteRegistrado.FechaTraslado" value="@expedienteRegistrado.FechaTraslado?.ToString("dd/MM/yyyy")"
                                                       asp-datepicker="true" asp-datepicker-format="DD/MM/YYYY" asp-validate="true" />
                                            </div>
                                        }
                                    </div>

                                    <div class="row mb-2">
                                        @if (@estadoTramite == 5)
                                        {
                                            <div class="col-12 col-md-3">
                                                <input type="text" id="@("txtNumExpedienteJudicial-" + expedienteRegistrado.IdExpediente)" maxlength="17" value="@expedienteRegistrado.NumExpedienteJudicial" 
                                                    asp-name="@expedienteRegistrado.NumExpedienteJudicial" class="form-control" asp-label="Número Expediente Judicial" asp-validate="true" />
                                            </div>

                                            <div class="col-12 col-md-3">
                                                <input type="text" id="annio" onkeypress='return event.charCode >= 48 && event.charCode <= 57' maxlength="4" data-type="integer"
                                                       value="@expedienteRegistrado.Annio" class="form-control" asp-label="Año" asp-name="@expedienteRegistrado.Annio" asp-plain-numeric-text="true" asp-validate="true" />
                                            </div>
                                        }
                                        <div class="col-12 @(estadoTramite == 5 ? "col-md-3" : "col-md-4")">

                                            @if (expedienteRegistrado.FechaPresentacionDemanda.HasValue)
                                            {
                                                <input id="@("txtFechaDemanda-" + expedienteRegistrado.IdExpediente)" type="date" class="form-control" asp-label="Fecha Presentación de la Demanda"
                                                       asp-name="@expedienteRegistrado.FechaPresentacionDemanda" value="@expedienteRegistrado.FechaPresentacionDemanda?.ToString("dd/MM/yyyy")"
                                                       asp-datepicker="true" asp-datepicker-format="DD/MM/YYYY" asp-validate="true" disabled />
                                            }
                                            else
                                            {
                                                <input id="@("txtFechaDemanda-" + expedienteRegistrado.IdExpediente)" type="date" class="form-control" asp-label="Fecha Presentación de Demanda"
                                                       asp-name="@expedienteRegistrado.FechaPresentacionDemanda" value="@expedienteRegistrado.FechaPresentacionDemanda?.ToString("dd/MM/yyyy")"
                                                       asp-datepicker="true" asp-datepicker-format="DD/MM/YYYY" asp-validate="true" />
                                            }

                                        </div>
                                        <div class="col-12 col-md-3">
                                            <input id="@("txtFechaTerminado-" + expedienteRegistrado.IdExpediente)" type="date" class="form-control" asp-label="Fecha Terminado"
                                                   asp-name="@expedienteRegistrado.FechaTerminado" value="@expedienteRegistrado.FechaTerminado?.ToString("dd/MM/yyyy")"
                                                   asp-datepicker="true" asp-datepicker-format="DD/MM/YYYY" asp-validate="true" />

                                        </div>
                                        <div class="col-12 col-md-3">
                                            <RadioButtonsGroup class="radio" asp-label="Apersonamiento" asp-name="@expedienteRegistrado.EsApersonamiento" asp-value="@expedienteRegistrado.EsApersonamiento" asp-validate="true">
                                                <RadioButtonItem class="btn btn-outline-info" data-type="boolean" data-nullable="true" value="true" label="Sí" />
                                                <RadioButtonItem class="btn btn-outline-info" data-type="boolean" data-nullable="true" value="false" label="No" />
                                            </RadioButtonsGroup>
                                        </div>
                                    </div>
                                </div>

                                <div class="row mb-5">
                                    @if (estadoTramite == 5)
                                    {
                                        <div class="col-12 col-md-3">
                                            <select id="cboEtapasProceso" class="selectpicker form-control" title="Seleccione una opción..." asp-label="Avance Judicial" asp-name="@expedienteRegistrado.EtapaProceso"
                                                    select-items="@Model.LstEtapasProceso" select-item-value="IdEtapaProceso" select-item-name="IdEtapaProceso,Descripcion"
                                                    select-item-name-format="{0} - {1}" select-selected-value="@expedienteRegistrado.EtapaProceso"
                                                    data-width="100%" data-style="border" data-live-search="true" asp-validate="true"></select>
                                        </div>

                                        <div class="col-12 col-md-3">
                                            <select id="txtEstadoActualizacion" class="selectpicker show-tick" title="Seleccione una opción..." asp-label="Estado de la Actualización" asp-name="@expedienteRegistrado.IdExpedienteJudicialEstado"
                                                    select-items="@Model.LstEstadosExpediente" select-item-value="IdExpedJudicEstado" select-item-name="NombreExpedJudicEstado" select-selected-value="@expedienteRegistrado.IdExpedienteJudicialEstado"
                                                    data-width="100%" data-style="border" asp-validate="true"></select>
                                        </div>
                                    }
                                <div class="col-12 col-md-4 d-flex justify-content-between">
                                    <div class="w-75 pr-2">
                                        @if (expedienteRegistrado.CondicionAbogado == 0)
                                        {
                                            <input type="hidden" asp-name="@expedienteRegistrado.CondicionAbogado" value="expedienteRegistrado.CondicionAbogado" />
                                            <select id="cboCodAbogados" class="selectpicker form-control" title="..." asp-label="Código Abogado"
                                                    asp-name="@expedienteRegistrado.IdCodigoAbogado"
                                                    select-items="@Model.LstCodigosAbogadosExternos"
                                                    select-item-value="Id" select-item-name="Codigo,NombreCompleto" select-item-name-format="{0} - {1}"
                                                    select-selected-value="@expedienteRegistrado.IdCodigoAbogado"
                                                    data-width="100%" data-style="border" data-live-search="true" disabled asp-validate="true"></select>
                                        }
                                        else
                                        {
                                            <input type="hidden" asp-name="@expedienteRegistrado.CondicionAbogado" value="expedienteRegistrado.CondicionAbogado" />
                                            <select id="cboCodAbogados" class="selectpicker form-control" title="..." asp-label="Código Abogado"
                                                    asp-name="@expedienteRegistrado.IdCodigoAbogado"
                                                    select-items="@Model.LstCodigosAbogadosInternos"
                                                    select-item-value="Id" select-item-name="Codigo,NombreCompleto" select-item-name-format="{0} - {1}"
                                                    select-selected-value="@expedienteRegistrado.IdCodigoAbogado"
                                                    data-width="100%" data-style="border" data-live-search="true" asp-validate="true"></select>
                                        }
                                    </div>
                                    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#solicitarCambioCodigoModal">
                                        Solicitar cambio de código
                                    </button>
                                </div>
                                </div>
                                <div class="row mb-5">
                                    @if (estadoTramite == 5)
                                    {
                                        <div class="col-md-4">
                                            <select id="cboTipoProcesos" class="selectpicker show-tick" title="Seleccione una opción..." asp-label="Tipo de Proceso" asp-validate="true"
                                                    select-items="@Model.LstTipoProceso" select-item-value="Codigo" select-item-name="Descripcion" select-selected-value="@ViewBag.IdTipoProcesoJudicial"
                                                    name="IdTipoProcesoJudicial" data-width="100%" data-style="border" data-live-search="true"></select>
                                        </div>
                                        <div class="col-md-5">
                                            <input type="text" class="form-control" asp-label="Expectativa de Recuperación" name="ExpectativaRecuperacion" value="@ViewBag.ExpectativaRecuperacion" readonly />
                                        </div>

                                    }

                                <div class="col-md-3">
                                    <input type="text" class="form-control" asp-label="Id Nómina Distribución" name="idnomina" value="@ViewBag.IdNomina" readonly />
                                    <input id="txtNumExpedienteJudicialHidden" type="hidden" asp-name="@expedienteRegistrado.NumExpedienteJudicial" value="@expedienteRegistrado.NumExpedienteJudicial" />
                                </div>
                                </div>

                                <div class="row mb-5">

                                    <div class="col-12 col-md-3">
                                        <input id="fechaUltimoPago" type="date" class="form-control" asp-label="Fecha último pago" asp-validate="true"
                                               asp-name="@Model.FechaUltimoPago" value="@Model.FechaUltimoPago?.ToString("dd/MM/yyyy")"
                                               asp-datepicker="true" asp-datepicker-format="DD/MM/YYYY" readonly="readonly" />
                                    </div>
                                    <div class="col-12 col-md-3">
                                        <select id="cboGestorEtapa1" class="selectpicker form-control" title="Seleccione una opción..." asp-label="Gestor Etapa 1" asp-name="@expedienteRegistrado.IdGestorEtapa1"
                                                select-items="@Model.LstGestorEtapa1" select-item-value="IdUsuario" select-item-name="NombreCompleto"
                                                select-selected-value="@expedienteRegistrado.IdGestorEtapa1"
                                                data-width="100%" data-style="border" data-live-search="true" asp-validate="true"></select>
                                    </div>
                                    @if (@estadoTramite == 5)
                                    {
                                        <div class="col-12 col-md-3">
                                            <select id="cboGestorEtapa2" class="selectpicker form-control" title="Seleccione una opción..." asp-label="Gestor Etapa 2" asp-name="@expedienteRegistrado.IdGestorEtapa2"
                                                    select-items="@Model.LstGestorEtapa2" select-item-value="IdUsuario" select-item-name="NombreCompleto"
                                                    select-selected-value="@expedienteRegistrado.IdGestorEtapa2"
                                                    data-width="100%" data-style="border" data-live-search="true" asp-validate="true"></select>
                                        </div>
                                    }
                                </div>


                                <div class="row">
                                    <div class="card-body d-flex justify-content-end align-items-end">
                                        <button id="btnGuardarEJ @expedienteRegistrado.IdExpediente" IdExpediente="@expedienteRegistrado.IdExpediente" type="button" class="btn btn-outline-success btnActualizarExpediente"><i class="far fa-save mr-2"></i>Guardar Registro</button>
                                    </div>
                                </div>
                            </div>


                            <hr />

                            @if (estadoTramite == 5)
                            {
                                <div id="@("contenedorProCanDis-" + expedienteRegistrado.IdExpediente)">
                                    <div class="mb-5">
                                        <p>Seleccionar despacho por Provincia/Cantón/Distrito</p>
                                        <div class="row">
                                            <div class="col-12 col-md-4">
                                                @*select-items="@Model.LstProvincias" select-item-value="CodProvincia" select-item-name="Descripcion" select-selected-value="@expedienteRegistrado.ProvinciaCircuitJudic"*@
                                                <select id="@("ddlProvincias" + expedienteRegistrado.IdExpediente)" class="selectpicker show-tick" title="Seleccione una opción..." asp-label="Provincia" asp-name="@expedienteRegistrado.ProvinciaCircuitJudic" name="ProvinciaCircuitJudic"
                                                        data-width="100%" data-style="border" data-live-search="true" asp-validate="true">
                                                    @{
                                                        if (Model.LstProvincias != null && Model.LstProvincias.Count > 0)
                                                        {
                                                            foreach (Provincia provincia in Model.LstProvincias)
                                                            {
                                                                if (provincia.CodProvincia == expedienteRegistrado.ProvinciaCircuitJudic)
                                                                {
                                                                    <option provincia="@provincia.CodProvincia" value="@provincia.CodProvincia" selected>@provincia.Descripcion</option>

                                                                }
                                                                else
                                                                {
                                                                    <option provincia="@provincia.CodProvincia" value="@provincia.CodProvincia">@provincia.Descripcion</option>

                                                                }
                                                            }
                                                        }

                                                    }
                                                </select>
                                            </div>

                                            <div class="col-12 col-md-4">
                                                <select id="@("ddlCantones" + expedienteRegistrado.IdExpediente)" class="selectpicker show-tick" title="Seleccione una opción..." asp-label="Cantón" asp-name="@expedienteRegistrado.CantonCircuitJudic" name="CantonCircuitJudic"
                                                        data-width="100%" data-style="border" data-live-search="true" asp-validate="true">
                                                    @{
                                                        if (Model.LstCantones != null && Model.LstCantones.Count > 0)
                                                        {
                                                            foreach (Canton canton in Model.LstCantones)
                                                            {
                                                                if (canton.CodProvincia == expedienteRegistrado.ProvinciaCircuitJudic && canton.CodCanton == expedienteRegistrado.CantonCircuitJudic)
                                                                {
                                                                    <option provincia="@canton.CodProvincia" value="@canton.CodCanton" selected>@canton.Descripcion</option>

                                                                }
                                                                else
                                                                {
                                                                    <option provincia="@canton.CodProvincia" value="@canton.CodCanton">@canton.Descripcion</option>
                                                                }
                                                            }
                                                        }
                                                    }
                                                </select>
                                            </div>

                                            <div class="col-12 col-md-4">
                                                <select id="@("ddlDistritos" + expedienteRegistrado.IdExpediente)" class="selectpicker show-tick" title="Seleccione una opción..." asp-label="Distrito" asp-name="@expedienteRegistrado.DistritoCircuitJudic" name="DistritoCircuitJudic"
                                                        data-width="100%" data-style="border" data-live-search="true" asp-validate="true">
                                                    @{
                                                        if (Model.LstDistritos != null && Model.LstDistritos.Count > 0)
                                                        {
                                                            foreach (Distrito distrito in Model.LstDistritos)
                                                            {
                                                                if (distrito.CodProvincia == expedienteRegistrado.ProvinciaCircuitJudic && distrito.CodCanton == expedienteRegistrado.CantonCircuitJudic && distrito.CodDistrito == expedienteRegistrado.DistritoCircuitJudic)
                                                                {
                                                                    <option provincia="@distrito.CodProvincia" canton="@distrito.CodCanton" value="@distrito.CodDistrito" selected>@distrito.Descripcion</option>

                                                                }
                                                                else
                                                                {
                                                                    <option provincia="@distrito.CodProvincia" canton="@distrito.CodCanton" value="@distrito.CodDistrito">@distrito.Descripcion</option>

                                                                }
                                                            }
                                                        }
                                                    }
                                                </select>
                                            </div>
                                        </div>
                                    </div>


                                    <div class="row mb-2">
                                        <div class="col-12 col-md-6">
                                            <select id="circuitoJudicial" class="selectpicker show-tick" title="..." asp-label="Circuito Judicial" asp-name="@expedienteRegistrado.CircuitoJudicial" name="CircuitoJudicial"
                                                    data-width="100%" data-style="border" asp-validate="true" disabled>
                                                @{
                                                    if (Model.LstDespachoJudicial != null && Model.LstDespachoJudicial.Count > 0)
                                                    {
                                                        foreach (DespachoJudicial despacho in Model.LstDespachoJudicial)
                                                        {
                                                            <option codDespacho="@despacho.Codigo" value="@despacho.Codigo">@despacho.Descripcion</option>
                                                        }
                                                    }
                                                }
                                            </select>
                                        </div>
                                        <div class="col-12 col-md-6">
                                            <select id="autoridadJA" class="selectpicker show-tick" title="..." asp-label="Autoridad judicial administrativa" asp-name="@expedienteRegistrado.AutoridadJudicial" name="AutoridadJudicial"
                                                    data-width="100%" data-style="border" asp-validate="true" disabled>
                                                @{
                                                    if (Model.LstDespachoJudicial != null && Model.LstDespachoJudicial.Count > 0)
                                                    {
                                                        foreach (DespachoJudicial despacho in Model.LstDespachoJudicial)
                                                        {
                                                            <option codDespacho="@despacho.Codigo" value="@despacho.Codigo">@despacho.Descripcion</option>
                                                        }
                                                    }
                                                }
                                            </select>
                                        </div>
                                    </div>
                                </div>


                                <div class="row mb-2" id="@("contenedorUltimaGestion-" + expedienteRegistrado.IdExpediente)">
                                    <div class="col-12 col-md-6">
                                        <input id="@("txtFechaUltimaGestion-" + expedienteRegistrado.IdExpediente)" type="date" class="form-control" asp-label="Fecha última gestión"
                                               asp-name="@expedienteRegistrado.FechaUltimaGestion" value="@expedienteRegistrado.FechaUltimaGestion?.ToString("dd/MM/yyyy")"
                                               name="FechaUltimaGestion" asp-datepicker="true" asp-datepicker-format="DD/MM/YYYY" asp-validate="true" />
                                    </div>
                                    <div class="col-12 col-md-6">
                                        <input type="text" id="@("mesesUltimaGestion" + expedienteRegistrado.IdExpediente)" value="@expedienteRegistrado.MesesUltimaGestion" class="form-control"
                                               asp-validate="true" name="MesesUltimaGestion" asp-label="Meses de última gestión" asp-name="@expedienteRegistrado.MesesUltimaGestion" disabled />
                                    </div>
                                </div>
                            }
                            @if (TabFechaSentencia == 1)
                            {
                                <div class="row mb-2">
                                    <div class="col-12 col-md-4">
                                        @if (@expedienteRegistrado.FechaSentencia == null)
                                        {
                                            <input id="fechaSentencia" type="date" class="form-control" asp-label="Fecha Sentencia"
                                                    asp-name="@expedienteRegistrado.FechaSentencia" value="@expedienteRegistrado.FechaSentencia?.ToString("dd/MM/yyyy")"
                                                    asp-datepicker="true" asp-datepicker-format="DD/MM/YYYY" asp-validate="true" />
                                        }
                                        else
                                        {
                                            <input id="fechaSentencia" type="date" class="form-control" asp-label="Fecha Sentencia"
                                                    asp-name="@expedienteRegistrado.FechaSentencia" value="@expedienteRegistrado.FechaSentencia?.ToString("dd/MM/yyyy")"
                                                    asp-datepicker="true" asp-datepicker-format="DD/MM/YYYY" asp-validate="true" readonly />
                                        }
                                    </div>
                                </div>
                            }
                            <div class="row mb-2" id="@("contenedorCodigosGR-" + expedienteRegistrado.IdExpediente)">
                                <div class="col-12 col-md-12" id="@("info-container-" + expedienteRegistrado.IdExpediente)">
                                </div>
                            </div>

                            @if (estadoTramite == 5)
                            {
                                @if (Model.TipoGarantia == "H" || Model.TipoGarantia == "I" || Model.TipoGarantia == "P" || Model.TipoGarantia == "D" || Model.TipoGarantia == "F")
                                {
                                    <div class="row mb-2" id="">
                                        <div class="row mt-3">
                                            <div class="col-12 mb-2">
                                                <button btnValidarDocuEtapa1 type="button" class="btn btn-outline-success"
                                                        NumOperacion="@Model.NumOperacion"
                                                        IdExpediente="@expedienteRegistrado.IdExpediente"
                                                        IdTramiteCobro="@expedienteRegistrado.IdTramiteCobroJudicial">
                                                    <i class="far fa-plus mr-2"></i>Validar Documentación Pase Etapa 1
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                }

                                <div class="row mb-2 mt-4">
                                    <div class="col-12 col-md-4">
                                        <select id="cboCodGestionResolucionTrans" class="selectpicker form-control" title="Seleccione una opción..." asp-label="Código gestión resolución transitoria" asp-name="@expedienteRegistrado.CodigoGestionTransitoria"
                                                select-items="@Model.LstCodigosGestionResolucion" select-item-value="Codigo" select-item-name="CodigoInterno,Descripcion" select-item-name-format="{0} - {1}" select-selected-value="@expedienteRegistrado.CodigoGestionTransitoria"
                                                data-width="100%" data-style="border" data-live-search="true" asp-validate="true"></select>
                                    </div>
                                    <div class="col-12 col-md-4">
                                        <select id="cboCodGestionResolucionUlt" class="selectpicker form-control" title="Seleccione una opción..." asp-label="Código última resolución" asp-name="@expedienteRegistrado.CodigoUltimaResolucion"
                                                select-items="@Model.LstCodigosGestionResolucion" select-item-value="Codigo" select-item-name="CodigoInterno,Descripcion" select-item-name-format="{0} - {1}" select-selected-value="@expedienteRegistrado.CodigoUltimaResolucion"
                                                data-width="100%" data-style="border" data-live-search="true" asp-validate="true"></select>
                                    </div>
                                </div>
                            }

                            <div class="row mb-2">
                                @*<div class="col-12 col-md-4">
                                        @if (expedienteRegistrado.CondicionAbogado == 0)
                                        {
                                            <select id="cboCodAbogados" class="selectpicker form-control" title="..." asp-label="Código Abogado" asp-name="@expedienteRegistrado.IdCodigoAbogado"
                                                    select-items="@Model.LstCodigosAbogadosExternos"
                                                    select-item-value="Id" select-item-name="Codigo,NombreCompleto" select-item-name-format="{0} - {1}"
                                                    select-selected-value="@expedienteRegistrado.IdCodigoAbogado"
                                                    data-width="100%" data-style="border" data-live-search="true" disabled asp-validate="true"></select>
                                        }
                                        else
                                        {
                                            <select id="cboCodAbogados" class="selectpicker form-control" title="..." asp-label="Código Abogado"
                                                     asp-name="@expedienteRegistrado.IdCodigoAbogado"
                                                    select-items="@Model.LstCodigosAbogadosInternos"
                                                    select-item-value="Id" select-item-name="Codigo,NombreCompleto" select-item-name-format="{0} - {1}"
                                                    select-selected-value="@expedienteRegistrado.IdCodigoAbogado"
                                                    data-width="100%" data-style="border" data-live-search="true" asp-validate="true"></select>
                                        }
                                    </div>*@
                                @if (estadoTramite == 5)
                                {
                                    <div class="col-12 col-md-4">
                                        <input id="txtSaldoDescubierto" class="form-control" asp-label="Saldo descubierto" asp-name="@expedienteRegistrado.SaldoDescubierto"
                                               data-type="integer" value="@expedienteRegistrado.SaldoDescubierto" asp-decimal-digits="2" asp-validate="true" />
                                    </div>
                                    <div class="col-12 col-md-4">
                                        <input id="fechaFirmeza" type="date" class="form-control" asp-label="Fecha firmeza"
                                               asp-name="@expedienteRegistrado.FechaFirmeza" asp-validate="true" value="@expedienteRegistrado.FechaFirmeza?.ToString("dd/MM/yyyy")"
                                               asp-datepicker="true" asp-datepicker-format="DD/MM/YYYY" />
                                    </div>
                                }

                            </div>
                            <div class="row mb-2">
                                @if (estadoTramite == 5)
                                {
                                    <div class="col-12 col-md-4">
                                        <select id="cboCondicion" class="selectpicker show-tick" title="Seleccione una opción..." asp-label="Condición" asp-name="@expedienteRegistrado.Condicion"
                                                select-items="@Condicion" select-item-value="Key" select-item-name="Value" select-selected-value="@expedienteRegistrado.Condicion"
                                                data-width="100%" data-style="border" data-live-search="true" asp-validate="true"></select>
                                    </div>
                                }
                                <div class="col-12 col-md-4">
                                    <select id="cboEstado" class="selectpicker show-tick" title="Seleccione una opción..." asp-label="Estado" asp-name="@expedienteRegistrado.Activo"
                                            select-items="@Estado" select-item-value="Key" select-item-name="Value"
                                            data-width="100%" data-style="border" select-selected-value="@expedienteRegistrado.Activo" asp-validate="true"></select>
                                </div>
                            </div>

                            <div class="row mt-3">
                                <div class="col-12 mb-2">
                                    <div class="card mb-3">
                                        <div class="card-header">
                                            <span class="font-weight-bold">Operaciones Asignadas</span>
                                        </div>
                                        <div class="card-body">
                                            @if (Model.LstMontos.Where(x => x.IdExpedienteJudicial == expedienteRegistrado.IdExpediente).ToList().Count > 0)
                                            {
                                                @foreach (var monto in Model.LstMontos.Where(x => x.IdExpedienteJudicial == expedienteRegistrado.IdExpediente))
                                                {
                                                    <div divMontos class="card mb-3" IdMonto="@monto.Id" IdExpediente="@expedienteRegistrado.IdExpediente">
                                                        <div class="card-body">
                                                            <div class="container-fluid" id="@("MontoModel-" + monto.Id)">
                                                                <div class="row">
                                                                    <input type="hidden" asp-name="@monto.IdTramiteCobroJudicial" value="@monto.IdTramiteCobroJudicial" />
                                                                    <input type="hidden" asp-name="@monto.Id" value="@monto.Id" />
                                                                    <input type="hidden" asp-name="@monto.IdExpedienteJudicial" value="@monto.IdExpedienteJudicial" />


                                                                    <div class="row">
                                                                        <div class="col-md-2 col-sm-12 mb-2">
                                                                            <input id="@("txtOperacionMonto" + monto.Id)" class="form-control controlMontoDetalle" asp-label="Número de Operación"
                                                                                   asp-name="@monto.NumOperacion" value="@monto.NumOperacion" readonly />
                                                                        </div>
                                                                        <div class="col-md-2 col-sm-12 mb-2">
                                                                            <input id="@("txtMontoOriginal" + monto.Id)" class="form-control controlMontoDetalle" asp-label="Monto Original" asp-name="@monto.MontoOriginal"
                                                                                   data-type="decimal" value="@monto.MontoOriginal" asp-decimal-digits="2" disabled />
                                                                        </div>
                                                                        <div class="col-md-1 col-sm-12 mb-2">
                                                                            <input id="@("txtPorcentajeSaldo" + monto.Id)" class="form-control controlMontoDetalle" asp-label="Porcentaje" asp-name="@monto.PorcentajeSaldo"
                                                                                   data-type="decimal" value="@monto.PorcentajeSaldo" asp-decimal-digits="2" asp-percentage="true" data-max-value="100" />
                                                                        </div>
                                                                        <div class="col-md-2 col-sm-12 mb-2">
                                                                            <input id="@("txtMontoAsignado" + monto.Id)" class="form-control controlMontoDetalle" asp-label="Monto Asignado" asp-name="@monto.MontoAsignado"
                                                                                   data-type="decimal" value="@monto.MontoAsignado" asp-decimal-digits="2" disabled />
                                                                        </div>
                                                                        <div class="col-md-1 col-sm-12 mb-2">
                                                                            <input id="@("txtTipoCambio" + monto.Id)" class="form-control controlMontoDetalle" asp-label="Tipo Cambio" asp-name="@monto.TipoCambio"
                                                                                   data-type="decimal" value="@monto.TipoCambio" asp-decimal-digits="2" disabled />
                                                                        </div>
                                                                        <div class="col-md-2 col-sm-12 mb-2">
                                                                            <input id="@("txtMontoBase" + monto.Id)" class="form-control controlMontoDetalle" asp-label="Monto Base" asp-name="@monto.MontoBase"
                                                                                   data-type="decimal" value="@monto.MontoBase" asp-decimal-digits="2" disabled />
                                                                        </div>

                                                                        <div class="col-md-2 col-sm-12 mb-2">
                                                                            @if (estadoTramite == 5)
                                                                            {
                                                                                <input id="@("txtCuantiaMonto" + monto.Id)" class="form-control controlMontoDetalle cuantia" asp-label="Cuantía" asp-name="@monto.Cuantia"
                                                                                       data-type="decimal" value="@monto.Cuantia" asp-decimal-digits="2" disabled />
                                                                            }
                                                                        </div>
                                                                    </div>


                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                }

                                            }
                                            else
                                            {
                                                <div class="d-flex justify-content-center mb-2">No existen operaciones asignadas registrados</div>
                                            }
                                        </div>
                                    </div>

                                </div>
                            </div>

                            @*<div class="row mt-3">
                                    <div class="col-12 mb-2">
                                        <div class="card mb-3">
                                            <div class="card-header">
                                                <span class="font-weight-bold">Demanda</span>
                                            </div>
                                            <div class="card-body">
                                                <button type="button" IdExpediente="@expedienteRegistrado.IdExpediente" id="btnAdjDemanda" class="btn btn-outline-secondary"><i class="fas fa-upload mr-2"></i>Adjuntar Archivo</button>
                                            </div>

                                        </div>
                                    </div>
                                </div>*@

                            <div class="row mt-3">
                                <div class="col-12 mb-2">
                                    <div class="card mb-3">
                                        <div class="card-header">
                                            <span class="font-weight-bold">Remates y adjudicaciones</span>
                                        </div>
                                        <div class="card-body">
                                            <button type="button" IdExpediente="@expedienteRegistrado.IdExpediente" id="btnValidarExp" class="btn btn-outline-secondary"><i class="fas fa-list mr-2"></i>Validar Expediente</button>
                                        </div>

                                        <div class="card-body">
                                            <button type="button" IdExpediente="@expedienteRegistrado.IdExpediente" NumOperacion="@Model.NumOperacion" TramiteCobro="@expedienteRegistrado.IdTramiteCobroJudicial" id="btnValAsgCodExp" class="btn btn-outline-secondary"><i class="fas fa-list mr-2"></i>Validar Asignación Código Abogado</button>
                                        </div>

                                        <div class="card-body">
                                            <button type="button" IdExpediente="@expedienteRegistrado.IdExpediente" NumOperacion="@Model.NumOperacion" TramiteCobro="@expedienteRegistrado.IdTramiteCobroJudicial" id="btnCaratulaBienesAdj" class="btn btn-outline-secondary"><i class="fas fa-list mr-2"></i>Carátula Bienes Adjudicados</button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            @if (estadoTramite == 5)
                            {
                                <div class="row mt-3">
                                    <div class="col-12 mb-2">
                                        <button btnValidarDocuEtapa2 type="button" class="btn btn-outline-success"
                                                NumOperacion="@Model.NumOperacion"
                                                IdExpediente="@expedienteRegistrado.IdExpediente">
                                            <i class="far fa-plus mr-2"></i>Validar Documentación Pase Etapa 2
                                        </button>
                                    </div>
                                </div>

                                <div class="row mt-3">
                                    <div class="col-12 mb-2">
                                        <button IdExpediente="@expedienteRegistrado.IdExpediente" id="btnAgregarRemate" type="button" class="btn btn-outline-bp-primary mt-2 mb-2 btnAgregarRemate">
                                            <i class="fas fa-plus mr-2"></i> Agregar Remate
                                        </button>
                                        <div class="card mb-3">
                                            <div class="card-header">
                                                <span class="font-weight-bold">Remates</span>
                                            </div>
                                            <div class="card-body">
                                                @{
                                                    if (Model.LstRemates.Where(x => x.IdExpediente == expedienteRegistrado.IdExpediente).ToList().Count > 0)
                                                    {
                                                        foreach (var remate in Model.LstRemates.Where(x => x.IdExpediente == expedienteRegistrado.IdExpediente))
                                                        {
                                                            string fechaRemate = (remate.FechaRemate == null ? "" : remate.FechaRemate.ToString("dd/MM/yyyy"));
                                                            <div divRemates class="card mb-3" IdRemate="@remate.IdRemate" IdExpediente="@expedienteRegistrado.IdExpediente">
                                                                <div class="card-body">
                                                                    <div class="container-fluid" id="@("ActualizarRemateModel-" + remate.IdRemate)">
                                                                        <div class="row">
                                                                            <input type="hidden" asp-name="@remate.IdRemate" value="@remate.IdRemate" />
                                                                            <input type="hidden" asp-name="@remate.IdExpediente" value="@expedienteRegistrado.IdExpediente" />
                                                                            <div class="col-md-4 col-sm-12 mb-2">
                                                                                <input id="@("txtFechaRemate" + remate.IdRemate)" type="date" class="form-control controlRemateDetalle" asp-label="Fecha Remate"
                                                                                       asp-name="@remate.FechaRemate" value="@fechaRemate"
                                                                                       asp-datepicker="true" asp-datepicker-format="DD/MM/YYYY" readonly />
                                                                            </div>
                                                                            <div class="col-md-4 col-sm-12 mb-2">
                                                                                <input id="@("txtMontoBase" + remate.IdRemate)" class="form-control controlRemateDetalle" asp-label="Monto Base" asp-name="@remate.MontoBase"
                                                                                       data-type="integer" value="@remate.MontoBase" asp-decimal-digits="2" />
                                                                            </div>
                                                                            <div class="col-md-4 col-sm-12 mb-2">
                                                                                <select id=@("estadoRemate" + remate.IdRemate) class="selectpicker show-tick controlRemateDetalle" title="Seleccione una opción..." asp-label="Estado" asp-name="@remate.Activo"
                                                                                        select-items="@Estado" select-item-value="Key" select-item-name="Value"
                                                                                        data-width="100%" data-style="border" select-selected-value="@remate.Activo"></select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        }
                                                    }
                                                    else
                                                    {
                                                        <div class="d-flex justify-content-center mb-2">No existen remates registrados</div>
                                                    }

                                                }
                                                @if (Model.LstRemates.Where(x => x.IdExpediente == expedienteRegistrado.IdExpediente).ToList().Count > 0)
                                                {
                                                    <div class="card-footer text-right">
                                                        <button type="button" class="btn btn-outline-success btnActualizarRemates"><i class="far fa-save mr-2"></i>Guardar Remates</button>
                                                    </div>
                                                }
                                            </div>

                                        </div>
                                    </div>
                                </div>
                            }

                            @if (estadoTramite != 1)
                            {
                                try
                                {
                                    <div class="row mt-3">
                                        <div class="col-12 mb-2">
                                            @if (Model.LstFechaRematePuestaPosesion.Where(x => x.IdExpedienteJudicial == expedienteRegistrado.IdExpediente).ToList().Count <= 0)
                                            {
                                                <button IdExpedienteJudicial="@expedienteRegistrado.IdExpediente" TramiteCobro="@expedienteRegistrado.IdTramiteCobroJudicial" NumOperacion="@expedienteRegistrado.NumOperacion" id="btnAgregarFechaRematePuestaPosesion" type="button"
                                                        class="btn btn-outline-bp-primary mt-2 mb-2 btnAgregarFechaRematePuestaPosesion">
                                                    <i class="fas fa-plus mr-2"></i> Agregar Fecha Remate Puesta Posesión
                                                </button>
                                            }
                                            @if (Model.LstFechaRematePuestaPosesion.Where(x => x.IdExpedienteJudicial == expedienteRegistrado.IdExpediente).ToList().Count > 0)
                                            {
                                                <button IdExpedienteJudicial="@expedienteRegistrado.IdExpediente" TramiteCobro="@expedienteRegistrado.IdTramiteCobroJudicial" NumOperacion="@expedienteRegistrado.NumOperacion" Remate="1" id="btnAgregarCalcLiquidacion1" type="button"
                                                        class="btn btn-outline-bp-primary mt-2 mb-2 btnAgregarCalcLiquidacion1">
                                                    <i class="fas fa-plus mr-2"></i> Calculo Liquidación 1 Remate
                                                </button>
                                                <button IdExpedienteJudicial="@expedienteRegistrado.IdExpediente" TramiteCobro="@expedienteRegistrado.IdTramiteCobroJudicial" NumOperacion="@expedienteRegistrado.NumOperacion" Remate="2" id="btnAgregarCalcLiquidacion2" type="button"
                                                        class="btn btn-outline-bp-primary mt-2 mb-2 btnAgregarCalcLiquidacion2">
                                                    <i class="fas fa-plus mr-2"></i> Calculo Liquidación 2 Remate
                                                </button>
                                                <button IdExpedienteJudicial="@expedienteRegistrado.IdExpediente" TramiteCobro="@expedienteRegistrado.IdTramiteCobroJudicial" NumOperacion="@expedienteRegistrado.NumOperacion" Remate="3" id="btnAgregarCalcLiquidacion3" type="button"
                                                        class="btn btn-outline-bp-primary mt-2 mb-2 btnAgregarCalcLiquidacion3">
                                                    <i class="fas fa-plus mr-2"></i> Calculo Liquidación 3 Remate
                                                </button>
                                            }
                                            <div class="card mb-3">
                                                <div class="card-header">
                                                    <span class="font-weight-bold">Fecha Remate Puesta Posesión</span>
                                                </div>
                                                <div class="card-body">
                                                    @{ if (Model.LstFechaRematePuestaPosesion != null)
                                                        {
                                                            @if (Model.LstFechaRematePuestaPosesion.Where(x => x.IdExpedienteJudicial == expedienteRegistrado.IdExpediente).ToList().Count > 0)
                                                            {

                                                                foreach (var fechaRematePP in Model.LstFechaRematePuestaPosesion.Where(x => x.IdExpedienteJudicial == expedienteRegistrado.IdExpediente))
                                                                {
                                                                    try
                                                                    {
                                                                        string fechaRemate1 = (fechaRematePP.FechaRemate1 == null ? "" : Convert.ToDateTime(fechaRematePP.FechaRemate1).ToString("dd/MM/yyyy"));
                                                                        string fechaRemate2 = (fechaRematePP.FechaRemate2 == null ? "" : Convert.ToDateTime(fechaRematePP.FechaRemate2).ToString("dd/MM/yyyy"));
                                                                        string fechaRemate3 = (fechaRematePP.FechaRemate3 == null ? "" : Convert.ToDateTime(fechaRematePP.FechaRemate3).ToString("dd/MM/yyyy"));
                                                                        string fechaProtocolizacion = (fechaRematePP.FechaProtocolizacion == null ? "" : Convert.ToDateTime(fechaRematePP.FechaProtocolizacion).ToString("dd/MM/yyyy"));
                                                                        string fechaPuestaPosesion = (fechaRematePP.FechaPuestaPosesion == null ? "" : Convert.ToDateTime(fechaRematePP.FechaPuestaPosesion).ToString("dd/MM/yyyy"));

                                                                        <div divFechaRematePuestaPosesion class="card mb-3" IdFechaRematePuestaPosesion="@fechaRematePP.IdFechaRematePuestaPosesion" IdExpediente="@expedienteRegistrado.IdExpediente">
                                                                            <div class="card-body">
                                                                                <div class="container-fluid" id="@("ActualizarFechaRematePuestaPosesionModel-" + fechaRematePP.IdFechaRematePuestaPosesion.ToString())">
                                                                                    <div class="row">
                                                                                        <input type="hidden" id="txtIdFechaRematePuestaPosesion" asp-name="@fechaRematePP.IdFechaRematePuestaPosesion" value="@fechaRematePP.IdFechaRematePuestaPosesion" />
                                                                                        <input type="hidden" asp-name="@fechaRematePP.IdExpedienteJudicial" value="@expedienteRegistrado.IdExpediente" />
                                                                                        <input type="hidden" asp-name="@fechaRematePP.TramiteCobro" value="@expedienteRegistrado.IdTramiteCobroJudicial" />
                                                                                        <input type="hidden" asp-name="@fechaRematePP.NumOperacion" value="@expedienteRegistrado.NumOperacion" />
                                                                                        <input type="hidden" asp-name="@fechaRematePP.NumOperacion" value="@expedienteRegistrado.NumOperacion" />
                                                                                        <div class="col-md-4 col-sm-12 mb-2">
                                                                                            <input id="@("txtFechaRemate1" + fechaRematePP.IdFechaRematePuestaPosesion)" type="date" class="form-control controlFechaRematePuestaPosesionDetalle" asp-label="Fecha Remate 1"
                                                                                                   asp-name="@fechaRematePP.FechaRemate1" value="@fechaRemate1" asp-datepicker="true" />
                                                                                        </div>
                                                                                        <div class="col-md-4 col-sm-12 mb-2">
                                                                                            <input id="@("txtFechaRemate2" + fechaRematePP.IdFechaRematePuestaPosesion)" type="date" class="form-control controlFechaRematePuestaPosesionDetalle" asp-label="Fecha Remate 2"
                                                                                                   asp-name="@fechaRematePP.FechaRemate2" value="@fechaRemate2" asp-datepicker="true" />
                                                                                        </div>
                                                                                        <div class="col-md-4 col-sm-12 mb-2">
                                                                                            <input id="@("txtFechaRemate3" + fechaRematePP.IdFechaRematePuestaPosesion)" type="date" class="form-control controlFechaRematePuestaPosesionDetalle" asp-label="Fecha Remate 3"
                                                                                                   asp-name="@fechaRematePP.FechaRemate3" value="@fechaRemate3" asp-datepicker="true" />
                                                                                        </div>
                                                                                        <div class="col-md-4 col-sm-12 mb-2">
                                                                                            <input id="@("txtHoraRemate1" + fechaRematePP.IdFechaRematePuestaPosesion)" type="time" class="form-control controlInstruccionesRemateDetalle" asp-label="Hora Remate 1"
                                                                                                   asp-name="@fechaRematePP.HoraRemate1" asp-for="@fechaRematePP.HoraRemate1" value="@fechaRematePP.HoraRemate1">
                                                                                        </div>
                                                                                        <div class="col-md-4 col-sm-12 mb-2">
                                                                                            <input id="@("txtHoraRemate2" + fechaRematePP.IdFechaRematePuestaPosesion)" type="time" class="form-control controlInstruccionesRemateDetalle" asp-label="Hora Remate 2"
                                                                                                   asp-name="@fechaRematePP.HoraRemate2" asp-for="@fechaRematePP.HoraRemate2" value="@fechaRematePP.HoraRemate2">
                                                                                        </div>
                                                                                        <div class="col-md-4 col-sm-12 mb-2">
                                                                                            <input id="@("txtHoraRemate3" + fechaRematePP.IdFechaRematePuestaPosesion)" type="time" class="form-control controlInstruccionesRemateDetalle" asp-label="Hora Remate 3"
                                                                                                   asp-name="@fechaRematePP.HoraRemate3" asp-for="@fechaRematePP.HoraRemate3" value="@fechaRematePP.HoraRemate3">
                                                                                        </div>
                                                                                        <div class="col-md-4 col-sm-12 mb-2">
                                                                                            <input id="@("txtMontoRemateBase1" + fechaRematePP.IdFechaRematePuestaPosesion)" class="form-control controlFechaRematePuestaPosesionDetalle" asp-label="Monto Remate Base 1"
                                                                                                   asp-name="@fechaRematePP.MontoRemateBase1" data-type="decimal" value="@fechaRematePP.MontoRemateBase1" asp-decimal-digits="2" />
                                                                                        </div>
                                                                                        <div class="col-md-4 col-sm-12 mb-2">
                                                                                            <input id="@("txtMontoRemateBase2"+ fechaRematePP.IdFechaRematePuestaPosesion)" class="form-control controlFechaRematePuestaPosesionDetalle" asp-label="Monto Remate Base 2"
                                                                                                   asp-name="@fechaRematePP.MontoRemateBase2" data-type="decimal" value="@fechaRematePP.MontoRemateBase2" asp-decimal-digits="2" disabled />
                                                                                        </div>
                                                                                        <div class="col-md-4 col-sm-12 mb-2">
                                                                                            <input id="@("txtMontoRemateBase3"+ fechaRematePP.IdFechaRematePuestaPosesion)" class="form-control controlFechaRematePuestaPosesionDetalle" asp-label="Monto Remate Base 3"
                                                                                                   asp-name="@fechaRematePP.MontoRemateBase3" data-type="decimal" value="@fechaRematePP.MontoRemateBase3" asp-decimal-digits="2" disabled />
                                                                                        </div>
                                                                                        <div class="col-md-4 col-sm-12 mb-2">
                                                                                            <input id="@("txtSaldoDecretadoJudicial"+ fechaRematePP.IdFechaRematePuestaPosesion)" class="form-control controlFechaRematePuestaPosesionDetalle" asp-label="Saldo Decretado Judicial"
                                                                                                   asp-name="@fechaRematePP.SaldoDecretadoJudicial" data-type="decimal" value="@fechaRematePP.SaldoDecretadoJudicial" asp-decimal-digits="2" />
                                                                                        </div>
                                                                                        <div class="col-md-4 col-sm-12 mb-2">
                                                                                            <input id="@("txtFechaProtocolizacion" + fechaRematePP.IdFechaRematePuestaPosesion)" type="date" class="form-control controlFechaRematePuestaPosesionDetalle" asp-label="Fecha Protocolización"
                                                                                                   asp-name="@fechaRematePP.FechaProtocolizacion" value="@fechaProtocolizacion" asp-datepicker="true" />
                                                                                        </div>
                                                                                        <div class="col-md-4 col-sm-12 mb-2">
                                                                                            <input id="@("txtFechaPuestaPosesion" + fechaRematePP.IdFechaRematePuestaPosesion)" type="date" class="form-control controlFechaRematePuestaPosesionDetalle" asp-label="Fecha Puesta Posesión"
                                                                                                   asp-name="@fechaRematePP.FechaPuestaPosesion" value="@fechaPuestaPosesion" asp-datepicker="true" />
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>

                                                                    }
                                                                    catch (Exception ex)
                                                                    {
                                                                        Html.Raw(ex.Message);
                                                                    }
                                                                }
                                                            }
                                                            else
                                                            {
                                                                <div class="d-flex justify-content-center mb-2">No existen Fecha Remate Puesta Posesión registrados</div>
                                                            }

                                                            @if (Model.LstFechaRematePuestaPosesion.Where(x => x.IdExpedienteJudicial == expedienteRegistrado.IdExpediente).ToList().Count > 0)
                                                            {
                                                                foreach (var fechaRematePP in Model.LstFechaRematePuestaPosesion.Where(x => x.IdExpedienteJudicial == expedienteRegistrado.IdExpediente))
                                                                {
                                                                    <div class="card-footer text-right">
                                                                        @if (Model.LstResultadosRemate.Where(x => x.IdExpedienteJudicial == expedienteRegistrado.IdExpediente).ToList().Count <= 0)
                                                                        {
                                                                            <button IdExpedienteJudicial="@expedienteRegistrado.IdExpediente" TramiteCobro="@expedienteRegistrado.IdTramiteCobroJudicial"
                                                                                    NumOperacion="@expedienteRegistrado.NumOperacion" IdFechaRematePuestaPosesion="@fechaRematePP.IdFechaRematePuestaPosesion"
                                                                                    type="button" id="btnAgregarResultadosRemate" class="btn btn-outline-bp-primary mt-2 mb-2 btnAgregarResultadosRemate">
                                                                                <i class="fas fa-plus mr-2"></i> Agregar Resultados Remate
                                                                            </button>
                                                                        }

                                                                        <button type="button" IdExpedienteJudicial="@expedienteRegistrado.IdExpediente" TramiteCobro="@expedienteRegistrado.IdTramiteCobroJudicial"
                                                                                NumOperacion="@expedienteRegistrado.NumOperacion" IdFechaRematePuestaPosesion="@fechaRematePP.IdFechaRematePuestaPosesion"
                                                                                class="btn btn-outline-success btnActualizarFechaRematePuestaPosesion" id="btnActualizarFechaRematePuestaPosesion">
                                                                            <i class="far fa-save mr-2">
                                                                            </i>Guardar Fecha Remate Puesta Posesión
                                                                        </button>

                                                                    </div>

                                                                    <div class="card mb-3">
                                                                        <div class="card-header">
                                                                            <span class="font-weight-bold">Resultados de Remate</span>
                                                                        </div>
                                                                        <div class="card-body">
                                                                            @{ if (Model.LstResultadosRemate != null)
                                                                                {
                                                                                    @if (Model.LstResultadosRemate.Where(x => x.IdExpedienteJudicial == expedienteRegistrado.IdExpediente).ToList().Count > 0)
                                                                                    {

                                                                                        foreach (var ResultadosRematePP in Model.LstResultadosRemate.Where(x => x.IdExpedienteJudicial == expedienteRegistrado.IdExpediente))
                                                                                        {
                                                                                            try
                                                                                            {
                                                                                                string FecFirmezaRemate = (ResultadosRematePP.FecFirmezaRemate == null ? "" : Convert.ToDateTime(ResultadosRematePP.FecFirmezaRemate).ToString("dd/MM/yyyy"));

                                                                                                <div divResultadosRemate class="card mb-3" IdResultadosRemate="@ResultadosRematePP.IdResultadosRemate" IdExpediente="@expedienteRegistrado.IdExpediente">
                                                                                                    <div class="card-body">
                                                                                                        <div class="container-fluid" id="@("ActualizarResultadosRemateModel-" + ResultadosRematePP.IdResultadosRemate.ToString())">
                                                                                                            <div class="row">
                                                                                                                <input type="hidden" id="txtIdResultadosRemate" asp-name="@ResultadosRematePP.IdResultadosRemate" value="@ResultadosRematePP.IdResultadosRemate" />
                                                                                                                <input type="hidden" asp-name="@ResultadosRematePP.IdFechaRematePuestaPosesion" value="@ResultadosRematePP.IdFechaRematePuestaPosesion" />
                                                                                                                <input type="hidden" asp-name="@ResultadosRematePP.IdExpedienteJudicial" value="@expedienteRegistrado.IdExpediente" />
                                                                                                                <input type="hidden" asp-name="@ResultadosRematePP.TramiteCobro" value="@expedienteRegistrado.IdTramiteCobroJudicial" />
                                                                                                                <input type="hidden" asp-name="@ResultadosRematePP.NumOperacion" value="@expedienteRegistrado.NumOperacion" />

                                                                                                                <div class="col-md-4 col-sm-12 mb-2">
                                                                                                                    <RadioButtonsGroup id="txtIndExpJudiAdjudicadoDiv" class="radio controlResultadosRemateDetalle" asp-label="Expediente Judicial Adjudicado"
                                                                                                                                       asp-name="@ResultadosRematePP.IndExpJudiAdjudicado" asp-value="@ResultadosRematePP.IndExpJudiAdjudicado">
                                                                                                                        <RadioButtonItem class="btn btn-outline-info" data-type="boolean" data-nullable="true" value="true" label="Banco" />
                                                                                                                        <RadioButtonItem class="btn btn-outline-info" data-type="boolean" data-nullable="true" value="false" label="Tercero" />
                                                                                                                    </RadioButtonsGroup>
                                                                                                                </div>
                                                                                                                <div class="col-md-4 col-sm-12 mb-2">
                                                                                                                    <input id="@("txtMontoAdjudicacion" + ResultadosRematePP.IdResultadosRemate)" class="form-control controlResultadosRemateDetalle" asp-label="Monto Adjudicación"
                                                                                                                           asp-name="@ResultadosRematePP.MontoAdjudicacion" data-type="decimal" value="@ResultadosRematePP.MontoAdjudicacion" asp-decimal-digits="2" />
                                                                                                                </div>
                                                                                                                <div class="col-md-4 col-sm-12 mb-2">
                                                                                                                    <input id="@("txtFecFirmezaRemate" + ResultadosRematePP.IdResultadosRemate)" type="date" class="form-control controlResultadosRemateDetalle" asp-label="Fecha Firmeza Remate"
                                                                                                                           asp-name="@ResultadosRematePP.FecFirmezaRemate" value="@FecFirmezaRemate" asp-datepicker="true" />
                                                                                                                </div>
                                                                                                                <div class="col-md-4 col-sm-12 mb-2">
                                                                                                                    <select id=@("txtIdEncargadoProtocolizacion" + ResultadosRematePP.IdResultadosRemate) class="selectpicker show-tick controlResultadosRemateDetalle" title="Seleccione una opción..." asp-label="Encargado de Protocolizaciones"
                                                                                                                            asp-name="@ResultadosRematePP.IdEncargadoProtocolizacion" select-items="@Model.LstEncargadoProtocolizacion" select-item-value="IdUsuario" select-item-name="NombreCompleto"
                                                                                                                            data-width="100%" data-style="border" select-selected-value="@ResultadosRematePP.IdEncargadoProtocolizacion"></select>
                                                                                                                </div>
                                                                                                                <div class="col-md-4 col-sm-12 mb-2">
                                                                                                                    <select id=@("txtIdEncargadoPuestaPosesion" + ResultadosRematePP.IdResultadosRemate) class="selectpicker show-tick controlResultadosRemateDetalle" title="Seleccione una opción..." asp-label="Encargado Puesta Posesión"
                                                                                                                            asp-name="@ResultadosRematePP.IdEncargadoProtocolizacion" select-items="@Model.LstEncargadoPuestaPosesion" select-item-value="IdUsuario" select-item-name="NombreCompleto"
                                                                                                                            data-width="100%" data-style="border" select-selected-value="@ResultadosRematePP.IdEncargadoPuestaPosesion"></select>
                                                                                                                </div>
                                                                                                                <div class="col-md-4 col-sm-12 mb-2">
                                                                                                                    <RadioButtonsGroup id="txtIndRemateFirmeDiv" class="radio controlResultadosRemateDetalle" asp-label="Firmeza de Remate"
                                                                                                                                       asp-name="@ResultadosRematePP.IndRemateFirme" asp-value="@ResultadosRematePP.IndRemateFirme">
                                                                                                                        <RadioButtonItem class="btn btn-outline-info" data-type="boolean" data-nullable="true" value="true" label="Si" />
                                                                                                                        <RadioButtonItem class="btn btn-outline-info" data-type="boolean" data-nullable="true" value="false" label="No" />
                                                                                                                    </RadioButtonsGroup>
                                                                                                                </div>
                                                                                                            </div>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </div>

                                                                                            }
                                                                                            catch (Exception ex)
                                                                                            {
                                                                                                Html.Raw(ex.Message);
                                                                                            }
                                                                                        }
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        <div class="d-flex justify-content-center mb-2">No existen Resultados de Remate registrados</div>
                                                                                    }

                                                                                    @if (Model.LstResultadosRemate.Where(x => x.IdExpedienteJudicial == expedienteRegistrado.IdExpediente).ToList().Count > 0)
                                                                                    {
                                                                                        foreach (var resultadosRematePP in Model.LstResultadosRemate.Where(x => x.IdExpedienteJudicial == expedienteRegistrado.IdExpediente))
                                                                                        {
                                                                                            <div class="card-footer text-right">
                                                                                                <button type="button" IdExpedienteJudicial="@expedienteRegistrado.IdExpediente" TramiteCobro="@expedienteRegistrado.IdTramiteCobroJudicial"
                                                                                                        NumOperacion="@expedienteRegistrado.NumOperacion" IdFechaRematePuestaPosesion="@resultadosRematePP.IdFechaRematePuestaPosesion"
                                                                                                        IdResultadosRemate="@resultadosRematePP.IdResultadosRemate" class="btn btn-outline-success btnActualizarResultadosRemate"
                                                                                                        id="btnActualizarResultadosRemate">
                                                                                                    <i class="far fa-save mr-2">
                                                                                                    </i>Guardar Resultados Remate
                                                                                                </button>
                                                                                            </div>
                                                                                        }
                                                                                    }

                                                                                }
                                                                            }
                                                                        </div>

                                                                    </div>
                                                                }
                                                            }
                                                        }
                                                    }
                                                </div>

                                            </div>
                                        </div>
                                    </div>
                                }
                                catch (Exception ex)
                                {
                                    Html.Raw(ex.Message);
                                }
                            }

                            @if (estadoTramite != 1)
                            {
                                <div class="row mt-3">
                                    <div class="col-12 mb-2">

                                        @try
                                        {
                                            if (Model.LstInstruccionesRemate.Where(x => x.IdExpedienteJudicial == expedienteRegistrado.IdExpediente).ToList().Count == 0)
                                            {
                                                <button IdExpedienteJudicial="@expedienteRegistrado.IdExpediente" TramiteCobro="@expedienteRegistrado.IdTramiteCobroJudicial"
                                                        NumOperacion="@expedienteRegistrado.NumOperacion" id="btnAgregarInstruccionesRemate" type="button"
                                                        class="btn btn-outline-bp-primary mt-2 mb-2 btnAgregarInstruccionesRemate">
                                                    <i class="fas fa-plus mr-2"></i>Agregar Instrucciones Remate
                                                </button>
                                            }

                                            <div class="card mb-3">
                                                <div class="card-header">
                                                    <span class="font-weight-bold">Instrucciones Remate</span>
                                                </div>
                                                <div class="card-body">
                                                    @{ if (Model.LstInstruccionesRemate != null)
                                                        {
                                                            if (Model.LstInstruccionesRemate.Where(x => x.IdExpedienteJudicial == expedienteRegistrado.IdExpediente).ToList().Count > 0)
                                                            {
                                                                foreach (var remate in Model.LstInstruccionesRemate.Where(x => x.IdExpedienteJudicial == expedienteRegistrado.IdExpediente))
                                                                {
                                                                    string fechaDesde = (remate.FechaDesde == null ? "" : remate.FechaDesde?.ToString("dd/MM/yyyy"));
                                                                    string fechaHasta = (remate.FechaHasta == null ? "" : remate.FechaHasta?.ToString("dd/MM/yyyy"));
                                                                    string fechaAdjudicar = (remate.FechaAdjudicar == null ? "" : remate.FechaAdjudicar.ToString("dd/MM/yyyy"));
                                                                    string fechaRemate = (remate.FecRemate == null ? "" : remate.FecRemate.ToString("dd/MM/yyyy"));
                                                                    string horaRemate = (remate.HoraRemate == null ? "" : string.Format("{0:hh\\:mm\\:ss}", remate.HoraRemate));
                                                                    string fechaUltAvaluo = (remate.FecUltAvaluo == null ? "" : remate.FecUltAvaluo.ToString("dd/MM/yyyy"));

                                                                    <div divInstruccionesRemate class="card mb-3" IdInstruccionesRemate="@remate.IdInstruccionesRemate"
                                                                         IdExpediente="@expedienteRegistrado.IdExpediente" NumOperacion="@expedienteRegistrado.NumOperacion"
                                                                         TramiteCobro="@expedienteRegistrado.IdTramiteCobroJudicial">
                                                                        <div class="card-body">
                                                                            <div class="container-fluid" id="@("ActualizarInstruccionesRemateModel-" + remate.IdInstruccionesRemate.ToString())">
                                                                                <div class="row">
                                                                                    <input type="hidden" asp-name="@remate.IdInstruccionesRemate" value="@remate.IdInstruccionesRemate" />
                                                                                    <input type="hidden" id="IdExpedienteJudicialIR" asp-name="@remate.IdExpedienteJudicial" value="@expedienteRegistrado.IdExpediente" />
                                                                                    <input type="hidden" id="TramiteCobroIR" asp-name="@remate.TramiteCobro" value="@expedienteRegistrado.IdTramiteCobroJudicial" />
                                                                                    <input type="hidden" id="NumOperacionIR" asp-name="@remate.NumOperacion" value="@expedienteRegistrado.NumOperacion" />

                                                                                    <div class="col-md-4 col-sm-12 mb-2">
                                                                                        <RadioButtonsGroup id="txtIndInteresPrescritosDiv" class="radio controlInstruccionesRemateDetalle" asp-label="Interés Prescritos"
                                                                                                           asp-name="@remate.IndInteresPrescritos" asp-value="@remate.IndInteresPrescritos">
                                                                                            <RadioButtonItem class="btn btn-outline-info" data-type="boolean" data-nullable="true" value="true" label="Si" />
                                                                                            <RadioButtonItem class="btn btn-outline-info" data-type="boolean" data-nullable="true" value="false" label="No" />
                                                                                        </RadioButtonsGroup>
                                                                                    </div>

                                                                                    <div class="col-md-4 col-sm-12 mb-2" id="myDivFechaDesde">
                                                                                        <input id="txtFechaDesde" type="date" class="form-control controlInstruccionesRemateDetalle" asp-label="Fecha Desde"
                                                                                               asp-name="@remate.FechaDesde" value="@fechaDesde"
                                                                                               asp-datepicker="true" asp-validate="true" />
                                                                                    </div>

                                                                                    <div class="col-md-4 col-sm-12 mb-2" id="myDivFechaHasta">
                                                                                        <input id="txtFechaHasta" type="date" class="form-control controlInstruccionesRemateDetalle" asp-label="Fecha Hasta"
                                                                                               asp-name="@remate.FechaHasta" value="@fechaHasta"
                                                                                               asp-datepicker="true" asp-validate="true" />
                                                                                    </div>

                                                                                    <div class="col-md-4 col-sm-12 mb-2">
                                                                                        <input id="@("txtFechaAdjudicar" + remate.IdInstruccionesRemate.ToString())" type="date" class="form-control controlInstruccionesRemateDetalle" asp-label="Fecha Adjudicar"
                                                                                               asp-name="@remate.FechaAdjudicar" value="@fechaAdjudicar"
                                                                                               asp-datepicker="true" />
                                                                                    </div>

                                                                                    <div class="col-md-4 col-sm-12 mb-2">
                                                                                        <select id=@("txtIdIndicacionPerito" + remate.IdInstruccionesRemate.ToString()) class="selectpicker show-tick controlInstruccionesRemateDetalle" title="Seleccione una opción..." asp-label="Indicación Perito"
                                                                                                asp-name="@remate.IdIndicacionPerito" select-items="@ViewBag.IndicacionPerito" select-item-value="IdIndicacionPerito" select-item-name="Descripcion"
                                                                                                data-width="100%" data-style="border" select-selected-value="@remate.IdIndicacionPerito"></select>
                                                                                    </div>

                                                                                    <div class="col-md-4 col-sm-12 mb-2">
                                                                                        <input id="@("txtNumOficio" + remate.IdInstruccionesRemate.ToString())" class="form-control controlInstruccionesRemateDetalle" asp-label="Número de Oficio" asp-name="@remate.NumOficio"
                                                                                               data-type="string" value="@remate.NumOficio" />
                                                                                    </div>

                                                                                    <div class="col-md-4 col-sm-12 mb-2">
                                                                                        <input id="@("txtFecRemate" + remate.IdInstruccionesRemate.ToString())" type="date" class="form-control controlInstruccionesRemateDetalle" asp-label="Fecha Remate"
                                                                                               asp-name="@remate.FecRemate" value="@fechaRemate"
                                                                                               asp-datepicker="true" />
                                                                                    </div>

                                                                                    <div class="col-md-4 col-sm-12 mb-2">
                                                                                        <input id="@("txtHoraRemate" + remate.IdInstruccionesRemate.ToString())" type="time" class="form-control controlInstruccionesRemateDetalle" asp-label="Hora Remate" asp-name="@remate.HoraRemate"
                                                                                               asp-for="@remate.HoraRemate" value="@horaRemate">
                                                                                    </div>

                                                                                    <div class="col-md-4 col-sm-12 mb-2">
                                                                                        <input id="@("txtBaseRemate" + remate.IdInstruccionesRemate.ToString())" class="form-control controlInstruccionesRemateDetalle" asp-label="Monto Remate" asp-name="@remate.BaseRemate"
                                                                                               data-type="integer" value="@remate.BaseRemate" asp-decimal-digits="2" />
                                                                                    </div>

                                                                                    <div class="col-md-4 col-sm-12 mb-2">
                                                                                        <input id="@("txtNumGarantia" + remate.IdInstruccionesRemate.ToString())" class="form-control controlInstruccionesRemateDetalle" asp-label="Número de Garantía" asp-name="@remate.NumGarantia"
                                                                                               data-type="integer" value="@remate.NumGarantia" />
                                                                                    </div>

                                                                                    <div class="col-md-4 col-sm-12 mb-2">
                                                                                        <input id="@("txtFecUltAvaluo" + remate.IdInstruccionesRemate.ToString())" type="date" class="form-control controlInstruccionesRemateDetalle" asp-label="Fecha Último Avalúo"
                                                                                               asp-name="@remate.FecUltAvaluo" value="@fechaUltAvaluo"
                                                                                               asp-datepicker="true" />
                                                                                    </div>

                                                                                    <div class="col-md-4 col-sm-12 mb-2">
                                                                                        <input id="@("txtMontoAvaluo" + remate.IdInstruccionesRemate.ToString())" class="form-control controlInstruccionesRemateDetalle" asp-label="Monto Avalúo" asp-name="@remate.MontoAvaluo"
                                                                                               data-type="integer" value="@remate.MontoAvaluo" asp-decimal-digits="2" />
                                                                                    </div>

                                                                                    <div class="col-md-4 col-sm-12 mb-2">
                                                                                        <input id="@("txtMontoLiquidacion" + remate.IdInstruccionesRemate.ToString())" class="form-control controlInstruccionesRemateDetalle" asp-label="Monto Liquidación" asp-name="@remate.MontoLiquidacion"
                                                                                               data-type="integer" value="@remate.MontoLiquidacion" asp-decimal-digits="2" />
                                                                                    </div>

                                                                                    <div class="col-md-4 col-sm-12 mb-2">
                                                                                        <RadioButtonsGroup id="@("txtChequeGerencia" + remate.IdInstruccionesRemate.ToString())" class="radio controlInstruccionesRemateDetalle" asp-label="Cheque Gerencia"
                                                                                                           asp-name="@remate.ChequeGerencia" asp-value="@remate.ChequeGerencia">
                                                                                            <RadioButtonItem class="btn btn-outline-info" data-type="boolean" data-nullable="true" value="true" label="Si" />
                                                                                            <RadioButtonItem class="btn btn-outline-info" data-type="boolean" data-nullable="true" value="false" label="No" />
                                                                                        </RadioButtonsGroup>
                                                                                    </div>

                                                                                    <div class="col-md-2 col-sm-12 mb-2">
                                                                                        <input id="@("txtFirmaGestorCobro" + remate.IdInstruccionesRemate.ToString())" class="form-control controlInstruccionesRemateDetalle" asp-label="Firma Gestor Cobro"
                                                                                               asp-name="@remate.FirmaGestorCobro" value="@remate.FirmaGestorCobro" maxlength="100" />
                                                                                    </div>

                                                                                    <div class="col-md-2 col-sm-12 mb-2">
                                                                                        <input id="@("txtFirmaAreaCobro" + remate.IdInstruccionesRemate.ToString())" class="form-control controlInstruccionesRemateDetalle" asp-label="Firma Área Cobro"
                                                                                               asp-name="@remate.FirmaAreaCobro" value="@remate.FirmaAreaCobro" maxlength="100" />
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>

                                                                    <div class="card-footer text-right">
                                                                        <button type="button" class="btn btn-outline-info btnGenerarIstRemate"><i class="far fa-download mr-2"></i>Generar Instrucciones Remate</button>

                                                                        <button type="button" id="btnAdjInstruccionRemate" InstruccionesRemateId="@remate.IdInstruccionesRemate" IdExpedienteJudicial="@expedienteRegistrado.IdExpediente"
                                                                                TramiteCobro="@expedienteRegistrado.IdTramiteCobroJudicial" NumOperacion="@expedienteRegistrado.NumOperacion" class="btn btn-outline-secondary">
                                                                            <i class="fas fa-upload mr-2"></i>Adjuntar Instrucción Remate Firmada
                                                                        </button>

                                                                        <button type="button" class="btn btn-outline-success btnActualizarInstruccionesRemate" IdInstruccionesRemate="@remate.IdInstruccionesRemate"
                                                                                IdExpedienteJudicial="@expedienteRegistrado.IdExpediente" TramiteCobro="@expedienteRegistrado.IdTramiteCobroJudicial"
                                                                                NumOperacion="@expedienteRegistrado.NumOperacion" id="btnActualizarInstruccionesRemate">
                                                                            <i class="far fa-save mr-2"></i>Guardar Instrucción Remate
                                                                        </button>
                                                                    </div>
                                                                    <div class="row mb-2" id="@("contenedorAdjuntarRemateInstruccion-" + expedienteRegistrado.IdExpediente.ToString())">
                                                                        <div class="col-12 col-md-12" id="@("info-container-" + expedienteRegistrado.IdExpediente.ToString())">
                                                                        </div>
                                                                    </div>
                                                                }
                                                            }
                                                            else
                                                            {
                                                                <div class="d-flex justify-content-center mb-2">No existen Instrucciones de Remate registrados</div>
                                                            }
                                                        }
                                                    }
                                                    @*@if (Model.LstInstruccionesRemate.Where(x => x.IdExpedienteJudicial == expedienteRegistrado.IdExpediente).ToList().Count > 0)
                                                        {
                                                            <div class="card-footer text-right">
                                                                <button type="button" class="btn btn-outline-info btnGenerarIstRemate"><i class="far fa-download mr-2"></i>Generar Instrucciones Remate</button>
                                                                <button type="button" class="btn btn-outline-success btnActualizarInstruccionesRemate"><i class="far fa-save mr-2"></i>Guardar Instrucción Remate</button>
                                                            </div>
                                                        }*@
                                                </div>

                                            </div>


                                        }
                                        catch (Exception ex)
                                        {
                                            Html.Raw(ex.Message);
                                        }


                                    </div>
                                </div>

                                <div class="row mt-3">
                                    <div class="col-12 mb-2">
                                        <button IdExpedienteJudicial="@expedienteRegistrado.IdExpediente" NumOperacion="@expedienteRegistrado.NumOperacion" id="btnAgregarExpGarantia" type="button"
                                                class="btn btn-outline-bp-primary mt-2 mb-2 btnAgregarExpGarantia">
                                            <i class="fas fa-plus mr-2"></i>Agregar Expediente Garantía
                                        </button>
                                        <div class="card mb-3">
                                            <div class="card-header">
                                                <span class="font-weight-bold">Expediente Garantía</span>
                                            </div>
                                            <div class="card-body">

                                                <div class="row">
                                                    <div class="row col-12 mb-2" id="@("contenedorExpedienteGarantia-" + expedienteRegistrado.IdExpediente)">
                                                        <div class="col-12 col-md-12" id="@("exp-grnt-info-container-" + expedienteRegistrado.IdExpediente)">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                </div>




                            }
                        </div>


                        <div id=@("calcint"+ expedienteRegistrado.IdExpediente) class="panelExp panelcalculadora" style="display:none">

                            @{
                                CalculadoraDemandaLiquidacion _calculadora = ViewBag.Calculadora;
                            }
                            <input type="hidden" value="@_calculadora.EsAdministrador.ToString()" id="esadministrador" />
                            <input id="IdExpedienteJudicialCalculadora" type="hidden" name="IdExpedienteJudicial" value="@expedienteRegistrado.IdExpediente" />
                            <input id="TramiteCobroCalculadora" type="hidden" name="IdTramiteCobroJudicial" value="@expedienteRegistrado.IdTramiteCobroJudicial" />
                            <div class="row" id="divId" style="display:none">
                                <div class="col-12 mb-2">
                                    <input class="form-control IdCalculadoraDemandaLiquidacion@(expedienteRegistrado.IdExpediente)" asp-label-position="horizontal_left"
                                           asp-name="@_calculadora.IdCalculadoraDemandaLiquidacion" data-type="integer"
                                           value="@_calculadora.IdCalculadoraDemandaLiquidacion"
                                           asp-label="Id" asp-plain-numeric-text="true" readonly />
                                </div>
                            </div>

                            <div class="row" style="display:none">
                                <div class="col-12 mb-2">
                                    <select class="selectpicker form-control" title="Seleccione ..." asp-label="Tipo Calculadora" asp-label-position="horizontal_left" asp-name="@_calculadora.IdTipoCalculadora"
                                            data-live-search="true" select-items="@ViewBag.TipoCalculadora" select-item-value="IdTipoCalculadora" select-item-name="Descripcion" select-selected-value="@ViewBag.IdTipoCalculadora"
                                            asp-validate="true" data-width="100%" data-style="border" id="cboIdTipoCalculadora"></select>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-12 mb-2">
                                    <input class="form-control" asp-label-position="horizontal_left" asp-label="Número Operación" asp-name="@_calculadora.NumeroOperacion"
                                           maxlength="14" value="@Model.NumOperacion" asp-validate="true" id="NumOperacion" data-set-focus disabled />
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-12 mb-2">
                                    <input class="form-control CalcularMontoInteresCorriente MontoCapitalCalculadora MontoCapitalCalculadora@(expedienteRegistrado.IdExpediente)"
                                           asp-label-position="horizontal_left" asp-label="Saldo"
                                           name="SaldoOperacionCalculadora" value="@ViewBag.SaldoOperacion"
                                           data-type="decimal" asp-decimal-digits="2" asp-validate="true" id="MontoCapitalCalculadora"
                                           data-idexpediente="@expedienteRegistrado.IdExpediente" />
                                </div>
                            </div>

                            <div class="row" id="myDivTasaInteresCorriente">
                                <input type="hidden" id="tasainteresh@(expedienteRegistrado.IdExpediente)" value="@_calculadora.TasaInteresCorriente" />

                                @if (_calculadora.TasaInteresCorriente == null || _calculadora.IdCalculadoraDemandaLiquidacion == -1)
                                {
                                    <div class="col-12 mb-2">
                                        <input class="form-control CalcularMontoInteresCorriente TasaInteresCorrienteCalculadora@(expedienteRegistrado.IdExpediente)" asp-label-position="horizontal_left" asp-label="Tasa Interés Corriente"
                                               asp-name="@_calculadora.TasaInteresCorriente" value="@_calculadora.TasaInteresCorriente"
                                               data-type="decimal" asp-decimal-digits="2" asp-validate="true" id="TasaInteresCorrienteCalculadora" maxlength="5"
                                               data-idexpediente="@expedienteRegistrado.IdExpediente" />
                                    </div>
                                }
                                else
                                {
                                    <div class="col-12 mb-2">
                                        <input class="form-control CalcularMontoInteresCorriente TasaInteresCorrienteCalculadora@(expedienteRegistrado.IdExpediente)" asp-label-position="horizontal_left" asp-label="Tasa Interés Corriente"
                                               asp-name="@_calculadora.TasaInteresCorriente" value='@_calculadora.TasaInteresCorriente?.ToString("#,##.00")'
                                               data-type="decimal" asp-decimal-digits="2" asp-validate="true" id="TasaInteresCorrienteCalculadora"
                                               data-idexpediente="@expedienteRegistrado.IdExpediente" readonly ondblclick="habilitarInput(this, '')" maxlength="5" />
                                    </div>
                                }
                            </div>

                            <div class="row">

                                <div class="col-12 mb-2" style="display:@(_calculadora.FechaUltimoPago == null || _calculadora.IdCalculadoraDemandaLiquidacion == -1 ? "" : "none")" id="divFechaUltPagoCalculadora">
                                    <input id="txtFechaUltimoPagoCalculadora" type="date"
                                           class="form-control  CalcularDiasInteresCorriente txtFechaUltimoPagoCalculadora@(expedienteRegistrado.IdExpediente)"
                                           asp-label="Fecha Último Pago"
                                           asp-label-position="horizontal_left"
                                           name="FechaUltimoPago" value="@_calculadora.FechaUltimoPago?.ToString("dd/MM/yyyy")"
                                           asp-datepicker="true" asp-datepicker-format="DD/MM/YYYY" asp-validate="true"
                                           data-idexpediente="@expedienteRegistrado.IdExpediente" />


                                </div>

                                <div class="col-12 mb-2" style="display:@(_calculadora.FechaUltimoPago != null && _calculadora.IdCalculadoraDemandaLiquidacion != -1? "" : "none")" id="divtxtFechaUltPagoCalculadora">
                                    <input id="txtFechaUltimoPagoCalculadoraShow" type="text" class="form-control " asp-label="Fecha Último Pago" asp-label-position="horizontal_left"
                                           name="txtFechaUltimoPagoCalculadoraShow" value="@_calculadora.FechaUltimoPago?.ToString("dd/MM/yyyy")"
                                           readonly ondblclick="habilitarInput(this, 'divFechaUltPagoCalculadora')"
                                           data-idexpediente="@expedienteRegistrado.IdExpediente" />
                                </div>

                            </div>
                            <div class="row" id="myDivFechaCorteInteresCorriente">

                                <div class="col-12 mb-2" style="display:@(_calculadora.FechaCorteInteresCorriente == null || _calculadora.IdCalculadoraDemandaLiquidacion == -1 ? "" : "none")" id="divFechaCorteInteresCorrienteCalculadora">
                                    <input id="txtFechaCorteInteresCorrienteCalculadora" type="date"
                                           class="form-control  CalcularDiasInteresCorriente txtFechaCorteInteresCorrienteCalculadora@(expedienteRegistrado.IdExpediente)"
                                           asp-label="Fecha Corte Interés Corriente" asp-label-position="horizontal_left"
                                           name="FechaCorteInteresCorriente" value="@_calculadora.FechaCorteInteresCorriente?.ToString("dd/MM/yyyy")"
                                           asp-datepicker="true" asp-datepicker-format="DD/MM/YYYY" asp-validate="true"
                                           data-idexpediente="@expedienteRegistrado.IdExpediente" />


                                </div>

                                <div class="col-12 mb-2" style="display:@(_calculadora.FechaCorteInteresCorriente != null && _calculadora.IdCalculadoraDemandaLiquidacion != -1 ? "" : "none")" id="divtxtFechaCorteInteresCorrienteCalculadora">
                                    <input id="txtFechaCorteInteresCorrienteCalculadoraShow" type="text" class="form-control " asp-label="Fecha Corte Interés Corriente" asp-label-position="horizontal_left"
                                           name="txtFechaCorteInteresCorrienteCalculadoraShow" value="@_calculadora.FechaCorteInteresCorriente?.ToString("dd/MM/yyyy")"
                                           readonly ondblclick="habilitarInput(this, 'divFechaCorteInteresCorrienteCalculadora')"
                                           data-idexpediente="@expedienteRegistrado.IdExpediente" />
                                </div>

                            </div>

                            <div class="row" id="myDivDiasInteresCorriente">
                                <div class="col-12 mb-2">
                                    <input class="form-control DiasInteresCorrienteCalculadora@(expedienteRegistrado.IdExpediente)" asp-label-position="horizontal_left" name="DiasInteresCorrienteCalculadora" data-type="integer"
                                           value="@_calculadora.DiasInteresCorriente"
                                           asp-label="Días Interés Corriente" asp-plain-numeric-text="true" id="DiasInteresCorrienteCalculadora" readonly
                                           data-idexpediente="@expedienteRegistrado.IdExpediente" />
                                </div>
                            </div>

                            <div class="row" id="myDivMontoInteresCorriente">
                                <div class="col-12 mb-2">
                                    <input class="form-control MontoInteresCorrienteCalculadora@(expedienteRegistrado.IdExpediente)" asp-label-position="horizontal_left" asp-label="Monto Interés Corriente"
                                           asp-name="@_calculadora.MontoInteresCorriente" value="@_calculadora.MontoInteresCorriente"
                                           data-type="decimal" asp-decimal-digits="2" asp-validate="true" id="MontoInteresCorrienteCalculadora" readonly
                                           data-idexpediente="@expedienteRegistrado.IdExpediente" />
                                </div>
                            </div>

                            <div class="row" id="myDivTasaInteresMora">
                                <div class="col-12 mb-2">
                                    <input type="hidden" id="tasainteresmorah@(expedienteRegistrado.IdExpediente)" value="@_calculadora.TasaInteresMora" />
                                    @if (_calculadora.TasaInteresMora == null || _calculadora.IdCalculadoraDemandaLiquidacion == -1)
                                    {
                                        <input class="form-control TasaInteresMoraCalculadora@(expedienteRegistrado.IdExpediente)" asp-label-position="horizontal_left" asp-label="Tasa Interés Mora"
                                               asp-name="@_calculadora.TasaInteresMora" value="@_calculadora.TasaInteresMora"
                                               data-type="decimal" asp-decimal-digits="2" asp-validate="true" id="TasaInteresMoraCalculadora" maxlength="5"
                                               data-idexpediente="@expedienteRegistrado.IdExpediente" />
                                    }
                                    else
                                    {
                                        <input class="form-control TasaInteresMoraCalculadora@(expedienteRegistrado.IdExpediente) CalcularMontoInteresMoraDemanda" asp-label-position="horizontal_left" asp-label="Tasa Interés Mora" asp-name="@_calculadora.TasaInteresMora"
                                               value="@_calculadora.TasaInteresMora?.ToString("#,##.00")" data-type="decimal" asp-decimal-digits="2" asp-validate="true" id="TasaInteresMoraCalculadora"
                                               readonly ondblclick="habilitarInput(this, '')" maxlength="5" data-idexpediente="@expedienteRegistrado.IdExpediente" />
                                    }

                                </div>
                            </div>

                            <div class="row" id="myDivFechaCorteInteresMora">

                                <div class="col-12 mb-2" style="display:@(_calculadora.FechaLiquidacionDemanda == null || _calculadora.IdCalculadoraDemandaLiquidacion == -1 ? "" : "none")" id="divFechaCorteInteresMoraCalculadora">
                                    <input id="txtFechaCorteInteresMoraCalculadora" type="date" class="form-control txtFechaCorteInteresMoraCalculadora@(expedienteRegistrado.IdExpediente)" asp-label="Fecha Corte Interés Mora" asp-label-position="horizontal_left"
                                           asp-name="@_calculadora.FechaCorteInteresMora" value="@_calculadora.FechaCorteInteresMora?.ToString("dd/MM/yyyy")"
                                           asp-datepicker="true" asp-datepicker-format="DD/MM/YYYY" asp-validate="true" data-idexpediente="@expedienteRegistrado.IdExpediente" />


                                </div>

                                <div class="col-12 mb-2" style="display:@(_calculadora.FechaLiquidacionDemanda != null && _calculadora.IdCalculadoraDemandaLiquidacion != -1 ? "" : "none")" id="divtxtFechaCorteInteresMoraCalculadora">
                                    <input id="txtFechaCorteInteresMoraCalculadoraShow" type="text" class="form-control" asp-label="Fecha Corte Interés Mora" asp-label-position="horizontal_left"
                                           name="txtFechaCorteInteresMoraCalculadoraShow" value="@_calculadora.FechaCorteInteresMora?.ToString("dd/MM/yyyy")"
                                           readonly ondblclick="habilitarInput(this, 'divFechaCorteInteresMoraCalculadora')" data-idexpediente="@expedienteRegistrado.IdExpediente" />
                                </div>

                            </div>

                            <div class="row" id="myDivFechaLiquidacionDemanda">
                                <div class="col-12 mb-2" style="display:@(_calculadora.FechaLiquidacionDemanda == null || _calculadora.IdCalculadoraDemandaLiquidacion == -1? "" : "none")" id="divFechaLiqCalculadora">
                                    <input id="txtFechaLiquidacionDemandaCalculadora" type="date" class="form-control txtFechaLiquidacionDemandaCalculadora txtFechaLiquidacionDemandaCalculadora@(expedienteRegistrado.IdExpediente)" asp-label="Fecha Liquidación Demanda" asp-label-position="horizontal_left"
                                           asp-name="@_calculadora.FechaLiquidacionDemanda" value="@_calculadora.FechaLiquidacionDemanda?.ToString("dd/MM/yyyy")"
                                           asp-datepicker="true" asp-datepicker-format="DD/MM/YYYY" asp-validate="true" data-idexpediente="@expedienteRegistrado.IdExpediente" />


                                </div>

                                <div class="col-12 mb-2" style="display:@(_calculadora.FechaLiquidacionDemanda != null && _calculadora.IdCalculadoraDemandaLiquidacion != -1? "" : "none")" id="divtxtFechaLiqCalculadora">
                                    <input id="txtFechaLiquidacionDemandaCalculadoraShow" type="text" class="form-control" asp-label="Fecha Liquidación Demanda" asp-label-position="horizontal_left"
                                           name="txtFechaLiquidacionDemandaCalculadoraShow" value="@_calculadora.FechaLiquidacionDemanda?.ToString("dd/MM/yyyy")"
                                           readonly ondblclick="habilitarInput(this, 'divFechaLiqCalculadora')" data-idexpediente="@expedienteRegistrado.IdExpediente" />
                                </div>
                            </div>

                            <div class="row" id="myDivDiasInteresMora">
                                <div class="col-12 mb-2">
                                    <input class="form-control DiasInteresMoraCalculadora@(expedienteRegistrado.IdExpediente)" asp-label-position="horizontal_left" asp-name="@_calculadora.DiasInteresMora" data-type="integer" value="@_calculadora.DiasInteresMora"
                                           asp-label="Días Interés Mora" asp-plain-numeric-text="true" id="DiasInteresMoraCalculadora" readonly data-idexpediente="@expedienteRegistrado.IdExpediente" />
                                </div>
                            </div>

                            <div class="row" id="myDivMontoInteresMora">
                                <div class="col-12 mb-2">
                                    <input class="form-control MontoInteresMoraCalculadora@(expedienteRegistrado.IdExpediente)" asp-label-position="horizontal_left" asp-label="Monto Interés Mora" asp-name="@_calculadora.MontoInteresMora" value="@_calculadora.MontoInteresMora"
                                           data-type="decimal" asp-decimal-digits="2" asp-validate="true" id="MontoInteresMoraCalculadora" readonly data-idexpediente="@expedienteRegistrado.IdExpediente" />
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-12 mb-2" id="myDivMontoTotalInteres">
                                    <input class="form-control MontoTotalInteresCalculadora MontoTotalInteresCalculadora@(expedienteRegistrado.IdExpediente)" asp-label-position="horizontal_left" asp-label="Monto Total Interés" asp-name="@_calculadora.MontoTotalInteres" value="@_calculadora.MontoTotalInteres"
                                           data-type="decimal" asp-decimal-digits="2" asp-validate="true" id="MontoTotalInteresCalculadora" readonly data-idexpediente="@expedienteRegistrado.IdExpediente" />
                                </div>
                            </div>

                            <div class="row" id="myDivDiasInteresDiferenciaCorrienteMora">
                                <div class="col-12 mb-2">
                                    <input class="form-control DiasInteresDiferenciaCorrienteMoraCalculadora@(expedienteRegistrado.IdExpediente)" asp-label-position="horizontal_left" asp-name="@_calculadora.DiasInteresDiferenciaCorrienteMora" data-type="integer" value="@_calculadora.DiasInteresDiferenciaCorrienteMora"
                                           asp-label="Total de Días" asp-plain-numeric-text="true" id="DiasInteresDiferenciaCorrienteMoraCalculadora" readonly data-idexpediente="@expedienteRegistrado.IdExpediente" />
                                </div>
                            </div>

                            <div class="row" id="myDivMontoCuantia">
                                <div class="col-12 mb-2">
                                    <input class="form-control MontoCuantiCalculadora@(expedienteRegistrado.IdExpediente)" asp-label-position="horizontal_left" asp-label="Monto Cuantía" asp-name="@expedienteRegistrado.Cuantia" value="@expedienteRegistrado.Cuantia"
                                           data-type="decimal" asp-decimal-digits="2" asp-validate="true" id="MontoCuantiCalculadora"
                                           data-idexpediente="@expedienteRegistrado.IdExpediente" disabled="disabled" />
                                </div>
                            </div>

                            <progress-bar-container class="progressbar-container" progress-bar-height="25px">
                                <progress-bar class="bg-bp-primary" progress-bar-text="Cargando Información..." progress-bar-valuenow="100" data-idexpediente="@expedienteRegistrado.IdExpediente" />
                            </progress-bar-container>
                            <div class="row">
                                <div class="card-body d-flex justify-content-end align-items-end">
                                    <button id="btnGuardarCalc@(@expedienteRegistrado.IdExpediente)" IdExpediente="@expedienteRegistrado.IdExpediente" type="button" class="btn btn-outline-success btnActualizarCalculadora" data-idexpediente="@expedienteRegistrado.IdExpediente"><i class="far fa-save mr-2"></i>Guardar Cálculo</button>
                                </div>
                            </div>
                        </div>


                    </div>
                </div>


            }
        }


        <div class="tab-pane container-fluid fade d-none" role="tabpanel" id="nuevoExpediente">

            <div class="container-fluid mt-2" id="ExpedienteModel">

                <input type="hidden" id="txtIdTramite" value="@Model.IdTramiteJudicial" name="IdTramiteJudicial" />
                <input type="hidden" class="form-control" name="IdExpediente" value="0" />
                <input type="hidden" class="form-control" name="NumOperacion" value="@Model.NumOperacion" />

                <div class="row mb-2">
                    <div class="col-12 col-md-3">
                        <select id="cboTipoGarantia" class="selectpicker show-tick" title="Seleccione una opción..." asp-label="Tipo de Garantía" name="TipoGarantia"
                                select-items="@Model.LstGarantias" select-item-value="Codigo" select-item-name="Descripcion" select-selected-value="@Model.TipoGarantia"
                                data-width="100%" data-style="border" asp-validate="true"></select>
                    </div>
                    @if (estadoTramite == 5)
                    {
                        /*<div class="col-12 col-md-3">
                            <input id="txtFechaLiquidacionAgregar" type="date" class="form-control" asp-label="Fecha Liquidación"
                                   name="FechaLiquidacion" asp-datepicker="true" asp-datepicker-format="DD/MM/YYYY" asp-validate="true" />
                        </div>
                        <div class="col-12 col-md-3">
                            <input id="txtTasaLiquidacionAgregar" class="form-control" asp-label="Tasa Liquidación" name="TasaLiquidacion"
                                   data-type="integer" asp-decimal-digits="2" asp-validate="true" />
                        </div>*/
                        <div class="col-12 col-md-3">
                            <input id="txtCuantiaAgregar" class="form-control" asp-label="Cuantía" name="Cuantia"
                                   data-type="integer" asp-decimal-digits="2" asp-validate="true" readonly />
                        </div>
                    }
                </div>

                <div class="row mb-2">
                    @if (estadoTramite == 5)
                    {
                        <div class="col-12 col-md-3">
                            <input type="text" id="txtNumExpedienteAgregar" asp-validate="true" maxlength="17" class="form-control" name="NumExpedienteJudicial" asp-label="Número Expediente Judicial" asp-validate="true" />
                        </div>

                        <div class="col-12 col-md-3">
                            <input type="text" id="txtAnnioAgregar" onkeypress='return event.charCode >= 48 && event.charCode <= 57' maxlength="4"
                                   class="form-control" asp-label="Año" name="Annio" asp-validate="true" />
                        </div>
                    }

                    <div class="col-12 col-lg-3">
                        <input id="txtFechaDemandaAgregar" type="date" class="form-control" asp-label="Fecha de presentación de la demanda"
                               name="FechaPresentacionDemanda" asp-datepicker="true" asp-datepicker-format="DD/MM/YYYY" asp-validate="true" />
                    </div>
                    @*@if (estadoTramite == 2)
            {*@
                    <div class="col-12 col-lg-3">
                        <RadioButtonsGroup class="radio" asp-label="Apersonamiento" name="EsApersonamiento" asp-validate="true">
                            <RadioButtonItem class="btn btn-outline-info" data-type="boolean" data-nullable="true" value="true" label="Sí" />
                            <RadioButtonItem class="btn btn-outline-info" data-type="boolean" data-nullable="true" value="false" label="No" />
                        </RadioButtonsGroup>
                    </div>
                    @*}*@
                </div>

                @if (estadoTramite == 5)
                {
                    <div class="row mb-5">

                        <div class="col-12 col-md-6">
                            <select id="txtEstadoActualizacionAgregar" class="selectpicker show-tick" title="Seleccione una opción..." asp-label="Estado de la Actualización" name="IdExpedienteJudicialEstado"
                                    select-items="@Model.LstEstadosExpediente" select-item-value="IdExpedJudicEstado" select-item-name="NombreExpedJudicEstado"
                                    data-width="100%" data-style="border" asp-validate="true"></select>
                        </div>

                        <div class="col-12 col-md-4">
                            <select id="cboCodAbogados" class="selectpicker form-control" title="..." asp-label="Código Abogado" name="IdCodigoAbogado"
                                    select-items="@Model.LstCodigosAbogados" select-item-value="Id" select-item-name="CodigoNombreCompleto"
                                    data-width="100%" data-style="border" data-live-search="true" asp-validate="true"></select>
                        </div>

                        <div class="col-12 col-md-6">
                            <select id="cboTipoProcesosAgregar" class="selectpicker show-tick" title="Seleccione una opción..." asp-label="Tipo de Proceso"
                                    select-items="@Model.LstTipoProceso" select-item-value="Codigo" select-item-name="Descripcion"
                                    name="IdTipoProcesoJudicial" data-width="100%" data-style="border" data-live-search="true" asp-validate="true"></select>
                        </div>

                    </div>

                    <div class="mb-5">
                        <p>Seleccionar despacho por Provincia/Cantón/Distrito</p>
                        <div class="row">
                            <div class="col-12 col-md-4">
                                <select id="ddlProvinciasAgregar" class="selectpicker show-tick" title="Seleccione una opción..." asp-label="Provincia" name="ProvinciaCircuitJudic"
                                        select-items="@Model.LstProvincias" select-item-value="CodProvincia" select-item-name="Descripcion"
                                        data-width="100%" data-style="border" data-live-search="true" asp-validate="true"></select>
                            </div>

                            <div class="col-12 col-md-4">
                                <select id="ddlCantonesAgregar" class="selectpicker show-tick" title="Seleccione una opción..." asp-label="Cantón" name="CantonCircuitJudic"
                                        data-width="100%" data-style="border" data-live-search="true" asp-validate="true"></select>
                            </div>

                            <div class="col-12 col-md-4">
                                <select id="ddlDistritosAgregar" class="selectpicker show-tick" title="Seleccione una opción..." asp-label="Distrito" name="DistritoCircuitJudic"
                                        data-width="100%" data-style="border" data-live-search="true" asp-validate="true"></select>
                            </div>
                        </div>
                    </div>

                    <div class="row mb-2">
                        <div class="col-12 col-md-6">
                            <select id="circuitoJudicialAgregar" class="selectpicker show-tick" title=" " asp-label="Circuito Judicial" name="CircuitoJudicial"
                                    select-items="@Model.LstDespachoJudicial" select-item-value="Codigo" select-item-name="Descripcion"
                                    data-width="100%" data-style="border" disabled asp-validate="true"></select>
                        </div>
                        <div class="col-12 col-md-6">
                            <select id="autoridadJAAgregar" class="selectpicker show-tick" title=" " asp-label="Autoridad judicial administrativa" name="AutoridadJudicial"
                                    select-items="@Model.LstDespachoJudicial" select-item-value="Codigo" select-item-name="Descripcion"
                                    data-width="100%" data-style="border" disabled asp-validate="true"></select>
                        </div>
                    </div>

                    <div class="row mb-2">
                        <div class="col-12 col-md-6">
                            <input id="txtFechaUltimaGestionAgregar" type="date" class="form-control" asp-label="Fecha última gestión"
                                   name="FechaUltimaGestion" asp-datepicker="true" asp-datepicker-format="DD/MM/YYYY" asp-validate="true" />
                        </div>
                        <div class="col-12 col-md-6">
                            <input type="text" id="mesesUltimaGestionAgregar" class="form-control" asp-label="Meses de última gestión"
                                   name="MesesUltimaGestion" disabled />
                        </div>
                    </div>

                    <div class="row mb-2">
                        <div class="col-12 col-md-4">
                            <input id="fechaSentenciaAgregar" type="date" class="form-control" asp-label="Fecha Sentencia"
                                   name="FechaSentencia" asp-datepicker="true" asp-datepicker-format="DD/MM/YYYY" asp-validate="true" />
                        </div>
                    </div>

                    <div class="row mb-2 mt-4">
                        <div class="col-12 col-md-4">
                            <select id="cboCodGestionResolucionTransAgregar" class="selectpicker form-control" title="Seleccione una opción..." asp-label="Código gestión resolución transitoria" name="CodigoGestionTransitoria"
                                    select-items="@Model.LstCodigosGestionResolucion" select-item-value="Codigo" select-item-name="CodigoInterno,Descripcion" select-item-name-format="{0} - {1}"
                                    data-width="100%" data-style="border" data-live-search="true" asp-validate="true"></select>
                        </div>
                        <div class="col-12 col-md-4">
                            <select id="cboCodGestionResolucionUltAgregar" class="selectpicker form-control" title="Seleccione una opción..." asp-label="Código última gestión" name="CodigoUltimaResolucion"
                                    select-items="@Model.LstCodigosGestionResolucion" select-item-value="Codigo" select-item-name="CodigoInterno,Descripcion" select-item-name-format="{0} - {1}"
                                    data-width="100%" data-style="border" data-live-search="true" asp-validate="true"></select>
                        </div>
                    </div>
                }

                <div class="row mb-2">
                    @*<div class="col-12 col-md-4">
                <select id="cboCodAbogados" class="selectpicker form-control" title="..." asp-label="Código Abogado" name="IdCodigoAbogado"
                        select-items="@Model.LstCodigosAbogados" select-item-value="Id" select-item-name="CodigoNombreCompleto"
                        data-width="100%" data-style="border" data-live-search="true" asp-validate="true"></select>
            </div>*@

                    @if (estadoTramite == 5)
                    {
                        <div class="col-12 col-md-4">
                            <input id="txtSaldoDescubiertoAgregar" class="form-control" data-type="integer" asp-label="Saldo descubierto" name="SaldoDescubierto" asp-decimal-digits="2"
                                   asp-plain-numeric-text="true" asp-validate="true" />
                        </div>

                        <div class="col-12 col-md-4">
                            <input id="fechaFirmezaAgregar" type="date" class="form-control" asp-label="Fecha firmeza"
                                   name="FechaFirmeza" asp-datepicker="true" asp-datepicker-format="DD/MM/YYYY" asp-validate="true" />
                        </div>
                    }
                </div>

                <div class="row mb-2">
                    @if (estadoTramite == 5)
                    {
                        <div class="col-12 col-md-4">
                            <select id="cboCondicionAgregar" class="selectpicker show-tick" title="Seleccione una opción..." asp-label="Condición" name="Condicion"
                                    select-items="@Condicion" select-item-value="Key" select-item-name="Value"
                                    data-width="100%" data-style="border" data-live-search="true" asp-validate="true"></select>
                        </div>
                    }
                    <div class="col-12 col-md-4">
                        <select id="cboEstadoAgregar" class="selectpicker show-tick" title="Seleccione una opción..." asp-label="Estado" name="Activo"
                                select-items="@Estado" select-item-value="Key" select-item-name="Value"
                                data-width="100%" data-style="border" asp-validate="true"></select>
                    </div>
                    <div class="col-12 col-md-4">
                        <select id="cboCodAbogados" class="selectpicker form-control" title="..." asp-label="Código Abogado"
                                name="IdCodigoAbogado"
                                select-items="@Model.LstCodigosAbogados"
                                select-item-value="Id" select-item-name="Codigo,NombreCompleto" select-item-name-format="{0} - {1}"
                                data-width="100%" data-style="border" data-live-search="true" asp-validate="true"></select>
                    </div>

                </div>

                <div class="row">
                    <div class="card-body d-flex justify-content-end align-items-end">
                        <button id="btnGuardarExpediente" type="button" class="btn btn-outline-success"><i class="far fa-save mr-2"></i>Guardar Registro</button>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>

<modal id="ExpedienteExistenteAgregarModal" modal-size="xl">
    <modal-header class="bg-bp-primary text-white">
        <modal-title id="exampleModalLabel">Agregar Expediente Existente</modal-title>
    </modal-header>
    <modal-body>
        <div class="container-fluid" id="ExpedienteExistenteModel">
            <div class="row">

                <input type="hidden" id="txtIdExpediente" value="@Model.IdTramiteJudicial" name="IdTramiteCobroJudicial" />

                <div class="col-12 col-md-6 col-lg-6">
                    <select id="cboExpedienteExistenteAgregar" class="selectpicker show-tick" title="Seleccione una opción..." asp-label="Seleccione un Expediente Judicial"
                            select-items="@Model.LstExpedientesExistentes" select-item-value="IdExpediente" select-item-name="IdExpediente,NumExpedienteJudicial" select-item-name-format="{0} - {1}"
                            name="IdExpediente" data-width="100%" data-style="border" data-live-search="true"></select>
                </div>

            </div>
        </div>
    </modal-body>
    <modal-footer>
        <btn-cerrar id="btnCerrar" data-dismiss="modal" />
        <btn-guardar-registro id="btnCrearExpedienteExistente" />
    </modal-footer>
</modal>

<modal id="RemateAgregarModal" modal-size="xl">
    <modal-header class="bg-bp-primary text-white">
        <modal-title id="exampleModalLabel">Agregar Remate</modal-title>
    </modal-header>
    <modal-body>
        <div class="container-fluid" id="RemateModel">
            <div class="row">
                <div class="col-md-4 col-sm-12 mb-2">
                    <input type="hidden" id="hidIdExpedienteRemate" name="IdExpediente" value="" />
                    <input id="txtFechaRemateAgregar" type="date" class="form-control" asp-label="Fecha Remate"
                           name="FechaRemate" asp-datepicker="true" asp-datepicker-format="DD/MM/YYYY" asp-validate="true" />
                </div>
                <div class="col-md-4 col-sm-12 mb-2">
                    <input id="txtMontoBaseAgregar" class="form-control" asp-label="Monto base" name="MontoBase" data-type="integer"
                           asp-decimal-digits="2" value="" asp-validate="true" />
                </div>
                <div class="col-md-4 col-sm-12 mb-2">
                    <select id="estadoRemateAgregar" class="selectpicker show-tick" title="Seleccione una opción..." asp-label="Estado" name="Activo"
                            select-items="@Estado" select-item-value="Key" select-item-name="Value"
                            data-width="100%" data-style="border" asp-validate="true"></select>
                </div>
            </div>
        </div>
        <progress-bar-container class="progressbar-container progressremate" progress-bar-height="25px">
            <progress-bar class="bg-bp-primary" progress-bar-text="Cargando Información..." progress-bar-valuenow="100" />
        </progress-bar-container>
    </modal-body>
    <modal-footer>
        <btn-cerrar id="btnCerrar" data-dismiss="modal" />
        <btn-guardar-registro id="btnGuardarRemate" />
    </modal-footer>
</modal>


<modal id="CodigosAgregarModal" modal-size="xl">
    <modal-header class="bg-bp-primary text-white">
        <modal-title id="exampleModalLabel">Agregar Código de Gestión y Resolución</modal-title>
    </modal-header>
    <modal-body>
        <div class="container-fluid info-container">
        </div>
        <progress-bar-container class="progressbar-container" progress-bar-height="25px">
            <progress-bar class="bg-bp-primary" progress-bar-text="Cargando Información..." progress-bar-valuenow="100" />
        </progress-bar-container>
    </modal-body>
    <modal-footer>
        <btn-cerrar id="btnCerrarCodigoModal" data-dismiss="modal" />
        <btn-guardar-registro class="btn-guardar-codigo-gestion-resol" />
    </modal-footer>
</modal>


<modal id="adj-demanda-modal" modal-size="xl">
    <modal-header class="bg-bp-primary text-white">
        <modal-title>Adjuntar Demanda</modal-title>
    </modal-header>
    <modal-body>
        <div id="contenedor-guardar" class="info-container">
        </div>
        <progress-bar-container class="progressbar-container" progress-bar-height="25px">
            <progress-bar class="bg-bp-primary" progress-bar-text="Cargando Información..." progress-bar-valuenow="100" />
        </progress-bar-container>
    </modal-body>
    @*<modal-footer>
            <btn-cerrar id="btnCerrar" data-dismiss="modal" />
            <btn-guardar-registro id="btnGuardarParte" />
        </modal-footer>*@
</modal>

<modal id="FechaRematePuestaPosesionAgregarModal" modal-size="xl">
    <modal-header class="bg-bp-primary text-white">
        <modal-title id="exampleModalLabel">Agregar Fecha Remate Puesta Posesión</modal-title>
    </modal-header>
    <modal-body>
        <div class="container-fluid" id="FechaRematePuestaPosesionModel">
            <div class="row">
                <div class="col-md-4 col-sm-12 mb-2">
                    <input type="hidden" id="hidExpedienteJudicialFechaRematePuestaPosesion" name="IdExpedienteJudicial" value="" />
                    <input type="hidden" id="hTramiteCobroFechaRematePuestaPosesion" name="TramiteCobro" value="" />
                    <input type="hidden" id="hNumOperacionFechaRematePuestaPosesion" name="NumOperacion" value="" />

                    <input id="txtFechaRemate1Agregar" type="date" class="form-control" asp-label="Fecha Remate 1"
                           name="FechaRemate1" asp-datepicker="true" asp-datepicker-format="DD/MM/YYYY" asp-validate="true" />
                </div>
                <div class="col-md-4 col-sm-12 mb-2">
                    <input id="txtFechaRemate2Agregar" type="date" class="form-control" asp-label="Fecha Remate 2"
                           name="FechaRemate2" asp-datepicker="true" asp-datepicker-format="DD/MM/YYYY" asp-validate="true" />
                </div>
                <div class="col-md-4 col-sm-12 mb-2">
                    <input id="txtFechaRemate3Agregar" type="date" class="form-control" asp-label="Fecha Remate 3"
                           name="FechaRemate3" asp-datepicker="true" asp-datepicker-format="DD/MM/YYYY" asp-validate="true" />
                </div>
                <div class="col-md-4 col-sm-12 mb-2">
                    <input id="txtHoraRemate1Agregar" type="time" class="form-control" asp-label="Hora Remate 1"
                           name="HoraRemate1" asp-datepicker="true" asp-validate="true" />
                </div>
                <div class="col-md-4 col-sm-12 mb-2">
                    <input id="txtHoraRemate2Agregar" type="time" class="form-control" asp-label="Hora Remate 2"
                           name="HoraRemate2" asp-datepicker="true" asp-validate="true" />
                </div>
                <div class="col-md-4 col-sm-12 mb-2">
                    <input id="txtHoraRemate3Agregar" type="time" class="form-control" asp-label="Hora Remate 3"
                           name="HoraRemate3" asp-datepicker="true" asp-validate="true" />
                </div>
                <div class="col-md-4 col-sm-12 mb-2">
                    <input id="txtMontoRemateBase1Agregar" class="form-control" asp-label="Monto Remate Base 1" name="MontoRemateBase1" data-type="decimal"
                           asp-decimal-digits="2" value="" asp-validate="true" />
                </div>
                <div class="col-md-4 col-sm-12 mb-2">
                    <input id="txtMontoRemateBase2Agregar" class="form-control" asp-label="Monto Remate Base 2" name="MontoRemateBase2" data-type="decimal"
                           asp-decimal-digits="2" value="" asp-validate="true" disabled />
                </div>
                <div class="col-md-4 col-sm-12 mb-2">
                    <input id="txtMontoRemateBase3Agregar" class="form-control" asp-label="Monto Remate Base 3" name="MontoRemateBase3" data-type="decimal"
                           asp-decimal-digits="2" value="" asp-validate="true" disabled />
                </div>
                <div class="col-md-4 col-sm-12 mb-2">
                    <input id="txtSaldoDecretadoJudicialAgregar" class="form-control" asp-label="Saldo Decretado Judicial" name="SaldoDecretadoJudicial" data-type="decimal"
                           asp-decimal-digits="2" value="" asp-validate="true" />
                </div>
                <div class="col-md-4 col-sm-12 mb-2">
                    <input id="txtFechaProtocolizacionAgregar" type="date" class="form-control" asp-label="Fecha Protocolización"
                           name="FechaProtocolizacion" asp-datepicker="true" asp-datepicker-format="DD/MM/YYYY" asp-validate="true" />
                </div>
                <div class="col-md-4 col-sm-12 mb-2">
                    <input id="txtFechaPuestaPosesionAgregar" type="date" class="form-control" asp-label="Fecha Puesta Posesión"
                           name="FechaPuestaPosesion" asp-datepicker="true" asp-datepicker-format="DD/MM/YYYY" asp-validate="true" />
                </div>
            </div>
        </div>

        <progress-bar-container class="progressbar-container progressfecharemate" progress-bar-height="25px">
            <progress-bar class="bg-bp-primary" progress-bar-text="Cargando Información..." progress-bar-valuenow="100" />
        </progress-bar-container>

    </modal-body>
    <modal-footer>
        <btn-cerrar id="btnCerrar" data-dismiss="modal" />
        <btn-guardar-registro id="btnGuardarFechaRematePuestaPosesion" />
    </modal-footer>
</modal>

<modal id="ResultadosRemateAgregarModal" modal-size="xl">
    <modal-header class="bg-bp-primary text-white">
        <modal-title id="exampleModalLabel">Agregar Resultados de Remate</modal-title>
    </modal-header>
    <modal-body>
        <div class="container-fluid" id="ResultadosRemateModel">
            <div class="row">
                <div class="col-md-4 col-sm-12 mb-2">
                    <input type="hidden" id="hIdResultadosRemate" name="IdResultadosRemate" value="" />
                    <input type="hidden" id="hIdExpedienteJudicialResultadosRemate" name="IdExpedienteJudicial" value="" />
                    <input type="hidden" id="hTramiteCobroResultadosRemate" name="TramiteCobro" value="" />
                    <input type="hidden" id="hNumOperacionResultadosRemate" name="NumOperacion" value="" />
                    <input type="hidden" id="hIdFechaRematePuestaPosesionResultadosRemate" name="IdFechaRematePuestaPosesion" value="" />

                    <RadioButtonsGroup id="txtIndExpJudiAdjudicadoAgregar" class="radio" asp-label="Expediente Judicial Adjudicado" name="IndExpJudiAdjudicado" asp-validate="true">
                        <RadioButtonItem class="btn btn-outline-info" data-type="boolean" data-nullable="true" value="true" label="Banco" />
                        <RadioButtonItem class="btn btn-outline-info" data-type="boolean" data-nullable="true" value="false" label="Tercero" />
                    </RadioButtonsGroup>
                </div>
                <div class="col-md-4 col-sm-12 mb-2">
                    @*<input id="txtFecFirmezaRemateAgregar" type="date" class="form-control" asp-label="Fecha Firmeza Remate"
                        name="FecFirmezaRemate" asp-datepicker="true" asp-datepicker-format="DD/MM/YYYY" asp-validate="true" />*@
                    <input id="txtFecFirmezaRemateAgregar" type="date" class="form-control" asp-label="Fecha Firmeza Remate"
                           name="FecFirmezaRemate" asp-datepicker="true" asp-datepicker-format="DD/MM/YYYY" asp-validate="true" />
                </div>
                <div class="col-md-4 col-sm-12 mb-2">
                    <input id="txtMontoAdjudicacionAgregar" class="form-control" asp-label="Monto Adjudicación" name="MontoAdjudicacion" data-type="integer"
                           asp-decimal-digits="2" value="" asp-validate="true" />
                </div>
                <div class="col-md-4 col-sm-12 mb-2">
                    <select id="cboEncargadoProtocolizacionAgregar" class="selectpicker show-tick" title="Seleccione una opción..." asp-label="Encargado de Protocolizaciones"
                            select-items="@Model.LstEncargadoProtocolizacion" select-item-value="IdUsuario" select-item-name="NombreCompleto"
                            name="IdEncargadoProtocolizacion" data-width="100%" data-style="border" data-live-search="true"></select>
                </div>
                <div class="col-md-4 col-sm-12 mb-2">
                    <select id="cboEncargadoPuestaPosesionAgregar" class="selectpicker show-tick" title="Seleccione una opción..." asp-label="Encargado Puesta Posesión"
                            select-items="@Model.LstEncargadoPuestaPosesion" select-item-value="IdUsuario" select-item-name="NombreCompleto"
                            name="IdEncargadoPuestaPosesion" data-width="100%" data-style="border" data-live-search="true"></select>
                </div>
                <div class="col-md-4 col-sm-12 mb-2">
                    <RadioButtonsGroup id="txtIndRemateFirmeAgregar" class="radio" asp-label="Firmeza de Remate" name="IndRemateFirme" asp-validate="true">
                        <RadioButtonItem class="btn btn-outline-info" data-type="boolean" data-nullable="true" value="true" label="Si" />
                        <RadioButtonItem class="btn btn-outline-info" data-type="boolean" data-nullable="true" value="false" label="No" />
                    </RadioButtonsGroup>
                </div>
            </div>
        </div>

        <progress-bar-container class="progressbar-container progressresultadoremate" progress-bar-height="25px">
            <progress-bar class="bg-bp-primary" progress-bar-text="Cargando Información..." progress-bar-valuenow="100" />
        </progress-bar-container>
    </modal-body>
    <modal-footer>
        <btn-cerrar id="btnCerrar" data-dismiss="modal" />
        <btn-guardar-registro id="btnGuardarResultadosRemate" />
    </modal-footer>
</modal>

<modal id="InstruccionesRemateAgregarModal" modal-size="xl">
    <modal-header class="bg-bp-primary text-white">
        <modal-title id="exampleModalLabel">Agregar Instrucciones Remate</modal-title>
    </modal-header>
    <modal-body>
        <div class="container-fluid" id="InstruccionesRemateModel">
            <div class="row">
                <div class="col-md-4 col-sm-12 mb-2">
                    <input type="hidden" id="hidExpedienteJudicialInstruccionesRemate" name="IdExpedienteJudicial" value="" />
                    <input type="hidden" id="hTramiteCobroInstruccionesRemate" name="TramiteCobro" value="" />
                    <input type="hidden" id="hNumOperacionInstruccionesRemate" name="NumOperacion" value="" />

                    <RadioButtonsGroup id="txtIndInteresPrescritosAgregar" class="radio" asp-label="Interés Prescritos" name="IndInteresPrescritos" asp-validate="true">
                        <RadioButtonItem class="btn btn-outline-info" data-type="boolean" data-nullable="true" value="true" label="Si" />
                        <RadioButtonItem class="btn btn-outline-info" data-type="boolean" data-nullable="true" value="false" label="No" />
                    </RadioButtonsGroup>
                </div>
                <div class="col-md-4 col-sm-12 mb-2" id="myDivFechaDesdeAgregar">
                    <input id="txtFechaDesdeAgregar" type="date" class="form-control" asp-label="Fecha Desde"
                           name="FechaDesde" asp-datepicker="true" asp-datepicker-format="DD/MM/YYYY" asp-validate="true" />
                </div>
                <div class="col-md-4 col-sm-12 mb-2" id="myDivFechaHastaAgregar">
                    <input id="txtFechaHastaAgregar" type="date" class="form-control" asp-label="Fecha Hasta"
                           name="FechaHasta" asp-datepicker="true" asp-datepicker-format="DD/MM/YYYY" asp-validate="true" />
                </div>
                <div class="col-md-4 col-sm-12 mb-2">
                    <input id="txtFechaAdjudicarAgregar" type="date" class="form-control" asp-label="Fecha Adjudicar"
                           name="FechaAdjudicar" asp-datepicker="true" asp-datepicker-format="DD/MM/YYYY" asp-validate="true" />
                </div>
                @*<div class="col-md-4 col-sm-12 mb-2">
                        <select id="txtIdIndicacionPeritoAgregar" class="selectpicker show-tick" title="Seleccione una opción..." asp-label="Indicación Perito"
                                select-items="@ViewBag.IndicacionPerito" select-item-value="IdIndicacionPerito" select-item-name="Descripcion"
                                name="IdIndicacionPerito" data-width="100%" data-style="border" data-live-search="true"></select>
                    </div>*@

                <div class="col-md-4 col-sm-12 mb-2">
                    <select id="txtIdIndicacionPeritoAgregar" class="selectpicker show-tick" title="Seleccione una opción..." asp-label="Indicación Perito"
                            name="IdIndicacionPerito" data-type="integer" select-items="@ViewBag.IndicacionPerito" select-item-value="IdIndicacionPerito"
                            select-item-name="Descripcion" select-selected-value="IdIndicacionPerito"
                            data-width="100%" data-style="border" asp-validate="true"></select>
                </div>

                <div class="col-md-4 col-sm-12 mb-2">
                    <input id="txtNumOficioAgregar" class="form-control" asp-label="Número de Oficio" name="NumOficio"
                           maxlength="100" asp-validate="true" data-set-focus />
                </div>
                <div class="col-md-4 col-sm-12 mb-2">
                    <input id="txtFecRemateAgregar" type="date" class="form-control" asp-label="Fecha Remate"
                           name="FecRemate" asp-datepicker="true" asp-datepicker-format="DD/MM/YYYY" asp-validate="true" />
                </div>
                <div class="col-md-4 col-sm-12 mb-2">
                    <input id="txtHoraRemateAgregar" type="time" class="form-control" asp-label="Hora Remate"
                           name="HoraRemate" asp-datepicker="true" asp-datepicker-format="0:hh\\:mm\\:ss" asp-validate="true" />
                </div>
                <div class="col-md-4 col-sm-12 mb-2">
                    <input id="txtBaseRemateAgregar" class="form-control" asp-label="Monto Base Remate" name="BaseRemate" data-type="integer"
                           asp-decimal-digits="2" value="" asp-validate="true" />
                </div>
                <div class="col-md-4 col-sm-12 mb-2">
                    <input id="txtNumGarantiaAgregar" class="form-control" asp-label="Número de Garantía" name="NumGarantia"
                           maxlength="250" asp-validate="true" data-set-focus />
                </div>
                <div class="col-md-4 col-sm-12 mb-2">
                    <input id="txtFecUltAvaluoAgregar" type="date" class="form-control" asp-label="Fecha Último Avalúo"
                           name="FecUltAvaluo" asp-datepicker="true" asp-datepicker-format="DD/MM/YYYY" asp-validate="true" />
                </div>
                <div class="col-md-4 col-sm-12 mb-2">
                    <input id="txtMontoAvaluoAgregar" class="form-control" asp-label="Monto Avalúo" name="MontoAvaluo" data-type="integer"
                           asp-decimal-digits="2" value="" asp-validate="true" />
                    <input type="hidden" id="txtMontoAvaluo80PorcientoAgregar" name="MontoAvaluo80Porciento" value="" />
                </div>

                <div class="col-md-4 col-sm-12 mb-2">
                    <input id="txtMontoLiquidacionAgregar" class="form-control" asp-label="Monto Liquidación" name="MontoLiquidacion" data-type="integer"
                           asp-decimal-digits="2" value="" asp-validate="true" />
                </div>
                <div class="col-md-4 col-sm-12 mb-2">
                    <RadioButtonsGroup id="txtChequeGerenciaAgregar" class="radio" asp-label="Cheque Gerencia" name="ChequeGerencia" asp-validate="true">
                        <RadioButtonItem class="btn btn-outline-info" data-type="boolean" data-nullable="true" value="true" label="Si" />
                        <RadioButtonItem class="btn btn-outline-info" data-type="boolean" data-nullable="true" value="false" label="No" />
                    </RadioButtonsGroup>
                </div>
                <div class="col-md-4 col-sm-12 mb-2">
                    <input id="txtFirmaGestorCobroAgregar" class="form-control" asp-label="Firma Gestor Cobro" name="FirmaGestorCobro"
                           maxlength="100" asp-validate="true" data-set-focus />
                </div>
                <div class="col-md-4 col-sm-12 mb-2">
                    <input id="txtFirmaAreaCobroAgregar" class="form-control" asp-label="Firma Área Cobro" name="FirmaAreaCobro"
                           maxlength="100" asp-validate="true" data-set-focus />
                </div>

            </div>

        </div>

        <progress-bar-container class="progressbar-container progressinstruccionesremate" progress-bar-height="25px">
            <progress-bar class="bg-bp-primary" progress-bar-text="Cargando Información..." progress-bar-valuenow="100" />
        </progress-bar-container>
    </modal-body>
    <modal-footer>
        <btn-cerrar id="btnCerrar" data-dismiss="modal" />
        <btn-guardar-registro id="btnGuardarInstruccionesRemate" />
    </modal-footer>
</modal>

<modal id="val-expediente-modal" modal-size="xl">
    <modal-header class="bg-bp-primary text-white">
        <modal-title>Validación Expediente Judicial</modal-title>
    </modal-header>
    <modal-body>
        <div id="contenedor-guardar" class="info-container">
        </div>
        <progress-bar-container class="progressbar-container" progress-bar-height="25px">
            <progress-bar class="bg-bp-primary" progress-bar-text="Cargando Información..." progress-bar-valuenow="100" />
        </progress-bar-container>
    </modal-body>
    @*<modal-footer>
            <btn-cerrar id="btnCerrar" data-dismiss="modal" />
            <btn-guardar-registro id="btnGuardarParte" />
        </modal-footer>*@
</modal>

<modal id="adj-instruccionremate-modal" modal-size="xl">
    <modal-header class="bg-bp-primary text-white">
        <modal-title>Adjuntar Instrucción de Remate Firmada</modal-title>
    </modal-header>
    <modal-body>
        <div id="contenedor-guardar" class="info-container">
        </div>
        <progress-bar-container class="progressbar-container" progress-bar-height="25px">
            <progress-bar class="bg-bp-primary" progress-bar-text="Cargando Información..." progress-bar-valuenow="100" />
        </progress-bar-container>
    </modal-body>
</modal>

<modal id="ValidarDocuEtapa1" modal-size="xl">
    <modal-header class="bg-bp-primary text-white">
        <modal-title>Validación de la documentación de pase a etapa 1</modal-title>
    </modal-header>
    <modal-body>
        <div id="validar-documentacion-container" class="info-container">
        </div>
        <progress-bar-container class="progressbar-container" progress-bar-height="25px">
            <progress-bar class="bg-bp-primary" progress-bar-text="Cargando Información..." progress-bar-valuenow="100" />
        </progress-bar-container>
    </modal-body>
    <modal-footer>
        <btn-cerrar id="btnCerrar" data-dismiss="modal" />
    </modal-footer>
</modal>

<modal id="ValidarDocuEtapa2" modal-size="xl">
    <modal-header class="bg-bp-primary text-white">
        <modal-title>Validación de la documentación de pase a etapa 2</modal-title>
    </modal-header>
    <modal-body>
        <div id="validar-documentacion-container-etapa2" class="info-container">
        </div>
        <progress-bar-container class="progressbar-container" progress-bar-height="25px">
            <progress-bar class="bg-bp-primary" progress-bar-text="Cargando Información..." progress-bar-valuenow="100" />
        </progress-bar-container>
    </modal-body>
    <modal-footer>
        <btn-cerrar id="btnCerrar" data-dismiss="modal" />
    </modal-footer>
</modal>

<modal id="calculo-liquidacion-modal" modal-size="xl">
    <modal-header class="bg-bp-primary text-white">
        <modal-title>Calculo Liquidación Judicial</modal-title>
    </modal-header>
    <modal-body>
        <div id="contenedor-guardar" class="info-container">
        </div>
        <progress-bar-container class="progressbar-container" progress-bar-height="25px">
            <progress-bar class="bg-bp-primary" progress-bar-text="Cargando Información..." progress-bar-valuenow="100" />
        </progress-bar-container>
    </modal-body>
</modal>

<modal id="exp-garantia-detreg-modal" modal-size="xl">
    <modal-header class="bg-bp-primary text-white">
        <modal-title id="tituloModal"></modal-title>
    </modal-header>
    <modal-body>
        <div id="egContenedorGuardar" class="info-container">
        </div>
        <progress-bar-container class="progressbar-container" progress-bar-height="25px">
            <progress-bar class="bg-bp-primary" progress-bar-text="Cargando Información..." progress-bar-valuenow="100" />
        </progress-bar-container>
    </modal-body>
    <modal-footer>
        <btn-cerrar id="btnCerrar" data-dismiss="modal" />
        <btn-guardar-registro id="btnGuardarExpGarantia" />
    </modal-footer>
</modal>

<modal id="val-asg-cod-abog-modal" modal-size="xl">
    <modal-header class="bg-bp-primary text-white">
        <modal-title>Validación Asignación de Abogado</modal-title>
    </modal-header>
    <modal-body>
        <div id="contenedor-guardar" class="info-container">
        </div>
        <progress-bar-container class="progressbar-container" progress-bar-height="25px">
            <progress-bar class="bg-bp-primary" progress-bar-text="Cargando Información..." progress-bar-valuenow="100" />
        </progress-bar-container>
    </modal-body>
</modal>

<modal id="caratula-bienes-adj-modal" modal-size="xl">
    <modal-header class="bg-bp-primary text-white">
        <modal-title>Carátula Bienes Adjudicados</modal-title>
    </modal-header>
    <modal-body>
        <div id="contenedor-guardar" class="info-container">
        </div>
        <progress-bar-container class="progressbar-container" progress-bar-height="25px">
            <progress-bar class="bg-bp-primary" progress-bar-text="Cargando Información..." progress-bar-valuenow="100" />
        </progress-bar-container>
    </modal-body>
</modal>



<script type="text/javascript" defer>

    $(document).ready(function () {

        $('#myDivFechaDesdeAgregar').hide();
        $('#myDivFechaHastaAgregar').hide();

        //Eliminar duplicidad de required de RadioButtonsGroup
        $("#ResultadosRemateModel").find("small[for='IndExpJudiAdjudicado']")[0].remove();
        $("#InstruccionesRemateModel").find("small[for='IndInteresPrescritos']")[0].remove();

        //Ocultar fechas si no tiene interes prescritos
        habilitarCamposInteresPrescritosDiv();

        $.ajax({
                url: "@Url.Action("ObtenerExpedientesXTramite", "TramiteDetalle")",
                type: "GET",
                data: { pTramite: @Model.IdTramiteJudicial},
                traditional: true,
                success: function (result) {
                    $.each(result, function (i, item) {
                        window["AgregarExpediente" + i] = new ExpedienteProvinciaCantonDistrito("#contenedorProCanDis-" + item.IdExpedienteJudicial, item.IdExpedienteJudicial);
                        window["CalcularMesesUltGestion" + i] = new MesesUltimaGestion("#contenedorUltimaGestion-" + item.IdExpedienteJudicial);
                        window["CalcularCuantia" + i] = new Cuantia("#cuantiaGrp-" + item.IdExpedienteJudicial, item.IdExpedienteJudicial);
                        window["CodigosGestionExpediente" + i] = new CodigosGestionExpediente("#contenedorCodigosGR-" + item.IdExpedienteJudicial, item.IdExpedienteJudicial);
                        //window["ResultadosRemate" + i] = new ResultadosRemates("#contenedorResultadosRemate-" + item.IdExpedienteJudicial, item.IdExpedienteJudicial, item.IdTramiteCobroJudicial, item.NumOperacion);
                        window["AdjuntarRemateInstruccion" + i] = new AdjuntarRemateInstrucciones("#contenedorAdjuntarRemateInstruccion-" + item.IdExpedienteJudicial, item.IdExpedienteJudicial, item.IdTramiteCobroJudicial, item.NumOperacion);
                        window["ExpedienteGarantia" + i] = new ExpedienteGarantia("#contenedorExpedienteGarantia-" + item.IdExpedienteJudicial, item.IdExpedienteJudicial, item.NumOperacion);
                    });
                },
                error: function () {
                    alert("No fue posible cargar los expedientes");
                }
            });

        $(".selectpicker").selectpicker();

        $("#btnCrearExpediente").on("click", abrirAgregarTabExpediente);

        $("#ddlProvinciasAgregar").on("change", obtenerCantones);
        $("#ddlCantonesAgregar").on("change", obtenerDistritos);
        $("#ddlDistritosAgregar").on("change", obtenerDespachoDomicilio);

        $("#btnGuardarExpediente").on("click", guardarEJ);
        $("#btnCrearExpedienteExistente").on("click", guardarExpedienteExistente);

        $("#btnExpedienteExistente").on("click", function () {
            $("#ExpedienteExistenteAgregarModal").modal("show");
        });

        $("#RemateAgregarModal").on("hidden.bs.modal", function () {
            $("#txtFechaRemateAgregar").val('');
            $("#txtMontoBaseAgregar").val('');
            $("#estadoRemateAgregar").val('');
        });

        $("#txtFechaUltimaGestionAgregar").on('change', calcularMeses);
        $(".btnActualizarExpediente").on('click', actualizarExpedientes);

        $(".btnAgregarRemate").on("click", agregarRemate);
        $("#btnGuardarRemate").on("click", guardarRemate);

        $(".btnActualizarRemates").on("click", actualizarRemates);

        $("#txtTasaLiquidacionAgregar").on('change', calcularCuantia);
        $("#txtFechaDemandaAgregar").on('change', calcularCuantia);


        $(document).find("#CodigosAgregarModal").on("click", ".btn-guardar-codigo-gestion-resol", agregarCodigo);
        $(document).on("click", ".btn-agregar-codigo-gestion-resol", abrirCodigosAgregarModal);

        $(document).on('click', "#btnAdjDemanda", adjuntarArchivoDemanda);

        $(".btnAgregarFechaRematePuestaPosesion").on("click", agregarFechaRematePuestaPosesion);
        $("#btnGuardarFechaRematePuestaPosesion").on("click", guardarFechaRematePuestaPosesion);
        $("#btnActualizarFechaRematePuestaPosesion").on("click", actualizarFechaRematePuestaPosesion);
        $("#txtMontoRemateBase1Agregar").on("change", calcularMontosBase);

        var Id = $("#txtIdFechaRematePuestaPosesion").val();
        $("#txtMontoRemateBase1" + Id).on("change", calcularMontosBaseEditar);

        $(".btnAgregarCalcLiquidacion1").on("click", agregarCalcLiquidacion);
        $(".btnAgregarCalcLiquidacion2").on("click", agregarCalcLiquidacion);
        $(".btnAgregarCalcLiquidacion3").on("click", agregarCalcLiquidacion);

        $("#FechaRematePuestaPosesionAgregarModal").on("hidden.bs.modal", function () {
            $("#txtFechaRemate1Agregar").val('');
            $("#txtFechaRemate2Agregar").val('');
            $("#txtFechaRemate3Agregar").val('');
            $("#txtHoraRemate1Agregar").val('');
            $("#txtHoraRemate2Agregar").val('');
            $("#txtHoraRemate3Agregar").val('');
            $("#txtMontoRemateBase1Agregar").val('');
            $("#txtMontoRemateBase2Agregar").val('');
            $("#txtMontoRemateBase3Agregar").val('');
            $("#txtSaldoDecretadoJudicialAgregar").val('');
            $("#txtFechaProtocolizacionAgregar").val('');
            $("#txtFechaPuestaPosesionAgregar").val('');
        });

        $("#txtMontoRemateBase1Agregar").on("change", calcularMontosBase);
        var Id = $("#txtIdFechaRematePuestaPosesion").val();
        $("#txtMontoRemateBase1" + Id).on("change", calcularMontosBaseEditar);;

        $("#btnAgregarResultadosRemate").on("click", agregarResultadosRemate);
        $("#btnGuardarResultadosRemate").on("click", guardarResultadosRemate);
        $("#btnActualizarResultadosRemate").on("click", actualizarResultadosRemate);

        //$(document).on("click", ".btnAgregarResultadosRemate", agregarResultadosRemate);
        //$(document).on("click", "#btnGuardarResultadosRemate", guardarResultadosRemate);
        $("#ResultadosRemateAgregarModal").on("hidden.bs.modal", function () {

            $("#hIdResultadosRemate").val('');
            $("#hIdExpedienteJudicialResultadosRemate").val('');
            $("#hTramiteCobroResultadosRemate").val('');
            $("#hNumOperacionResultadosRemate").val('');
            $("#hIdFechaRematePuestaPosesionResultadosRemate").val('');

            //$("#txtIndExpJudiAdjudicadoAgregar").val('');
            $("#txtFecFirmezaRemateAgregar").val('');
            $("#txtMontoAdjudicacionAgregar").val('');
            //$("#cboEncargadoProtocolizacionAgregar").val('');
            //$("#cboEncargadoPuestaPosesionAgregar").val('');
            //$("#txtIndRemateFirmeAgregar").val('');

            var EncargadoProtocolizacionAgregar = $("#cboEncargadoProtocolizacionAgregar");
            $(EncargadoProtocolizacionAgregar).val("");
            $(EncargadoProtocolizacionAgregar).selectpicker("render");

            var EncargadoPuestaPosesionAgregar = $("#cboEncargadoPuestaPosesionAgregar");
            $(EncargadoPuestaPosesionAgregar).val("");
            $(EncargadoPuestaPosesionAgregar).selectpicker("render");

            var $containerCerrar = $("#ResultadosRemateModel");
            $containerCerrar.find("small[for='IndExpJudiAdjudicado']").text("");

            $('input[name=IndExpJudiAdjudicado]').attr('checked', false);
            $('input[name=IndRemateFirme]').attr('checked', false);

            /*$('.btn btn-outline-info').parent().parent().removeClass('active');*/

            var elements2 = document.getElementsByClassName('btn btn-outline-info');
            console.log(elements2);

            var elements = document.getElementsByClassName('btn btn-outline-info active');
            console.log(elements);
            while (elements.length > 0) {
                elements[0].classList.remove('active');
            }

        });

        $(document).on('click', "#btnCaratulaBienesAdj", mostrarCaratulaBienesAdj);
        $("#btnAgregarInstruccionesRemate").on("click", agregarInstruccionesRemate);
        $("#btnGuardarInstruccionesRemate").on("click", guardarInstruccionesRemate);
        $("#btnActualizarInstruccionesRemate").on("click", actualizarInstruccionesRemate);
        $("#txtMontoAvaluoAgregar").on("change", calcularMontoAvaluoPorcentual);
        $("#txtIndInteresPrescritosAgregar").on("change", habilitarCamposInteresPrescritos);
        $("#txtIndInteresPrescritosDiv").on("change", habilitarCamposInteresPrescritosDiv);

        //function resetRadioButtons(groupName) {

        //    var arRadioBtn = document.getElementsByName(groupName);

        //    for (var ii = 0; ii < arRadioBtn.length; ii++) {
        //        var radButton = arRadioBtn[ii];
        //        radButton.checked = false;
        //    }
        //}

        $("#InstruccionesRemateAgregarModal").on("hidden.bs.modal", function () {
            $("#txtFechaDesdeAgregar").val('');
            $("#txtFechaHastaAgregar").val('');
            $("#txtFechaAdjudicarAgregar").val('');
            $("#txtNumOficioAgregar").val('');
            $("#txtFecRemateAgregar").val('');
            $("#txtHoraRemateAgregar").val('');
            $("#txtBaseRemateAgregar").val('');
            $("#txtNumGarantiaAgregar").val('');
            $("#txtFecUltAvaluoAgregar").val('');
            $("#txtMontoAvaluoAgregar").val('');
            $("#txtMontoAvaluo80PorcientoAgregar").val('');
            $("#txtMontoLiquidacionAgregar").val('');
            $("#txtFirmaGestorCobroAgregar").val('');
            $("#txtFirmaAreaCobroAgregar").val('');

            var IndicacionPeritoAgregar = $("#txtIdIndicacionPeritoAgregar");
            $(IndicacionPeritoAgregar).val("");
            $(IndicacionPeritoAgregar).selectpicker("render");

            $('input[name=IndInteresPrescritos]').attr('checked', false);
            $('input[name=ChequeGerencia]').attr('checked', false);

            /*$('.btn btn-outline-info').parent().parent().removeClass('active');*/

            var elements2 = document.getElementsByClassName('btn btn-outline-info');
            console.log(elements2);

            var elements = document.getElementsByClassName('btn btn-outline-info active');
            console.log(elements);
            while (elements.length > 0) {
                elements[0].classList.remove('active');
            }

        });

        $(document).on('click', "#btnValidarExp", validarExpediente);

        $(document).on('click', "#btnValAsgCodExp", validarAsgCodAbogado);

        $(document).on('click', "#btnAdjInstruccionRemate", adjuntarInstruccionRemateFirmada);


        $(document).on("click", ".btnGenerarIstRemate", generarInstruccionesRemate);

        /***************Inicio Expediente Garantia********************************/

        $(document).on("click", "#btnAgregarExpGarantia", agregarExpGarantiaModal);

        $(document).on("click", "#btnGuardarExpGarantia", guardarExpGarantia);

        /***************Fin Expediente Garantia********************************/



        /***************Calculadora******************/
        //Add ReadOnly
        //$("#txtFechaUltimoPagoCalculadora").attr("readonly", true);

        //Habilitar-Ocultar Campos
        //$("#cboIdTipoCalculadora").on("change", HabilitarOcultarCampos);
        //HabilitarOcultarCampos();


        //Ocultar Campos
        /*$('#myDivTasaInteresMora').hide();
        $('#myDivFechaCorteInteresMora').hide();
        $('#myDivFechaLiquidacionDemanda').hide();
        $('#myDivDiasInteresMora').hide();
        $('#myDivMontoInteresMora').hide();
        $('#myDivMontoHonorariosLiquidacion').hide();
        $('#myDivMontoTotalInteres').hide();
        $('#myDivDiasInteresDiferenciaCorrienteMora').hide();*/

        $('.CalcularDiasInteresCorriente').change();
        $('.CalcularDiasInteresMoraDemanda').change();

        //$('#txtFechaUltimoPagoCalculadora').attr("readonly", true);
        /***************Fin Calculadora**************/       

    });

    function agregarCodigo() {
        $container = $("#ExpedienteCodigoGRAgregarModel");
        let modelo = $("#ExpedienteCodigoGRAgregarModel").getModel();

        $.ajax({
            type: "POST",
            contentType: 'application/json; charset=utf-8',
            url: "@Url.Action("AgregarCodigosGRExpediente", "TramiteDetalle")",
            data: JSON.stringify(modelo),
            success: function (mensaje) {
                const idExpediente = $("#CodigosAgregarModal").find("input[name='IdExpediente']").val();
                $("#CodigosAgregarModal").modal('hide');
                Alerta('Guardar Registro Código Gestión y Resolución', mensaje, 'success');

                window["CodigosGestionAgregarGridModel" + idExpediente].Refresh({ IdExpediente: idExpediente });
                $("body").trigger("actualizarComponents");
            },
            error: function (jqXHR, textStatus, errorThrown) {
                $container.find("small[for]").text("");
                if (jqXHR.status == 409) {
                    var errors = jqXHR.responseJSON;
                    if (Array.isArray(errors)) {
                        for (var i = 0; i < errors.length; i++) {
                            var reg = errors[i];
                            if (reg.PropertyName !== undefined && reg.Message !== undefined) {
                                var $element = $container.find("small[for='" + reg.PropertyName + "']");

                                if ($element !== undefined) {
                                    $element.text(reg.Message);
                                }
                            }
                        }
                    }
                }
                else {
                    Alerta('Guardar Registro Código', jqXHR.responseText, 'danger');
                }
            }
        });
    }

    function abrirCodigosAgregarModal() {
        const idExpediente = $(this).data("id");

        $("#CodigosAgregarModal").find(".info-container").html('');
        $("#CodigosAgregarModal").find(".progressbar-container").show();

        $("#CodigosAgregarModal").modal("show");

		var link = '@Url.Action("InitCodigosGRExpediente", "TramiteDetalle")';

        $("#CodigosAgregarModal").find(".info-container").load(link, function () {

            $("#CodigosAgregarModal").find("input[name='IdExpediente']").val(idExpediente).end().modal('show');

            $("#CodigosAgregarModal").find(".progressbar-container").hide();
            $("#CodigosAgregarModal").find(".selectpicker").selectpicker('render');
            $("#CodigosAgregarModal").customdatepicker();
            $("#CodigosAgregarModal").custominputs("refresh");
            $("#CodigosAgregarModal").find("[data-set-focus]").focus();
		});
    }

    function CodigosGestionExpediente(p_Id, p_IdExpediente) {

        CodigosGestionExpediente.prototype.Init = function () {
            ConsultarRegistro(p_Id, p_IdExpediente);
        }

        this.Init();
    }

    function agregarCodigoResultadosRemate() {
        $container = $("#ExpedienteCodigoGRAgregarModel");
        let modelo = $("#ExpedienteCodigoGRAgregarModel").getModel();

        $.ajax({
            type: "POST",
            contentType: 'application/json; charset=utf-8',
            url: "@Url.Action("AgregarCodigosGRExpediente", "TramiteDetalle")",
            data: JSON.stringify(modelo),
            success: function (mensaje) {
                const idExpediente = $("#CodigosAgregarModal").find("input[name='IdExpediente']").val();
                $("#CodigosAgregarModal").modal('hide');
                Alerta('Guardar Registro Código Gestión y Resolución', mensaje, 'success');

                window["CodigosGestionAgregarGridModel" + idExpediente].Refresh({ IdExpediente: idExpediente });
            },
            error: function (jqXHR, textStatus, errorThrown) {
                $container.find("small[for]").text("");
                if (jqXHR.status == 409) {
                    var errors = jqXHR.responseJSON;
                    if (Array.isArray(errors)) {
                        for (var i = 0; i < errors.length; i++) {
                            var reg = errors[i];
                            if (reg.PropertyName !== undefined && reg.Message !== undefined) {
                                var $element = $container.find("small[for='" + reg.PropertyName + "']");

                                if ($element !== undefined) {
                                    $element.text(reg.Message);
                                }
                            }
                        }
                    }
                }
                else {
                    Alerta('Guardar Registro Código', jqXHR.responseText, 'danger');
                }
            }
        });
    }

    function abrirResultadosRemateAgregarModal() {
        const idExpediente = $(this).data("id");

        $("#CodigosAgregarModal").find(".info-container").html('');
        $("#CodigosAgregarModal").find(".progressbar-container").show();

        $("#CodigosAgregarModal").modal("show");

		var link = '@Url.Action("InitCodigosGRExpediente", "TramiteDetalle")';

        $("#CodigosAgregarModal").find(".info-container").load(link, function () {

            $("#CodigosAgregarModal").find("input[name='IdExpediente']").val(idExpediente).end().modal('show');

            $("#CodigosAgregarModal").find(".progressbar-container").hide();
            $("#CodigosAgregarModal").find(".selectpicker").selectpicker('render');
            $("#CodigosAgregarModal").customdatepicker();
            $("#CodigosAgregarModal").custominputs("refresh");
            $("#CodigosAgregarModal").find("[data-set-focus]").focus();
		});
    }

    function AdjuntarRemateInstrucciones(p_Id, p_IdExpediente, p_IdTramiteCobroJudicial, p_NumOperacion) {

        AdjuntarRemateInstrucciones.prototype.Init = function () {
            ConsultarAdjuntarRemateInstruccion(p_Id, p_IdExpediente, p_IdTramiteCobroJudicial, p_NumOperacion);
        }

        this.Init();
    }

    function Cuantia(p_Id, p_IdExpediente) {

        var tasaObj = $(p_Id).find("input[name='expedienteRegistrado.TasaLiquidacion']");
        var fechademandaObj = $(p_Id).find("input[name='expedienteRegistrado.FechaPresentacionDemanda']");
        var montoObj = $(p_Id).parent().parent().find("input[name='monto.PorcentajeSaldo']");

        var me = this;

        Cuantia.prototype.Init = function () {
            $(fechademandaObj).on("change", { pp: me }, function (event) {
                event.data.pp.CalculoCuantia(p_IdExpediente);
            });

            $(tasaObj).on("change", { pp: me }, function (event) {
                event.data.pp.CalculoCuantia(p_IdExpediente);
            });

            $(montoObj).on("change", { pp: me }, function (event) {
                event.data.pp.CalculoCuantia(p_IdExpediente);
            });
        }

        Cuantia.prototype.CalculoCuantia = function (idExpediente) {
            $.ajax({
                url: "@Url.Action("ObtenerMontos", "TramiteDetalle")",
                type: "GET",
                contentType: 'application/json; charset=utf-8',
                data: { idExpediente: idExpediente },
                success: function (result) {
                    var total = 0;

                    var fechademanda = moment($("#txtFechaDemanda-" + idExpediente).val(), 'DD/MM/YYYY');
                    var tasaLiqui = $("#txtTasaLiquidacion-" + idExpediente).val();

                    $.each(result, function (i, item) {
                        var modelo = $("#MontoModel-" + item.Id).getModel();

                        modelo.FechaPresentacionDemanda = (fechademanda.isValid()) ? fechademanda.format('YYYY/MM/DD') : null;
                        modelo.TasaLiquidacion = tasaLiqui;

                        var link = "@Url.Action("CalculoCuantia", "TramiteDetalle")";

                        $.ajax({
                            url: link,
                            type: "POST",
                            contentType: 'application/json; charset=utf-8',
                            data: JSON.stringify(modelo),
                            success: function (result) {

                                var { Cuantia, MontoBase, MontoAsignado } = result;

                                if (Cuantia) {
                                    $("#txtCuantiaMonto" + item.Id).val(Cuantia.toFixed(2));
                                    total += parseFloat(Cuantia.toFixed(2));
                                }

                                $("#txtMontoBase" + item.Id).val(MontoBase.toFixed(2));
                                $("#txtMontoAsignado" + item.Id).val(MontoAsignado.toFixed(2));
                            },
                            complete: function () {
                                if (total != 0) $("#txtCuantia-" + idExpediente).val(total.toFixed(2));
                            },
                            error: function () {
                                mostrarMensaje("Ocurrió un error", false);
                            }
                        });
                    });
                },
                error: function () {
                    mostrarMensaje("Ocurrió un error", false);
                }
            });
        }

        this.Init();
    }

    function MesesUltimaGestion(p_Id) {
        var fechaUltimaGestionObj = $(p_Id).find("input[name='FechaUltimaGestion']");
        var mesesUltimaGestionObj = $(p_Id).find("input[name='MesesUltimaGestion']");
        var me = this;

        MesesUltimaGestion.prototype.Init = function () {
            $(fechaUltimaGestionObj).on("change", { pp: me }, function (event) {
                var fechaActual = moment(new Date(), 'DD/MM/YYYY'),
                    fechaUltimaGestion = moment($(fechaUltimaGestionObj).val(), 'DD/MM/YYYY');

                var resultado = moment.duration(fechaActual.diff(fechaUltimaGestion)).asDays();

                if (isNaN(Math.round(resultado / 31))) {
                    $(mesesUltimaGestionObj).val('');
                } else {
                    $(mesesUltimaGestionObj).val(Math.round(resultado / 31));
                }
            });
        }

        this.Init();



    }

    function ExpedienteProvinciaCantonDistrito(p_Id, p_IdExpediente, p_IdProvincia, p_IdCanton, p_IdDistrito, p_CircuitoJud, p_AutoridadJud) {

        var provinciaObj = $("#ddlProvincias" + p_IdExpediente);
        var cantonObj = $("#ddlCantones" + p_IdExpediente);
        var distritoObj = $("#ddlDistritos" + p_IdExpediente);
        var circuitoObj = $(p_Id).find("select[name='CircuitoJudicial']");
        var autoridadObj = $(p_Id).find("select[name='AutoridadJudicial']");
        var me = this;


        ExpedienteProvinciaCantonDistrito.prototype.Init = function () {

            if (p_IdProvincia != null) {
                $(provinciaObj).val(p_IdProvincia);
                $(provinciaObj).selectpicker("render");
            }

            this.UpdateCantones();

            if (p_IdCanton != null) {
                $(cantonObj).val(p_IdCanton);
                $(cantonObj).selectpicker("render");
            }

            this.UpdateDistritos();

            if (p_IdDistrito != null) {
                $(distritoObj).val(p_IdDistrito);
                $(distritoObj).selectpicker("render");
            }

            this.UpdateDespachos();

            if (p_CircuitoJud != null) {
                $(circuitoObj).val(p_CircuitoJud);
                $(circuitoObj).selectpicker("render");
            }
            if (p_AutoridadJud != null) {
                $(autoridadObj).val(p_AutoridadJud);
                $(autoridadObj).selectpicker("render");
            }

            $(provinciaObj).on("change", { pp: me }, function (event) {
                $(cantonObj).val("");
                $(distritoObj).val("");
                $(circuitoObj).val("");
                $(autoridadObj).val("");
                distritoObj.empty();

                $(cantonObj).selectpicker("render");
                $(distritoObj).selectpicker("render");
                $(circuitoObj).selectpicker("render");
                $(autoridadObj).selectpicker("render");

                $listaCantones = cantonObj;

                $listaCantones.empty();
                $.ajax({
                    url: "@Url.Action("ObtenerCantones", "DespachoJudicial")",
                    type: "GET",
                    data: { pCodProvincia: $(provinciaObj).val() },
                    traditional: true,
                    success: function (result) {
                        $.each(result, function (i, item) {
                            $listaCantones.append('<option value="' + item.CodCanton + '"> ' + item.Descripcion + ' </option>');
                        });

                        $(".selectpicker").selectpicker("refresh");
                    },
                    error: function () {
                        alert("No fue posible cargar los cantones");
                    }
                });

            });

            $(cantonObj).on("change", { pp: me }, function (event) {

                $(distritoObj).val("");
                $(circuitoObj).val("");
                $(autoridadObj).val("");

                $(distritoObj).selectpicker("render");
                $(circuitoObj).selectpicker("render");
                $(autoridadObj).selectpicker("render");

                $listaDistritos = distritoObj;
                $listaDistritos.empty();

                $.ajax({
                    url: "@Url.Action("ObtenerDistritos", "DespachoJudicial")",
                    type: "GET",
                    data: { pCodCanton: $(cantonObj).val(), pCodProvincia: $(provinciaObj).val() },
                    traditional: true,
                    success: function (result) {
                        $.each(result, function (i, item) {
                            $listaDistritos.append('<option value="' + item.CodDistrito + '"> ' + item.Descripcion + ' </option>');
                        });

                        $(".selectpicker").selectpicker("refresh");
                    },
                    error: function () {
                        alert("No fue posible cargar los distritos");
                    }
                });
            });

            $(distritoObj).on("change", { pp: me }, function (event) {
                $(circuitoObj).val("");
                $(autoridadObj).val("");

                $(circuitoObj).selectpicker("render");
                $(autoridadObj).selectpicker("render");

                $.ajax({
                    url: "@Url.Action("ObtenerDomicilio", "DespachoJudicial")",
                    type: "GET",
                    data: { pCanton: $(cantonObj).val(), pProvincia: $(provinciaObj).val(), pDistrito: $(distritoObj).val() },
                    traditional: true,
                    success: function (result) {
                        if (typeof (result) !== "undefined") {
                            $(circuitoObj).val(result.CodDespachoJudicial);
                            $(autoridadObj).val(result.CodDespachoJudicial);
                            $(circuitoObj).selectpicker("render");
                            $(autoridadObj).selectpicker("render");
                        }
                        else {
                            $(circuitoObj).val('');
                            $(autoridadObj).val('');
                            $(circuitoObj).selectpicker("render");
                            $(autoridadObj).selectpicker("render");
                        }
                    },
                    error: function () {
                        alert("No fue posible cargar los despachos");
                    }
                });

            });
        };

        ExpedienteProvinciaCantonDistrito.prototype.UpdateCantones = function () {
            var codProvincia = $(provinciaObj).val();
            $(cantonObj).find("option").each(function () {
                var provincia = $(this).attr("provincia");
                $(this).show();
                if (provincia === codProvincia) {
                }
                else {
                    $(this).removeAttr("selected");
                    $(this).hide();
                }
            });

            $(cantonObj).selectpicker("render");
            $(cantonObj).selectpicker("refresh");
        };

        ExpedienteProvinciaCantonDistrito.prototype.UpdateDistritos = function () {
            var codProvincia = $(provinciaObj).val();
            var codCanton = $(cantonObj).val();

            $(distritoObj).find("option").each(function () {
                var provincia = $(this).attr("provincia");
                var canton = $(this).attr("canton");
                $(this).show();
                if (provincia === codProvincia && canton === codCanton) {
                }
                else {
                    $(this).removeAttr("selected");
                    $(this).hide();
                }
            });
            $(distritoObj).selectpicker("refresh");
        };

        ExpedienteProvinciaCantonDistrito.prototype.UpdateDespachos = function () {
            var codProvincia = $(provinciaObj).val();
            var codCanton = $(cantonObj).val();
            var codDistrito = $(distritoObj).val();

            $.ajax({
                url: "@Url.Action("ObtenerDomicilio", "DespachoJudicial")",
                type: "GET",
                data: { pCanton: codCanton, pProvincia: codProvincia, pDistrito: codDistrito },
                traditional: true,
                success: function (result) {
                    if (typeof (result) !== "undefined") {
                        $(circuitoObj).val(result.CodDespachoJudicial);
                        $(autoridadObj).val(result.CodDespachoJudicial);
                        $(circuitoObj).selectpicker("render");
                        $(autoridadObj).selectpicker("render");
                    }
                    else {
                        $(circuitoObj).val('');
                        $(autoridadObj).val('');
                        $(circuitoObj).selectpicker("render");
                        $(autoridadObj).selectpicker("render");
                    }
                },
                error: function () {
                    alert("No fue posible cargar los despachos");
                }
            });

            $(circuitoObj).selectpicker("refresh");
            $(autoridadObj).selectpicker("refresh");
        };

        ExpedienteProvinciaCantonDistrito.prototype.Clear = function () {
            $(provinciaObj).selectpicker("val", "0");
            $(cantonObj).selectpicker("val", "0");
            $(distritoObj).selectpicker("val", "0");
        };

        this.Init();

    }

    function ConsultarRegistro(p_Id, pIdExpediente) {

		var link = '@Url.Action("DetalleCodigosGRExpediente", "TramiteDetalle", new { p_Id = "p_Codigo" })';
        link = link.replace("p_Codigo", pIdExpediente);

        $(p_Id).find("#info-container-" + pIdExpediente).load(link, function () { });
    }

    function ConsultarAdjuntarRemateInstruccion(p_Id, pIdExpediente, p_IdTramiteCobroJudicial, p_NumOperacion) {

		var link = '@Url.Action("DetalleAdjuntarRemateInstruccion", "TramiteDetalle",
                   new
                   {
                       p_Id = "p_Codigo",
                       p_IdTramiteCobroJudicial = "pIdTramiteCobroJudicial",
                       p_NumOperacion = "pNumOperacion"
                   })';
        link = link.replace("p_Codigo", pIdExpediente);
        link = link.replace("pIdTramiteCobroJudicial", p_IdTramiteCobroJudicial);
        link = link.replace("pNumOperacion", p_NumOperacion);
        link = link.replace("&amp;", "&");
        link = link.replace("&amp;", "&");

        $(p_Id).find("#info-container-" + pIdExpediente).load(link, function () { });
    }

    function abrirAgregarTabExpediente() {

        $(".tabsExpedienteCJ").each(function (e) {
            $(this).removeClass("active");
            $(this).removeClass("show");
        });

        $(".navTabsExpedienteCJ").each(function (e) {
            $(this).removeClass("active");
        });

        $("#tabExpedienteNuevo").removeClass("d-none");
        $("#nuevoExpediente").removeClass("d-none");

        $("#linkNuevoExpediente").addClass("active");

        $("#nuevoExpediente").addClass("show");
        $("#nuevoExpediente").addClass("active");

    }

    function calcularCuantia() {

        var tasa = $("#txtTasaLiquidacionAgregar").val();
        var fechademanda = moment($("#txtFechaDemandaAgregar").val(), 'DD/MM/YYYY');


            $.ajax({
                url: "@Url.Action("ObtenerOperacion", "TramiteDetalle")",
                type: "GET",
                contentType: 'application/json; charset=utf-8',
                data: { numOperacion: $("#txtNumOperacionCL").val() },
                success: function (result) {

                    var fechaUltimoPago = moment(result.FechaUltimoPago, 'DD/MM/YYYY');

                    if (fechademanda.isValid()) {
                        var dias = moment.duration(fechademanda.diff(fechaUltimoPago)).asDays();
                        var cuantia = result.MontoSaldo + (result.MontoSaldo * ((tasa / 100.00) /365) * dias);

                        if (isNaN(cuantia)) {
                            $("#txtCuantiaAgregar").val('');
                        } else {
                            $("#txtCuantiaAgregar").val(cuantia.toFixed(2));
                        }
                    }

                },
                error: function () {
                    mostrarMensaje("Ocurrió un error", false);
                }
            });
    }

    $(document).on('change', "[name='FechaPresentacionDemanda']", function (event) {
        $("[name='TasaLiquidacion']").change();
    })

    $(document).on('change', "[name='FechaLiquidacion']", function (event) {
        $("[name='TasaLiquidacion']").change();
    })

    $(document).on('propertychange change keyup paste input', "[name='TasaLiquidacion']", function(event) {

        var tasa = $(this).val();
        var idexpediente = $(this).data('idexpediente');
        var fechademanda = moment($("#txtFechaDemanda-" + idexpediente).val(), 'DD/MM/YYYY');

            $.ajax({
                url: "@Url.Action("ObtenerOperacion", "TramiteDetalle")",
                type: "GET",
                contentType: 'application/json; charset=utf-8',
                data: { numOperacion: $("#txtNumOperacionCL").val() },
                success: function (result) {

                    var fechaUltimoPago = moment(result.FechaUltimoPago.replace(/-/g, '/'), 'YYYY/MM/DD');
                    if (fechademanda.isValid()) {
                        var dias = moment.duration(fechademanda.diff(fechaUltimoPago)).asDays();
                        var cuantia = result.MontoSaldo + (result.MontoSaldo * parseFloat(((tasa / 100) / 365).toFixed(18)) * dias);

                        if (isNaN(cuantia)) {
                            $("#txtCuantia-" + idexpediente).val('');
                        } else {

                            $("#txtCuantia-" + idexpediente).val(cuantia.toFixed(2));
                        }
                    }

                },
                error: function () {
                    mostrarMensaje("Ocurrió un error", false);
                }
            });
    })

    function calcularMeses() {
        var fechaActual = moment(new Date(), 'DD/MM/YYYY'),
            fechaUltimaGestion = moment($("#txtFechaUltimaGestionAgregar").val(), 'DD/MM/YYYY');

        var resultado = moment.duration(fechaActual.diff(fechaUltimaGestion)).asDays();

        if (isNaN(Math.round(resultado / 31))) {
            $("#mesesUltimaGestionAgregar").val('');
        } else {
            $("#mesesUltimaGestionAgregar").val(Math.round(resultado / 31));
        }

    }

    function obtenerCantones() {
        $listaCantones = $("#ddlCantonesAgregar");
        $listaCantones.empty();
         $.ajax({
            url: "@Url.Action("ObtenerCantones", "DespachoJudicial")",
            type: "GET",
            data: { pCodProvincia: $("#ddlProvinciasAgregar").val() },
            traditional: true,
            success: function (result) {
                $.each(result, function (i, item) {
                    $listaCantones.append('<option value="' + item.CodCanton + '"> ' + item.Descripcion + ' </option>');
                });

                $(".selectpicker").selectpicker("refresh");

                obtenerDistritos();
            },
            error: function () {
                alert("No fue posible cargar los cantones");
            }
        });
    }

    function obtenerDistritos() {
        $listaDistritos = $("#ddlDistritosAgregar");
        $listaDistritos.empty();

         $.ajax({
            url: "@Url.Action("ObtenerDistritos", "DespachoJudicial")",
            type: "GET",
            data: { pCodCanton: $("#ddlCantonesAgregar").val(), pCodProvincia: $("#ddlProvinciasAgregar").val() },
            traditional: true,
            success: function (result) {
                $.each(result, function (i, item) {
                    $listaDistritos.append('<option value="' + item.CodDistrito + '"> ' + item.Descripcion + ' </option>');
                });

                $(".selectpicker").selectpicker("refresh");

                obtenerDespachoDomicilio();

            },
            error: function () {
                alert("No fue posible cargar los distritos");
            }
        });
    }

    function obtenerDespachoDomicilio() {
         $.ajax({
            url: "@Url.Action("ObtenerDomicilio", "DespachoJudicial")",
            type: "GET",
            data: { pCanton: $("#ddlCantonesAgregar").val(), pProvincia: $("#ddlProvinciasAgregar").val(), pDistrito: $("#ddlDistritosAgregar").val() },
            traditional: true,
            success: function (result) {
                if (typeof(result) !== "undefined") {
                    obtenerDespacho(result.CodDespachoJudicial);
                } else {
                    $("#autoridadJAAgregar").selectpicker('val', '');
                    $("#circuitoJudicialAgregar").selectpicker('val', '');
                    $(".selectpicker").selectpicker("refresh");
                }
            },
            error: function () {
                alert("No fue posible cargar los despachos");
            }
        });
    }

    function obtenerDespacho(codDespacho) {
        $listaDespacho = $("#ddlDistritosAgregar");

         $.ajax({
            url: "@Url.Action("ObtenerDespacho", "DespachoJudicial")",
            type: "GET",
            data: { pCodDespacho: codDespacho },
            traditional: true,
            success: function (result) {
                $("#autoridadJAAgregar").val(result.Codigo);
                $("#circuitoJudicialAgregar").val(result.Codigo);
                $(".selectpicker").selectpicker("refresh");
            },
            error: function () {
                alert("No fue posible cargar los distritos");
            }

        });
    }

    function guardarEJ() {

        var modelo = $("#ExpedienteModel").getModel(),
            $container = $("#nuevoExpediente");

        if (typeof modelo.Activo == 'undefined' || modelo.Activo == null) modelo.Activo = true;

        $container.find("small[for]").text("");

        modelo.IdExpediente = 0;


        var link = "@Url.Action("GuardarExpedienteInfo", "TramiteDetalle")";

        $.ajax({
            url: link,
            type: "POST",
            contentType: 'application/json; charset=utf-8',
            data: JSON.stringify(modelo),
            success: function (result) {
                var expedienteExistente = {
                    Id: 0,
                    IdExpediente: result.IdExpediente,
                    IdTramiteCobroJudicial: modelo.IdTramiteJudicial
                }
                crearExpedienteExistente(expedienteExistente);
            },
            error: function (jqXHR, status, error) {

                if (jqXHR.status === 409) {
                    var errors = jqXHR.responseJSON;

                    if (Array.isArray(errors)) {
                        var mensajes = '';

                        for (var i = 0; i < errors.length; i++) {
                            var reg = errors[i];
                            if (reg.Message !== undefined && reg.Message != null) {
                                if (reg.PropertyName !== undefined && reg.PropertyName != null) {
                                    var $element = $container.find("small[for='" + reg.PropertyName + "']");

                                    if ($element !== undefined) {
                                        $element.text(reg.Message);
                                    }

                                    //var $element2 = $container.find("" + reg.PropertyName + "']").text("* El campo es requerido");
                                    //var $element2 = $container.find("" + reg.PropertyName + "']");

                                    var $element2 = $container.find("small[for='" + reg.PropertyName + "']");

                                    if ($element2 !== undefined) {
                                        $container.find("small[for='" + reg.PropertyName + "']").text(reg.Message);
                                        Alerta('Validación: ', reg.PropertyName + "" + reg.Message, 'danger');
                                    }
                                } else
                                    mensajes += reg.Message + ' ';
                            }
                        }

                        if (mensajes != '')
                            Alerta('Guardar Expediente Judicial', mensajes, 'danger');
                    }
                }
                else {
                    Alerta('Guardar Expediente Judicial', jqXHR.responseText, 'danger');
                }
            }
        });

        $(".selectpicker").selectpicker("refresh");

    }

    function guardarExpedienteExistente() {
        var modelo = $("#ExpedienteExistenteModel").getModel();

        if (modelo.IdExpediente == 'undefined' || modelo.IdExpediente == null) {
            Alerta('Guardar Expediente', 'El campo es requerido', 'danger');
            return false;
        }
        crearExpedienteExistente(modelo);
    }

    function crearExpedienteExistente(modelo) {
         $.ajax({
            url: "@Url.Action("CrearExpedienteExistente", "TramiteDetalle")",
            type: "POST",
            contentType: 'application/json; charset=utf-8',
            data: JSON.stringify(modelo),
             success: function (result) {
                 $("#ExpedienteExistenteAgregarModal").modal("hide");
                 $("body").trigger("actualizarComponents");
                 Alerta(result);
            },
             error: function (jqXHR, status, error) {

                if (jqXHR.status === 409) {
                    var errors = jqXHR.responseJSON;

                    if (Array.isArray(errors)) {
                        var mensajes = '';

                        for (var i = 0; i < errors.length; i++) {
                            var reg = errors[i];
                            if (reg.Message !== undefined && reg.Message != null) {
                                if (reg.PropertyName !== undefined && reg.PropertyName != null) {
                                    var $element = $container.find("small[for='" + reg.PropertyName + "']");

                                    if ($element !== undefined) {
                                        $element.text(reg.Message);
                                    }
                                } else
                                    mensajes += reg.Message + ' ';
                            }
                        }

                        if (mensajes != '')
                            Alerta('Guardar Expediente Judicial', mensajes, 'danger');
                    }
                }
                else {
                    Alerta('Guardar Expediente Judicial', jqXHR.responseText, 'danger');
                }
            }
         });

        $(".selectpicker").selectpicker("refresh");

    }

    function actualizarExpedientes(){
        var id = $(this).attr("IdExpediente"),
            $container = $("#expediente-" + id),
            modelo = $("#ActualizarExpedienteModel-" + id).getModel(),
            registrosMontos = [];

        $container.find("small[for]").text("");
        $('#expediente-' + id).find(' .cuantia').each(function () {
            $(this).val($('#txtCuantia-' + id).val());
        })

        var contenedorMontos = $("div[divMontos][IdExpediente=" + id + "]");

        contenedorMontos.each(function (index, element) {
            var modeloMonto = $(element).getModel();
            registrosMontos.push(modeloMonto);
        });

        let modeloGuardar = {};
        
        var txtNumExpedienteJudicial = $("#txtNumExpedienteJudicial-" + id).val();

        console.log("modelo", modelo);
        console.log("modelo.IdExpediente", modelo.IdExpediente);
        console.log("modelo.NumExpedienteJudicial", modelo.NumExpedienteJudicial);
        console.log("By Id NumExpedienteJudicial", txtNumExpedienteJudicial);
        console.log("modelo.IdTramiteCobroJudicial", modelo.IdTramiteCobroJudicial);
        console.log("modelo.NumOperacion", modelo.NumOperacion);
        console.log("modelo.EsApersonamiento", modelo.EsApersonamiento);

        modelo.NumExpedienteJudicial = txtNumExpedienteJudicial;
        console.log("modelo Update NumExpedienteJudicial", modelo.NumExpedienteJudicial);

        modeloGuardar.ExpedienteObj = modelo;
        modeloGuardar.LstRelMontos = registrosMontos;
        modeloGuardar.IdTramiteJudicial = @Model.IdTramiteJudicial;
        console.log("modeloGuardar", modeloGuardar);

        $.ajax({
            url: "@Url.Action("ActualizarExpedienteInfo", "TramiteDetalle")",
            type: "POST",
            contentType: 'application/json; charset=utf-8',
            data: JSON.stringify(modeloGuardar),
            success: function (result) {

                //debugger;
                if (modelo.EsApersonamiento)
                {
                    //var Tab = "Apersonamiento";
                    // $.when(
                    //     $("body").trigger("actualizarComponents")
                    //    //).then(
                    //    //    RefrescarTramiteDetalleRedireccionarTab(modelo.IdTramiteCobroJudicial, modelo.NumOperacion, modelo.IdExpediente)
                    //    ).done(function () {
                    //        RefrescarTramiteDetalleRedireccionarTab(modelo.IdTramiteCobroJudicial, modelo.NumOperacion, modelo.IdExpediente, Tab);
                    //    });

                    Alerta('Actualizar Expediente Judicial', "Registro guardado con éxito", 'success', function () {
                        var Tab = "Apersonamiento";
                        RefrescarTramiteDetalleRedireccionarTab(modelo.IdTramiteCobroJudicial, modelo.NumOperacion, modelo.IdExpediente, Tab);
                    });
                }
                else
                {
                    Alerta('Actualizar Expediente Judicial', "Registro guardado con éxito", 'success', function () {
                        var Tab = "Expediente";
                        RefrescarTramiteDetalleRedireccionarTab(modelo.IdTramiteCobroJudicial, modelo.NumOperacion, modelo.IdExpediente, Tab);
                    });
                }

                //$("body").trigger("actualizarComponents");

            },
            error: function (jqXHR, status, error) {

                if (jqXHR.status === 409) {
                    var errors = jqXHR.responseJSON;

                    if (Array.isArray(errors)) {
                        var mensajes = '';

                        for (var i = 0; i < errors.length; i++) {
                            var reg = errors[i];
                            if (reg.Message !== undefined && reg.Message != null) {
                                if (reg.PropertyName !== undefined && reg.PropertyName != null) {
                                    var $element = $container.find("small[for='expedienteRegistrado." + reg.PropertyName + "']");

                                    if ($element !== undefined) {
                                        $element.text(reg.Message);
                                    }

                                    var $element2 = $container.find("small[for='" + reg.PropertyName + "']");
                                    if ($element2 !== undefined) {
                                        $element2.text(reg.Message);
                                    }
                                } else
                                    mensajes += reg.Message + ' ';
                            }
                        }

                        if (mensajes != '')
                        {
                            if (modelo.EsApersonamiento)
                            {
                                Alerta('Actualizar Expediente Judicial', mensajes, 'danger', function () {
                                    var Tab = "Apersonamiento";
                                    RefrescarTramiteDetalleRedireccionarTab(modelo.IdTramiteCobroJudicial, modelo.NumOperacion, modelo.IdExpediente, Tab);
                                });
                            }
                            else
                            {
                                Alerta('Actualizar Expediente Judicial', mensajes, 'danger', function () {
                                    var Tab = "Expediente";
                                    RefrescarTramiteDetalleRedireccionarTab(modelo.IdTramiteCobroJudicial, modelo.NumOperacion, modelo.IdExpediente, Tab);
                                });
                            }
                        }
                    }
                }
                else
                {
                    if (modelo.EsApersonamiento)
                    {
                        Alerta('Actualizar Expediente Judicial', jqXHR.responseText, 'danger', function () {
                            var Tab = "Apersonamiento";
                            RefrescarTramiteDetalleRedireccionarTab(modelo.IdTramiteCobroJudicial, modelo.NumOperacion, modelo.IdExpediente, Tab);                     
                        });
                    }
                    else
                    {
                        Alerta('Actualizar Expediente Judicial', jqXHR.responseText, 'danger', function () {
                            var Tab = "Expediente";
                            RefrescarTramiteDetalleRedireccionarTab(modelo.IdTramiteCobroJudicial, modelo.NumOperacion, modelo.IdExpediente, Tab);
                        });
                    }
                }
            //$("body").trigger("actualizarComponents");
            }
        });
    }

    function agregarRemate() {

        $('.progressremate').hide();

        var id = $(this).attr("IdExpediente");
        $("#RemateAgregarModal").modal("show");
        $("#hidIdExpedienteRemate").val(id);
    }

    function guardarRemate() {

        $('.progressremate').show();

        var modelo = $("#RemateModel").getModel(),
            $container = $("#RemateModel"),
            validate = true;

        modelo.IdRemate = 0;
        modelo.IdExpediente = $("#hidIdExpedienteRemate").val();

        if (typeof modelo.FechaRemate === 'undefined' || modelo.FechaRemate === '0001-01-01T00:00:00.000') {
            $container.find("small[for='FechaRemate']").text("* El campo es requerido");
            validate = false;
        }
        if (typeof modelo.MontoBase === 'undefined' || modelo.MontoBase == 0 || modelo.MontoBase == null) {
            $container.find("small[for='MontoBase']").text("* El campo es requerido");
            validate = false;
        }
        if (typeof modelo.Activo === 'undefined' || modelo.Activo === null) {
            $container.find("small[for='Activo']").text("* El campo es requerido");
            validate = false;
        }

        if (!validate) return false;

        $.ajax({
            url: "@Url.Action("AgregarRemate", "TramiteDetalle")",
            type: "POST",
            contentType: 'application/json; charset=utf-8',
            data: JSON.stringify(modelo),
            success: function (result) {
                $("#RemateAgregarModal").modal("hide");
                Alerta('Guardar Remate', "Registro guardado con éxito", 'success');
                $("body").trigger("actualizarComponents");
            },
            error: function (jqXHR, status, error) {
                Alerta('Actualizar Expediente Judicial', jqXHR.responseText, 'danger');
            }
        });
    }

    function actualizarRemates()
    {
        var id = $(this).attr("IdRemate");
        var contenedorRemates = $("div[divRemates]"),
            registrosRemates = [],
            msgsError,
            controlesRemates;

        contenedorRemates.each(function (index, element) {
            id = $(element).attr("IdRemate");
            idExpediente = $(element).attr("IdExpediente");
            controlesRemates = $(this).find(".controlRemateDetalle");

            msgsError = "";

            var fechaRemate, montoBase, activo;

            controlesRemates.each(function () {
                if (this.id.includes("txtFechaRemate")) {
                    if (this.value.length != 0 && !moment(this.value, "DD/MM/YYYY", true).isValid()) {
                        msgsError += "\nEl campo fecha remate no es válido.";
                    } else if (this.value.length == 0) {
                        msgsError += "\nEl campo fecha remate no es válido.";
                    }
                    else fechaRemate = moment(this.value, 'DD-MM-YYYY').format('YYYY-MM-DD');
                }

                if (this.id.includes("txtMontoBase")) {

                    if (this.value != 0) {
                        montoBase = this.value;
                    } else {
                        msgsError += "\nEl campo monto base no es válido.";
                    }

                }

                if (this.id.includes("estadoRemate")) {
                    activo = this.value;
                }
            });

            if (msgsError != "") {
                return false;
            }


            var detalleRemate = {
                IdRemate: id,
                IdExpediente: idExpediente,
                FechaRemate: fechaRemate,
                MontoBase: montoBase,
                Activo: activo
            }

            registrosRemates.push(detalleRemate);

        });

        if (msgsError != "") {
            Alerta("Actualizar Remates", msgsError, "danger");
            return false;
        }

        $.ajax({
            url: "@Url.Action("GuardarRemates", "TramiteDetalle")",
            type: "POST",
            contentType: 'application/json; charset=utf-8',
            data: JSON.stringify(registrosRemates),
            success: function (mensaje) {
                Alerta('Actualizar Remates', mensaje, 'success');
                $("body").trigger("actualizarComponents");
            },
            error: function (jqXHR, status, error) {
                Alerta('Actualizar Remates', jqXHR.responseText, 'danger');
            }
        });
    }

    function adjuntarArchivoDemanda() {
        $("#adj-demanda-modal").find(".info-container").html('');
        $("#adj-demanda-modal").find(".progressbar-container").show();
        $("#adj-demanda-modal").modal("show");
        var modelo = $("#ExpedienteModel").getModel();
        var idExpediente = $(this).attr("IdExpediente");
        var numOperacion = $("#txtNumOperacionGeneral").val();
        var idTramite = modelo.IdTramiteJudicial;

        let link = '@Url.Action("ModalAdjuntarDemanda", "CargarDemanda", new { pIdExpediente = "p_IdExpediente", pNumOperacion = "p_NumOperacion", pIdTramite = "p_IdTramite" })';
        link = link.replace("p_IdExpediente", idExpediente);
        link = link.replace("p_NumOperacion", numOperacion);
        link = link.replace("p_IdTramite", idTramite);
        link = link.replace("&amp;", "&");
        link = link.replace("&amp;", "&");

        $("#adj-demanda-modal").find(".info-container").load(link, function () {
            $("#adj-demanda-modal").find(".progressbar-container").hide();
            $("#adj-demanda-modal").find(".selectpicker").selectpicker('render');
            $("#adj-demanda-modal").customdatepicker();
            $("#adj-demanda-modal").custominputs("refresh");
            $("#adj-demanda-modal").find("[data-set-focus]").focus();
        });
    }

    function agregarFechaRematePuestaPosesion() {
        $('.progressfecharemate').hide();
        var idExpedienteJudicial = $(this).attr("IdExpedienteJudicial");
        var tramiteCobro = $(this).attr("TramiteCobro");
        var numOperacion = $(this).attr("NumOperacion");

        $("#FechaRematePuestaPosesionAgregarModal").modal("show");

        $("#hidExpedienteJudicialFechaRematePuestaPosesion").val(idExpedienteJudicial);
        $("#hTramiteCobroFechaRematePuestaPosesion").val(tramiteCobro);
        $("#hNumOperacionFechaRematePuestaPosesion").val(numOperacion);
    }

    function guardarFechaRematePuestaPosesion() {
        $('.progressfecharemate').show();
        var modelo = $("#FechaRematePuestaPosesionModel").getModel(),
            $container = $("#FechaRematePuestaPosesionModel"),
            validate = true;

        modelo.IdFechaRematePuestaPosesion = 0;
        modelo.IdExpediente = $("#hidExpedienteJudicialFechaRematePuestaPosesion").val();
        modelo.TramiteCobro = $("#hTramiteCobroFechaRematePuestaPosesion").val();
        modelo.NumOperacion = $("#hNumOperacionFechaRematePuestaPosesion").val();

        if (typeof modelo.FechaRemate1 === 'undefined' || modelo.FechaRemate1 === '0001-01-01T00:00:00.000') {
            //$container.find("small[for='FechaRemate1']").text("* El campo es requerido");
            //validate = false;
        }
        if (typeof modelo.FechaRemate2 === 'undefined' || modelo.FechaRemate2 === '0001-01-01T00:00:00.000') {
            //$container.find("small[for='FechaRemate2']").text("* El campo es requerido");
            //validate = false;
        }
        if (typeof modelo.FechaRemate3 === 'undefined' || modelo.FechaRemate3 === '0001-01-01T00:00:00.000') {
            //$container.find("small[for='FechaRemate3']").text("* El campo es requerido");
            //validate = false;
        }
        if (typeof modelo.HoraRemate1 == null) {//HH:mm:ss
            //$container.find("small[for='HoraRemate1']").text("* El campo es requerido");
            //validate = false;
        }
        if (typeof modelo.HoraRemate2 == null) {//HH:mm:ss
            //$container.find("small[for='HoraRemate2']").text("* El campo es requerido");
            //validate = false;
        }
        if (typeof modelo.HoraRemate3 == null) {//HH:mm:ss
            //$container.find("small[for='HoraRemate3']").text("* El campo es requerido");
            //validate = false;
        }
        if (typeof modelo.MontoRemateBase1 === 'undefined' || modelo.MontoRemateBase1 == 0 || modelo.MontoRemateBase1 == null) {
            //$container.find("small[for='MontoRemateBase1']").text("* El campo es requerido");
            //validate = false;
        }
        if (typeof modelo.MontoRemateBase2 === 'undefined' || modelo.MontoRemateBase2 == 0 || modelo.MontoRemateBase2 == null) {
            //$container.find("small[for='MontoRemateBase2']").text("* El campo es requerido");
            //validate = false;
        }
        if (typeof modelo.MontoRemateBase3 === 'undefined' || modelo.MontoRemateBase3 == 0 || modelo.MontoRemateBase3 == null) {
            //$container.find("small[for='MontoRemateBase3']").text("* El campo es requerido");
            //validate = false;
        }
        if (typeof modelo.SaldoDecretadoJudicial === 'undefined' || modelo.SaldoDecretadoJudicial == 0 || modelo.SaldoDecretadoJudicial == null) {
            //$container.find("small[for='SaldoDecretadoJudicial']").text("* El campo es requerido");
            //validate = false;
        }
        if (typeof modelo.FechaProtocolizacion === 'undefined' || modelo.FechaProtocolizacion === '0001-01-01T00:00:00.000') {
            //$container.find("small[for='FechaProtocolizacion']").text("* El campo es requerido");
            //validate = false;
        }
        if (typeof modelo.FechaPuestaPosesion === 'undefined' || modelo.FechaPuestaPosesion === '0001-01-01T00:00:00.000') {
            //$container.find("small[for='FechaPuestaPosesion']").text("* El campo es requerido");
            //validate = false;
        }

        //alert($("#txtHoraRemate1Agregar").val())

        //if (!validate) return false;

        $.ajax({
            url: "@Url.Action("AgregarFechaRematePuestaPosesion", "TramiteDetalle")",
            type: "POST",
            contentType: 'application/json; charset=utf-8',
            data: JSON.stringify(modelo),
            success: function (result) {
                $("#FechaRematePuestaPosesionAgregarModal").modal("hide");
                Alerta('Guardar Fecha Remate Puesta Posesión', "Registro guardado con éxito", 'success');
                $("body").trigger("actualizarComponents");
            },
            error: function (jqXHR, status, error) {
                Alerta('Actualizar Fecha Remate Puesta Posesión', jqXHR.responseText, 'danger');
            }
        });
    }

    function actualizarFechaRematePuestaPosesion()
    {
        var id = $(this).attr("IdFechaRematePuestaPosesion");
        var idExpedienteJudicial = $(this).attr("IdExpedienteJudicial");
        var tramiteCobro = $(this).attr("TramiteCobro");
        var numOperacion = $(this).attr("NumOperacion");
        var contenedorFechaRematePuestaPosesion = $("div[divFechaRematePuestaPosesion]"),
            registrosFechaRematePuestaPosesion = [],
            msgsError,
            controlesFechaRematePuestaPosesion;


        contenedorFechaRematePuestaPosesion.each(function (index, element) {
            idFechaRematePuestaPosesion = $(element).attr("IdFechaRematePuestaPosesion");
            //idExpedienteJudicial = $(element).attr("IdExpedienteJudicial");
            //tramiteCobro = $(element).attr("TramiteCobro");
            //numOperacion = $(element).attr("NumOperacion");

            controlesFechaRematePuestaPosesion = $(this).find(".controlFechaRematePuestaPosesionDetalle");

            msgsError = "";

            var fechaRemate1, fechaRemate2, fechaRemate3, horaRemate1, horaRemate2, horaRemate3, montoRemateBase1,
                montoRemateBase2, montoRemateBase3, saldoDecretadoJudicial, fechaProtocolizacion, fechaPuestaPosesion;

            controlesFechaRematePuestaPosesion.each(function () {

                if (this.id.includes("txtFechaRemate1")) {
                    if (this.value.length != 0 && !moment(this.value, "DD/MM/YYYY", true).isValid()) {
                        //msgsError += "\nEl campo fecha remate 1 no es válido.";
                    } else if (this.value.length == 0) {
                        //msgsError += "\nEl campo fecha remate 1 no es válido.";
                    }
                    else fechaRemate1 = moment(this.value, 'DD-MM-YYYY').format('YYYY-MM-DD');
                }

                if (this.id.includes("txtFechaRemate2")) {
                    if (this.value.length != 0 && !moment(this.value, "DD/MM/YYYY", true).isValid()) {
                        //msgsError += "\nEl campo fecha remate 2 no es válido.";
                    } else if (this.value.length == 0) {
                        //msgsError += "\nEl campo fecha remate 2 no es válido.";
                    }
                    else fechaRemate2 = moment(this.value, 'DD-MM-YYYY').format('YYYY-MM-DD');
                }

                if (this.id.includes("txtFechaRemate3")) {
                    if (this.value.length != 0 && !moment(this.value, "DD/MM/YYYY", true).isValid()) {
                        //msgsError += "\nEl campo fecha remate 3 no es válido.";
                    } else if (this.value.length == 0) {
                        //msgsError += "\nEl campo fecha remate 3 no es válido.";
                    }
                    else fechaRemate3 = moment(this.value, 'DD-MM-YYYY').format('YYYY-MM-DD');
                }
                //if (typeof modelo.HoraRemate1 == null)
                if (this.id.includes("txtHoraRemate1")) {
                    if (this.value.length != 0) {
                        //    /*msgsError += "\nEl campo hora remate 1 no es válido.";*/
                        horaRemate1 = this.value;
                    } else horaRemate1 = this.value;
                    //else if (this.value.length == 0) {
                    //    //msgsError += "\nEl campo hora remate 1 no es válido.";
                    //}
                    //else
                    console.log(horaRemate1);
                    //horaRemate1 = moment(this.value, "HH:mm:ss").format("HH:mm:ss");
                    console.log("Conversion");
                    console.log(moment(this.value, "HH:mm:ss").format("HH:mm:ss"));
                }
                if (this.id.includes("txtHoraRemate2")) {
                    if (this.value.length != 0) {
                        /*msgsError += "\nEl campo hora remate 2 no es válido.";*/
                        horaRemate2 = this.value;
                    }
                    else horaRemate2 = this.value;
                    //else if (this.value.length == 0) {
                    //    //msgsError += "\nEl campo hora remate 2 no es válido.";
                    //}
                    //else horaRemate2 = moment(this.value, "HH:mm:ss").format("HH:mm:ss");
                }
                if (this.id.includes("txtHoraRemate3")) {
                    if (this.value.length != 0) {
                        /*msgsError += "\nEl campo hora remate 3 no es válido.";*/
                        horaRemate3 = this.value;
                    } else horaRemate2 = this.value;
                    //else if (this.value.length == 0) {
                    //    //msgsError += "\nEl campo hora remate 3 no es válido.";
                    //}
                    //else horaRemate3 = moment(this.value, "HH:mm:ss").format("HH:mm:ss");
                }

                if (this.id.includes("txtMontoRemateBase1")) {
                    if (this.value != 0) {
                        montoRemateBase1 = this.value;
                    } else {
                        //msgsError += "\nEl campo monto base 1 no es válido.";
                    }
                }

                if (this.id.includes("txtMontoRemateBase2")) {
                    if (this.value != 0) {
                        montoRemateBase2 = this.value;
                    } else {
                        //msgsError += "\nEl campo monto base 2 no es válido.";
                    }
                }

                if (this.id.includes("txtMontoRemateBase3")) {
                    if (this.value != 0) {
                        montoRemateBase3 = this.value;
                    } else {
                        //msgsError += "\nEl campo monto base 3 no es válido.";
                    }
                }

                if (this.id.includes("txtSaldoDecretadoJudicial")) {
                    if (this.value != 0) {
                        saldoDecretadoJudicial = this.value;
                    } else {
                        //msgsError += "\nEl campo saldo decretado judicial no es válido.";
                    }
                }

                if (this.id.includes("txtFechaProtocolizacion")) {
                    if (this.value.length != 0 && !moment(this.value, "DD/MM/YYYY", true).isValid()) {
                        //msgsError += "\nEl campo fecha remate 3 no es válido.";
                    } else if (this.value.length == 0) {
                        //msgsError += "\nEl campo fecha protocolización no es válido.";
                    }
                    else fechaProtocolizacion = moment(this.value, 'DD-MM-YYYY').format('YYYY-MM-DD');
                }

                if (this.id.includes("txtFechaPuestaPosesion")) {
                    if (this.value.length != 0 && !moment(this.value, "DD/MM/YYYY", true).isValid()) {
                        //msgsError += "\nEl campo fecha puesta en posesión no es válido.";
                    } else if (this.value.length == 0) {
                        //msgsError += "\nEl campo fecha puesta en posesión no es válido.";
                    }
                    else fechaPuestaPosesion = moment(this.value, 'DD-MM-YYYY').format('YYYY-MM-DD');
                }
            });

            //if (msgsError != "") {
            //    return false;
            //}

            horaRemate1 = $("#txtHoraRemate1" + idFechaRematePuestaPosesion).val();
            horaRemate2 = $("#txtHoraRemate2" + idFechaRematePuestaPosesion).val();
            horaRemate3 = $("#txtHoraRemate3" + idFechaRematePuestaPosesion).val();

            var detalleFechaRematePuestaPosesion = {
                IdFechaRematePuestaPosesion: id,
                IdExpedienteJudicial: idExpedienteJudicial,
                TramiteCobro: tramiteCobro,
                NumOperacion: numOperacion,
                FechaRemate1: fechaRemate1,
                FechaRemate2: fechaRemate2,
                FechaRemate3: fechaRemate3,
                HoraRemate1: horaRemate1,
                HoraRemate2: horaRemate2,
                HoraRemate3: horaRemate3,
                MontoRemateBase1: montoRemateBase1,
                MontoRemateBase2: montoRemateBase2,
                MontoRemateBase3: montoRemateBase3,
                SaldoDecretadoJudicial: saldoDecretadoJudicial,
                FechaProtocolizacion: fechaProtocolizacion,
                FechaPuestaPosesion: fechaPuestaPosesion
            }

            registrosFechaRematePuestaPosesion.push(detalleFechaRematePuestaPosesion);

        });

        if (msgsError != "") {
            Alerta("Actualizar Fecha Remate Puesta Posesión", msgsError, "danger");
            return false;
        }

        $.ajax({
            url: "@Url.Action("GuardarFechaRematePuestaPosesion", "TramiteDetalle")",
            type: "POST",
            contentType: 'application/json; charset=utf-8',
            data: JSON.stringify(registrosFechaRematePuestaPosesion),
            success: function (mensaje) {
                Alerta('Actualizar Fecha Remate Puesta Posesión', mensaje, 'success');
                $("body").trigger("actualizarComponents");
            },
            error: function (jqXHR, status, error) {
                Alerta('Actualizar Fecha Remate Puesta Posesión', jqXHR.responseText, 'danger');
            }
        });
    }

    function calcularMontosBase() {

        //--Digitar Monto base 1er remate y
        //--calcular 2do: (monto base - 25 %) y
        //--el 3ero: monto base - 75 %)
        var MontoRemateBase1 = $("#txtMontoRemateBase1Agregar").val();

        var Procentaje25 = MontoRemateBase1 * 0.25;
        var Porcentaje75 = MontoRemateBase1 * 0.75;
        var MontoRemateBase2 = (MontoRemateBase1 - Procentaje25);
        var MontoRemateBase3 = (MontoRemateBase1 - Porcentaje75);

        document.getElementById("txtMontoRemateBase2Agregar").value = MontoRemateBase2;
        document.getElementById("txtMontoRemateBase3Agregar").value = MontoRemateBase3;
    }

    function calcularMontosBaseEditar() {

        var Id = $("#txtIdFechaRematePuestaPosesion").val();
        //--Digitar Monto base 1er remate y
        //--calcular 2do: (monto base - 25 %) y
        //--el 3ero: monto base - 75 %)
        var MontoRemateBase1 = $("#txtMontoRemateBase1"+Id).val();

        var Procentaje25 = MontoRemateBase1 * 0.25;
        var Porcentaje75 = MontoRemateBase1 * 0.75;
        var MontoRemateBase2 = (MontoRemateBase1 - Procentaje25);
        var MontoRemateBase3 = (MontoRemateBase1 - Porcentaje75);

        document.getElementById("txtMontoRemateBase2" + Id).value = MontoRemateBase2;
        document.getElementById("txtMontoRemateBase3" + Id).value = MontoRemateBase3;
    }

    function agregarResultadosRemate() {
        $('.progressresultadoremate').hide();
        var idExpedienteJudicial = $(this).attr("IdExpedienteJudicial");
        var tramiteCobro = $(this).attr("TramiteCobro");
        var numOperacion = $(this).attr("NumOperacion");
        var idFechaRematePuestaPosesion = $(this).attr("IdFechaRematePuestaPosesion");

        $("#ResultadosRemateAgregarModal").modal("show");

        $("#hIdExpedienteJudicialResultadosRemate").val(idExpedienteJudicial);
        $("#hTramiteCobroResultadosRemate").val(tramiteCobro);
        $("#hNumOperacionResultadosRemate").val(numOperacion);
        $("#hIdFechaRematePuestaPosesionResultadosRemate").val(idFechaRematePuestaPosesion);

    }

    function guardarResultadosRemate() {

        $('.progressresultadoremate').show();
        var modelo = $("#ResultadosRemateModel").getModel(),
            $container = $("#ResultadosRemateModel"),
            validate = true;

        modelo.IdResultadosRemate = 0;
        modelo.IdExpedienteJudicial = $("#hIdExpedienteJudicialResultadosRemate").val();
        modelo.TramiteCobro = $("#hTramiteCobroResultadosRemate").val();
        modelo.NumOperacion = $("#hNumOperacionResultadosRemate").val();
        modelo.IdFechaRematePuestaPosesion = $("#hIdFechaRematePuestaPosesionResultadosRemate").val();

        //alert("Ingresa");

        if (typeof modelo.IndExpJudiAdjudicado === 'undefined' || modelo.IndExpJudiAdjudicado == null) {
            $container.find("small[for='IndExpJudiAdjudicado']").text("* El campo es requerido");
            validate = false;
        }
        if (typeof modelo.FecFirmezaRemate === 'undefined' || modelo.FecFirmezaRemate === '0001-01-01T00:00:00.000') {
            //$container.find("small[for='FecFirmezaRemate']").text("* El campo es requerido");
            //validate = false;
        }
        if (typeof modelo.MontoAdjudicacion === 'undefined' || modelo.MontoAdjudicacion == 0 || modelo.MontoAdjudicacion == null) {
            //$container.find("small[for='MontoAdjudicacion']").text("* El campo es requerido");
            //validate = false;
        }
        if (typeof modelo.IdEncargadoProtocolizacion === 'undefined' || modelo.IdEncargadoProtocolizacion == null) {
            //$container.find("small[for='EncargadoProtocolizacion']").text("* El campo es requerido");
            //validate = false;
        }
        if (typeof modelo.IdEncargadoPuestaPosesion === 'undefined' || modelo.IdEncargadoPuestaPosesion == null) {
            //$container.find("small[for='EncargadoPuestaPosesion']").text("* El campo es requerido");
            //validate = false;
        }
        if (typeof modelo.IndRemateFirme === 'undefined' || modelo.IndRemateFirme == null) {
            //$container.find("small[for='IndRemateFirme']").text("* El campo es requerido");
            //validate = false;
        }

        if (!validate) return false;

        $.ajax({
            url: "@Url.Action("AgregarResultadosRemate", "TramiteDetalle")",
            type: "POST",
            contentType: 'application/json; charset=utf-8',
            data: JSON.stringify(modelo),
            success: function (result) {
                $("#ResultadosRemateAgregarModal").modal("hide");
                Alerta('Guardar Resultados de Remate', "Registro guardado con éxito", 'success');
                $("body").trigger("actualizarComponents");
            },
            error: function (jqXHR, status, error) {
                Alerta('Actualizar Resultados de Remate', jqXHR.responseText, 'danger');
            }
        });
    }

    function actualizarResultadosRemate()
    {
        var idResultadosRemate = $(this).attr("IdResultadosRemate");
        var idFechaRematePuestaPosesion = $(this).attr("IdFechaRematePuestaPosesion");
        var idExpedienteJudicial = $(this).attr("IdExpedienteJudicial");
        var tramiteCobro = $(this).attr("TramiteCobro");
        var numOperacion = $(this).attr("NumOperacion");

        var contenedorResultadosRemate = $("div[divResultadosRemate]"),
            registrosResultadosRemate = [],
            msgsError,
            controlesResultadosRemate;

        contenedorResultadosRemate.each(function (index, element) {
            //idResultadosRemate = $(element).attr("IdResultadosRemate");
            //idExpedienteJudicial = $(element).attr("IdExpedienteJudicial");
            //tramiteCobro = $(element).attr("TramiteCobro");
            //numOperacion = $(element).attr("NumOperacion");

            controlesResultadosRemate = $(this).find(".controlResultadosRemateDetalle");

            msgsError = "";

            //alert("guardarResultadosRemate");

            var indExpJudiAdjudicado, fecFirmezaRemate, montoAdjudicacion, idEncargadoProtocolizacion, idEncargadoPuestaPosesion, indRemateFirme;//activo;

            controlesResultadosRemate.each(function () {

                if (this.id.includes("txtIndExpJudiAdjudicadoDiv")) {
                    indExpJudiAdjudicado = $("input:radio[name='ResultadosRematePP.IndExpJudiAdjudicado']:checked").val();
                }

                if (this.id.includes("txtFecFirmezaRemate")) {
                    if (this.value.length != 0 && !moment(this.value, "DD/MM/YYYY", true).isValid()) {
                        //msgsError += "\nEl campo fecha firmeza remate no es válido.";
                    } else if (this.value.length == 0) {
                        //msgsError += "\nEl campo fecha firmeza remate no es válido.";
                    }
                    else fecFirmezaRemate = moment(this.value, 'DD-MM-YYYY').format('YYYY-MM-DD');
                }

                if (this.id.includes("txtMontoAdjudicacion")) {

                    if (this.value != 0) {
                        montoAdjudicacion = this.value;
                    } else {
                        //msgsError += "\nEl campo monto adjudicación no es válido.";
                    }
                }

                if (this.id.includes("txtIdEncargadoProtocolizacion")) {
                    if (this.value != 0) {
                        idEncargadoProtocolizacion = this.value;
                    } else {
                        //msgsError += "\nEl campo Encargado Protocolización no es válido.";
                    }
                }

                if (this.id.includes("txtIdEncargadoPuestaPosesion")) {
                    if (this.value != 0) {
                        idEncargadoPuestaPosesion = this.value;
                    } else {
                        //msgsError += "\nEl campo Encargado de Puesta Posesión no es válido.";
                    }
                }

                if (this.id.includes("txtIndRemateFirmeDiv")) {
                    indRemateFirme = $("input:radio[name='ResultadosRematePP.IndRemateFirme']:checked").val();
                }

            });

            if (msgsError != "") {
                return false;
            }


            var detalleResultadosRemate = {
                IdResultadosRemate: idResultadosRemate,
                IdFechaRematePuestaPosesion: idFechaRematePuestaPosesion,

                IdExpedienteJudicial: idExpedienteJudicial,
                TramiteCobro: tramiteCobro,
                NumOperacion: numOperacion,

                IndExpJudiAdjudicado: indExpJudiAdjudicado,
                FecFirmezaRemate:fecFirmezaRemate,
                MontoAdjudicacion: montoAdjudicacion,
                IdEncargadoProtocolizacion: idEncargadoProtocolizacion,
                IdEncargadoPuestaPosesion: idEncargadoPuestaPosesion,
                IndRemateFirme: indRemateFirme
            }

            registrosResultadosRemate.push(detalleResultadosRemate);

        });

        if (msgsError != "") {
            Alerta("Actualizar Resultados Remate", msgsError, "danger");
            return false;
        }

        $.ajax({
            url: "@Url.Action("GuardarResultadosRemate", "TramiteDetalle")",
            type: "POST",
            contentType: 'application/json; charset=utf-8',
            data: JSON.stringify(registrosResultadosRemate),
            success: function (mensaje) {
                Alerta('Actualizar Resultados Remate', mensaje, 'success');
                $("body").trigger("actualizarComponents");
            },
            error: function (jqXHR, status, error) {
                Alerta('Actualizar Resultados Remate', jqXHR.responseText, 'danger');
            }
        });
    }

    function agregarInstruccionesRemate() {

        $('.progressinstruccionesremate').hide();

        var idExpedienteJudicial = $(this).attr("IdExpedienteJudicial");
        var tramiteCobro = $(this).attr("TramiteCobro");
        var numOperacion = $(this).attr("NumOperacion");

        //alert("IdExpedienteJudicialIR> " + idExpedienteJudicial);
        //alert("TramiteCobroIR> " +tramiteCobro);
        //alert("NumOperacionIR> " +numOperacion);

        $("#InstruccionesRemateAgregarModal").find(".text-danger").html('');

        $("#InstruccionesRemateAgregarModal").modal("show");

        $("#hidExpedienteJudicialInstruccionesRemate").val(idExpedienteJudicial);
        $("#hTramiteCobroInstruccionesRemate").val(tramiteCobro);
        $("#hNumOperacionInstruccionesRemate").val(numOperacion);
    }

    function guardarInstruccionesRemate() {

        $('.progressinstruccionesremate').show();

        var modelo = $("#InstruccionesRemateModel").getModel(),
            $container = $("#InstruccionesRemateModel"),
            validate = true;

        modelo.IdInstruccionesRemate = 0;
        modelo.IdExpedienteJudicial = $("#hidExpedienteJudicialInstruccionesRemate").val();
        modelo.TramiteCobro = $("#hTramiteCobroInstruccionesRemate").val();
        modelo.NumOperacion = $("#hNumOperacionInstruccionesRemate").val();

        //alert("Hora: " + modelo.HoraRemate);

        //alert($("#hidExpedienteJudicialInstruccionesRemate").val());
        //alert($("#hTramiteCobroInstruccionesRemate").val());
        //alert($("#hNumOperacionInstruccionesRemate").val());

        //var IndicacionPeritoAgregar = $("#txtIdIndicacionPeritoAgregar").val();
        var IndicacionPeritoAgregar = $("#txtIdIndicacionPeritoAgregar");
        $(IndicacionPeritoAgregar).val();
        console.log($(IndicacionPeritoAgregar).val(), ' IndicacionPeritoAgregar');
        console.log(modelo.IdIndicacionPerito, ' modelo.IdIndicacionPerito');

        //if (typeof modelo.IdIndicacionPerito === 'undefined' || modelo.IdIndicacionPerito === '' ||
        //    modelo.IdIndicacionPerito === null || modelo.IdIndicacionPerito == null) {
        //    $container.find("small[for='IdIndicacionPerito']").text("* El campo es requerido");
        //    validate = false;

        //}

        if (modelo.IdIndicacionPerito == 'undefined' || modelo.IdIndicacionPerito == null || modelo.IdIndicacionPerito == "") {
            //Alerta('Guardar Registro', 'El campo Indicación Perito es requerido', 'danger');
            $container.find("small[for='IdIndicacionPerito']").text("* El campo es requerido");
            validate = false;//return false;
        }

        //if (typeof modelo.IndInteresPrescritos === 'undefined' || modelo.IndInteresPrescritos == null) {
        //    $container.find("small[for='IndInteresPrescritos']").text("* El campo es requerido");
        //    validate = false;
        //}

        //if (typeof modelo.IndInteresPrescritos !== 'undefined' || modelo.IndInteresPrescritos != null) {
        //    $container.find("small[for='IndInteresPrescritos']").text("* El campo es requerido");
        //    validate = false;

        //    var valorIndInteresPrescritos = modelo.IndInteresPrescritos;

        //    if (valorIndInteresPrescritos == 'True') {
        //        console.log(modelo.FechaDesde, ' Desde');
        //        console.log(modelo.FechaHasta, ' Hasta');
        //        if (typeof modelo.FechaDesde === 'undefined' || modelo.FechaDesde === null || modelo.FechaDesde === '0001-01-01T00:00:00.000') {
        //            $container.find("small[for='FechaDesde']").text("* El campo es requerido");
        //            validate = false;
        //        }

        //        if (typeof modelo.FechaHasta === 'undefined' || modelo.FechaHasta === null || modelo.FechaHasta === '0001-01-01T00:00:00.000') {
        //            $container.find("small[for='FechaHasta']").text("* El campo es requerido");
        //            validate = false;
        //        }
        //    }
        //}

        indInteresPrescritos = $("input:radio[name='IndInteresPrescritos']:checked").val();

        console.log(indInteresPrescritos, ' indInteresPrescritos');
        console.log(modelo.IndInteresPrescritos, ' modelo.IndInteresPrescritos');

        if (typeof modelo.IndInteresPrescritos === 'undefined' || modelo.IndInteresPrescritos == null) {

            $container.find("small[for='IndInteresPrescritos']").text("* El campo es requerido");
            validate = false;
        }

        if (modelo.IndInteresPrescritos === 'True' || modelo.IndInteresPrescritos === true  || modelo.IndInteresPrescritos === 'true') {

            console.log(modelo.FechaDesde, ' modelo.FechaDesde');
            console.log(modelo.FechaHasta, ' modelo.FechaHasta');

            if (typeof modelo.FechaDesde === 'undefined' || modelo.FechaDesde === '0001-01-01T00:00:00.000') {
                $container.find("small[for='FechaDesde']").text("* El campo es requerido");
                validate = false;
            }

            if (typeof modelo.FechaHasta === 'undefined' || modelo.FechaHasta === '0001-01-01T00:00:00.000') {
                $container.find("small[for='FechaHasta']").text("* El campo es requerido");
                validate = false;
            }
            //var valFechaDesde = $("#txtFechaDesde").val();
            //var valFechahasta = $("#txtFechaHasta").val();

            //console.log(valFechaDesde, ' valFechaDesde');
            //console.log(valFechahasta, ' valFechahasta');

            //if (valFechaDesde.length !== 0 && !moment(valFechaDesde, "DD/MM/YYYY", true).isValid()) {
            //    //msgsError += "\nEl campo fecha desde no es válido.";
            //    $container.find("small[for='FechaDesde']").text("* El campo es requerido");
            //    validate = false;
            //} else if (valFechaDesde.length === 0) {
            //    //msgsError += "\nEl campo fecha desde no es válido.";
            //    $container.find("small[for='FechaDesde']").text("* El campo es requerido");
            //    validate = false;
            //}
            //else fechaDesde = moment(valFechaDesde, 'DD-MM-YYYY').format('YYYY-MM-DD');


            //if (valFechahasta.length !== 0 && !moment(valFechahasta, "DD/MM/YYYY", true).isValid()) {
            //    //msgsError += "\nEl campo fecha hasta no es válido.";
            //    $container.find("small[for='FechaHasta']").text("* El campo es requerido");
            //    validate = false;
            //} else if (valFechahasta.length === 0) {
            //    //msgsError += "\nEl campo fecha hasta no es válido.";
            //    $container.find("small[for='FechaHasta']").text("* El campo es requerido");
            //    validate = false;
            //}
            //else fechaHasta = moment(valFechahasta, 'DD-MM-YYYY').format('YYYY-MM-DD');

        }

        if (typeof modelo.FechaAdjudicar === 'undefined' || modelo.FechaAdjudicar === '0001-01-01T00:00:00.000') {
            $container.find("small[for='FechaAdjudicar']").text("* El campo es requerido");
            validate = false;
        }

        if (typeof modelo.NumOficio === 'undefined' || modelo.NumOficio == null) {
            $container.find("small[for='NumOficio']").text("* El campo es requerido");
            validate = false;
        }

        if (typeof modelo.NumGarantia === 'undefined' || modelo.NumGarantia == null) {
            $container.find("small[for='NumGarantia']").text("* El campo es requerido");
            validate = false;
        }

        if (typeof modelo.FecRemate === 'undefined' || modelo.FecRemate === '0001-01-01T00:00:00.000') {
            $container.find("small[for='FecRemate']").text("* El campo es requerido");
            validate = false;
        }

        console.log(modelo.HoraRemate, 'HoraRemate');
        if (typeof typeof modelo.HoraRemate === 'undefined' || modelo.HoraRemate == null) {//HH:mm:ss
            $container.find("small[for='HoraRemate']").text("* El campo es requerido");
            validate = false;
        }

        if (typeof modelo.BaseRemate === 'undefined' || modelo.BaseRemate == 0 || modelo.BaseRemate == null) {
            $container.find("small[for='BaseRemate']").text("* El campo es requerido");
            validate = false;
        }

        if (typeof modelo.FecUltAvaluo === 'undefined' || modelo.FecUltAvaluo === '0001-01-01T00:00:00.000') {
            $container.find("small[for='FecUltAvaluo']").text("* El campo es requerido");
            validate = false;
        }

        if (typeof modelo.MontoAvaluo === 'undefined' || modelo.MontoAvaluo == 0 || modelo.MontoAvaluo == null) {
            $container.find("small[for='MontoAvaluo']").text("* El campo es requerido");
            validate = false;
        }

        //if (typeof modelo.MontoAvaluo80Porciento === 'undefined' || modelo.MontoAvaluo80Porciento == 0 || modelo.MontoAvaluo80Porciento == null) {
        //    $container.find("small[for='MontoAvaluo80Porciento']").text("* El campo es requerido");
        //    validate = false;
        //}

        if (typeof modelo.ChequeGerencia === 'undefined' || modelo.ChequeGerencia == null) {
            $container.find("small[for='ChequeGerencia']").first().text("* El campo es requerido");
            validate = false;
        }

        if (typeof modelo.MontoLiquidacion === 'undefined' || modelo.MontoLiquidacion == 0 || modelo.MontoLiquidacion == null) {
            $container.find("small[for='MontoLiquidacion']").text("* El campo es requerido");
            validate = false;
        }

        if (typeof modelo.FirmaGestorCobro === 'undefined' || modelo.FirmaGestorCobro === null) {
            $container.find("small[for='FirmaGestorCobro']").text("* El campo es requerido");
            validate = false;
        }

        if (typeof modelo.FirmaAreaCobro === 'undefined' || modelo.FirmaAreaCobro === null) {
            $container.find("small[for='FirmaAreaCobro']").text("* El campo es requerido");
            validate = false;
        }

        if (!validate) return false;

        $.ajax({
            url: "@Url.Action("AgregarInstruccionesRemate", "TramiteDetalle")",
            type: "POST",
            contentType: 'application/json; charset=utf-8',
            data: JSON.stringify(modelo),
            success: function (result) {
                $("#InstruccionesRemateAgregarModal").modal("hide");
                Alerta('Guardar Instrucciones Remate', "Registro guardado con éxito", 'success');
                $("body").trigger("actualizarComponents");
            },
            error: function (jqXHR, status, error) {
                Alerta('Actualizar Instrucciones Remate', jqXHR.responseText, 'danger');
            }
        });
    }

    function actualizarInstruccionesRemate()
    {
        var id = $(this).attr("IdInstruccionesRemate");
        var idExpediente = $(this).attr("IdExpedienteJudicial");
        var tramiteCobro = $(this).attr("TramiteCobro");
        var numOperacion = $(this).attr("NumOperacion");
        var contenedorInstruccionesRemate = $("div[divInstruccionesRemate]"),
            registrosInstruccionesRemate = [],
            msgsError,
            controlesInstruccionesRemate;

        contenedorInstruccionesRemate.each(function (index, element) {
            id = $(element).attr("IdInstruccionesRemate");
            controlesInstruccionesRemate = $(this).find(".controlInstruccionesRemateDetalle");


            //alert("idInstruccionesRemate: " + id);
            //alert("idExpedienteJudicial: " + idExpediente);
            //alert("tramiteCobro: " + tramiteCobro);
            //alert("numOperacion: " + numOperacion);

            msgsError = "";

            var idIndicacionPerito, indInteresPrescritos, fechaDesde, fechaHasta, fechaAdjudicar, numOficio, numGarantia, fecRemate, horaRemate, baseRemate,
                fecUltAvaluo, montoAvaluo, montoAvaluo80Porciento, montoCheque, chequeGerencia, montoLiquidacion, firmaGestorCobro, firmaAreaCobro;

            controlesInstruccionesRemate.each(function () {

                if (this.id.includes("txtIdIndicacionPerito")) {
                    if (this.value != 0) {
                        idIndicacionPerito = this.value;
                    } else {
                        msgsError += "\nEl campo indicacion perito no es válido.";
                    }
                }

                if (this.id.includes("txtIndInteresPrescritos")) {
                    indInteresPrescritos = $("input:radio[name='remate.IndInteresPrescritos']:checked").val();

                    if (indInteresPrescritos == 'True') {
                        var valFechaDesde = $("#txtFechaDesde").val();
                        var valFechahasta = $("#txtFechaHasta").val();


                        if (valFechaDesde.length !== 0 && !moment(valFechaDesde, "DD/MM/YYYY", true).isValid()) {
                                msgsError += "\nEl campo fecha desde no es válido.";
                        } else if (valFechaDesde.length === 0) {
                                msgsError += "\nEl campo fecha desde no es válido.";
                            }
                        else fechaDesde = moment(valFechaDesde, 'DD-MM-YYYY').format('YYYY-MM-DD');


                        if (valFechahasta.length !== 0 && !moment(valFechahasta, "DD/MM/YYYY", true).isValid()) {
                                msgsError += "\nEl campo fecha hasta no es válido.";
                        } else if (valFechahasta.length === 0) {
                                msgsError += "\nEl campo fecha hasta no es válido.";
                            }
                        else fechaHasta = moment(valFechahasta, 'DD-MM-YYYY').format('YYYY-MM-DD');

                    }
                }

                if (this.id.includes("txtFechaAdjudicar")) {
                    if (this.value.length != 0 && !moment(this.value, "DD/MM/YYYY", true).isValid()) {
                        msgsError += "\nEl campo fecha adjudicar no es válido.";
                    } else if (this.value.length == 0) {
                        msgsError += "\nEl campo fecha adjudicar no es válido.";
                    }
                    else fechaAdjudicar = moment(this.value, 'DD-MM-YYYY').format('YYYY-MM-DD');
                }

                if (this.id.includes("txtNumOficio")) {

                    if (this.value != 0) {
                        numOficio = this.value;
                    } else {
                        msgsError += "\nEl campo número de oficio no es válido.";
                    }
                }

                if (this.id.includes("txtNumGarantia")) {

                    if (this.value != 0) {
                        numGarantia = this.value;
                    } else {
                        msgsError += "\nEl campo número de garantía no es válido.";
                    }
                }

                if (this.id.includes("txtFecRemate")) {
                    if (this.value.length != 0 && !moment(this.value, "DD/MM/YYYY", true).isValid()) {
                        msgsError += "\nEl campo fecha liquidación no es válido.";
                    } else if (this.value.length == 0) {
                        msgsError += "\nEl campo fecha liquidación no es válido.";
                    }
                    else fecRemate = moment(this.value, 'DD-MM-YYYY').format('YYYY-MM-DD');
                }

                //if (this.id.includes("txtHoraRemate")) {
                //    if (this.value.length != 0 && !moment(this.value, "HH:mm:ss", true).isValid()) {
                //        msgsError += "\nEl campo hora remate no es válido.";
                //    } else if (this.value.length == 0) {
                //        msgsError += "\nEl campo hora remate no es válido.";
                //    }
                //    else horaRemate = moment(this.value, "HH:mm:ss").format("HH:mm:ss");
                //}

                if (this.id.includes("txtHoraRemate")) {
                    if (this.value.length != 0) {
                        /*msgsError += "\nEl campo hora remate no es válido.";*/
                        horaRemate = this.value;
                    } else if (this.value.length == 0) {
                        msgsError += "\nEl campo hora remate no es válido.";
                    }
                    else horaRemate = moment(this.value, "HH:mm:ss").format("HH:mm:ss");
                }
                //moment().format('HH:mm:ss')
                //if (this.id.includes("txtHoraRemate")) {
                //    horaRemate = this.value;
                //}

                if (this.id.includes("txtBaseRemate")) {

                    if (this.value != 0) {
                        baseRemate = this.value;
                    } else {
                        msgsError += "\nEl campo base remate no es válido.";
                    }
                }

                if (this.id.includes("txtFecUltAvaluo")) {
                    if (this.value.length != 0 && !moment(this.value, "DD/MM/YYYY", true).isValid()) {
                        msgsError += "\nEl campo fecha último avalúo no es válido.";
                    } else if (this.value.length == 0) {
                        msgsError += "\nEl campo fecha último avalúo no es válido.";
                    }
                    else fecUltAvaluo = moment(this.value, 'DD-MM-YYYY').format('YYYY-MM-DD');
                }

                if (this.id.includes("txtMontoAvaluo")) {

                    if (this.value != 0) {
                        montoAvaluo = this.value;
                    } else {
                        msgsError += "\nEl campo monto avalúo no es válido.";
                    }
                }

                if (this.id.includes("txtChequeGerencia")) {

                    chequeGerencia = $("input:radio[name='remate.ChequeGerencia']:checked").val();
                }

                if (this.id.includes("txtMontoLiquidacion")) {

                    if (this.value != 0) {
                        montoLiquidacion = this.value;
                    } else {
                        msgsError += "\nEl campo monto liquidación no es válido.";
                    }
                }

                if (this.id.includes("txtFirmaGestorCobro")) {

                    if (this.value != 'undefined' || this.value != null) {
                        firmaGestorCobro = this.value;
                    } else {
                        msgsError += "\nEl campo firma gestor cobro no es válido.";
                    }
                }

                if (this.id.includes("txtFirmaAreaCobro")) {

                    if (this.value != 'undefined' || this.value != null) {
                        firmaAreaCobro = this.value;
                    } else {
                        msgsError += "\nEl campo firma área cobro no es válido.";
                    }
                }

            });

            if (msgsError != "") {
                return false;
            }

            //alert("Error msj:" +msgsError)

            var detalleInstruccionesRemate = {
                IdInstruccionesRemate: id,
                NumOperacion: numOperacion,
                IdExpedienteJudicial: idExpediente,
                TramiteCobro: tramiteCobro,
                IdIndicacionPerito: idIndicacionPerito,
                IndInteresPrescritos: indInteresPrescritos,
                FechaDesde: fechaDesde,
                FechaHasta: fechaHasta,
                FechaAdjudicar: fechaAdjudicar,
                NumOficio: numOficio,
                FecRemate: fecRemate,
                HoraRemate: horaRemate,
                BaseRemate: baseRemate,
                NumGarantia: numGarantia,
                FecUltAvaluo: fecUltAvaluo,
                MontoAvaluo: montoAvaluo,
                MontoAvaluo80Porciento: montoAvaluo80Porciento,
                MontoCheque: montoCheque,
                ChequeGerencia: chequeGerencia,
                MontoLiquidacion: montoLiquidacion,
                FirmaGestorCobro: firmaGestorCobro,
                FirmaAreaCobro: firmaAreaCobro
            }

            registrosInstruccionesRemate.push(detalleInstruccionesRemate);

        });

        if (msgsError != "") {
            Alerta("Actualizar Instrucciones Remate", msgsError, "danger");
            return false;
        }

        $.ajax({
            url: "@Url.Action("GuardarInstruccionesRemate", "TramiteDetalle")",
            type: "POST",
            contentType: 'application/json; charset=utf-8',
            data: JSON.stringify(registrosInstruccionesRemate),
            success: function (mensaje) {
                Alerta('Actualizar Instrucciones Remate', mensaje, 'success');
                $("body").trigger("actualizarComponents");
            },
            error: function (jqXHR, status, error) {
                Alerta('Actualizar Instrucciones Remate', jqXHR.responseText, 'danger');
            }
        });
    }

    function calcularMontoAvaluoPorcentual() {

        var MontoAvaluo = $("#txtMontoAvaluoAgregar").val();

        var Procentaje80 = 0.80;
        var MontoAvaluo80Porciento = (MontoAvaluo * Procentaje80);

        document.getElementById("txtMontoAvaluo80PorcientoAgregar").value = MontoAvaluo80Porciento;
    }

    function habilitarCamposInteresPrescritos() {
        //var indInteresPrescritos = $("#txtIndInteresPrescritos").val();
        var indInteresPrescritos = $("input:radio[name='IndInteresPrescritos']:checked").val()

        //$('#CodigoAbogadoActualizarModal').find("small[for]").text("");
        //alert(indInteresPrescritos);

        if (indInteresPrescritos == 'True') {
            $('#myDivFechaDesdeAgregar').show();
            $('#myDivFechaHastaAgregar').show();

        } else {
            $('#myDivFechaDesdeAgregar').hide();
            $('#myDivFechaHastaAgregar').hide();

            $("#txtFechaDesdeAgregar").val('');
            $("#txtFechaHastaAgregar").val('');
        }
    }

    function habilitarCamposInteresPrescritosDiv() {
        var indInteresPrescritosDiv = $("input:radio[name='remate.IndInteresPrescritos']:checked").val()

        if (indInteresPrescritosDiv == 'True') {
            $('#myDivFechaDesde').show();
            $('#myDivFechaHasta').show();

        } else {
            $('#myDivFechaDesde').hide();
            $('#myDivFechaHasta').hide();

            $("#txtFechaDesde").val('');
            $("#txtFechaHasta").val('');
        }
    }

    function validarExpediente() {
        $("#val-expediente-modal").find(".info-container").html('');
        $("#val-expediente-modal").find(".progressbar-container").show();
        $("#val-expediente-modal").modal("show");
        var modelo = $("#ExpedienteModel").getModel();
        var idExpediente = $(this).attr("IdExpediente");
        var numOperacion = $("#txtNumOperacionGeneral").val();
        var idTramite = modelo.IdTramiteJudicial;

        let link = '@Url.Action("ModalValidarExp", "ValidarExpediente", new { pIdExpediente = "p_IdExpediente", pNumOperacion = "p_NumOperacion", pIdTramite = "p_IdTramite" })';
        link = link.replace("p_IdExpediente", idExpediente);
        link = link.replace("p_NumOperacion", numOperacion);
        link = link.replace("p_IdTramite", idTramite);
        link = link.replace("&amp;", "&");
        link = link.replace("&amp;", "&");

        $("#val-expediente-modal").find(".info-container").load(link, function () {
            $("#val-expediente-modal").find(".progressbar-container").hide();
            $("#val-expediente-modal").find(".selectpicker").selectpicker('render');
            $("#val-expediente-modal").customdatepicker();
            $("#val-expediente-modal").custominputs("refresh");
            $("#val-expediente-modal").find("[data-set-focus]").focus();
        });
	}

    function adjuntarInstruccionRemateFirmada() {
        $("#adj-instruccionremate-modal").find(".info-container").html('');
        $("#adj-instruccionremate-modal").find(".progressbar-container").show();
        $("#adj-instruccionremate-modal").modal("show");
        var modelo = $("#ExpedienteModel").getModel();
        var idExpediente = $(this).attr("IdExpedienteJudicial");
        var numOperacion = $(this).attr("NumOperacion");//$("#txtNumOperacionGeneral").val();
        var idTramite = $(this).attr("TramiteCobro");
        var idInstruccionesRemate = $(this).attr("InstruccionesRemateId");//$("#IdInstruccionesRemate").val();

        @*IdInstruccionesRemate="@remate.IdInstruccionesRemate"
        IdExpedienteJudicial = "@expedienteRegistrado.IdExpediente"
        TramiteCobro = "@expedienteRegistrado.IdTramiteCobroJudicial"
        NumOperacion = "@expedienteRegistrado.NumOperacion"*@

        //var idTramite = modelo.IdTramiteJudicial;

        let link = '@Url.Action("ModalAdjuntarInstruccionRemateFirmada", "CargaInstruccionRemateFirmada",
                   new
                   {
                       pIdExpediente = "p_IdExpediente",
                       pNumOperacion = "p_NumOperacion",
                       pIdTramite = "p_IdTramite",
                       pIdInstruccionesRemate = "p_IdInstruccionesRemate"
                   })';
        link = link.replace("p_IdExpediente", idExpediente);
        link = link.replace("p_NumOperacion", numOperacion);
        link = link.replace("p_IdTramite", idTramite);
        link = link.replace("p_IdInstruccionesRemate", idInstruccionesRemate);
        link = link.replace("&amp;", "&");
        link = link.replace("&amp;", "&");
        link = link.replace("&amp;", "&");

        $("#adj-instruccionremate-modal").find(".info-container").load(link, function () {
            $("#adj-instruccionremate-modal").find(".progressbar-container").hide();
            $("#adj-instruccionremate-modal").find(".selectpicker").selectpicker('render');
            $("#adj-instruccionremate-modal").customdatepicker();
            $("#adj-instruccionremate-modal").custominputs("refresh");
            $("#adj-instruccionremate-modal").find("[data-set-focus]").focus();
        });
    }

    $("button[btnValidarDocuEtapa1]").on("click", function () {

        $("#ValidarDocuEtapa1").find(".info-container").html('');
        $("#ValidarDocuEtapa1").find(".progressbar-container").show();
        $("#ValidarDocuEtapa1").modal("show");

        const numOperacion = $(this).attr("NumOperacion");
        const IdExpediente = $(this).attr("IdExpediente");
        const IdTramiteCobro = $(this).attr("IdTramiteCobro");

        let link = '@Url.Action("ConsultarVista", "ValidarDocuTramiteCJ",
                   new { pNumOperacion = "p_NumOperacion", pIdExpediente = "p_IdExpediente", pIdTramiteCobro = "p_IdTramiteCobro" })';
        link = link.replace("p_IdExpediente", IdExpediente);
        link = link.replace("p_NumOperacion", numOperacion);
        link = link.replace("p_IdTramiteCobro", IdTramiteCobro);
        link = link.replace("amp;", "");
        link = link.replace("amp;", "");

        $("#ValidarDocuEtapa1").find(".info-container").load(link, function () {

            $("#ValidarDocuEtapa1").find(".progressbar-container").hide();
            $("#ValidarDocuEtapa1").find(".selectpicker").selectpicker('render');
            $("#ValidarDocuEtapa1").customdatepicker();
            $("#ValidarDocuEtapa1").custominputs("refresh");
            $("#ValidarDocuEtapa1").find("[data-set-focus]").focus();
            });

        });


   $("button[btnValidarDocuEtapa2]").on("click", function () {

        $("#ValidarDocuEtapa2").find(".info-container").html('');
        $("#ValidarDocuEtapa2").find(".progressbar-container").show();
        $("#ValidarDocuEtapa2").modal("show");

        const numOperacion = $(this).attr("NumOperacion");
       const IdExpediente = $(this).attr("IdExpediente");

        let link = '@Url.Action("ConsultarVista", "ValidarDocumentacion", new { pNumOperacion = "p_NumOperacion", pIdExpediente = "p_IdExpediente" })';
       link = link.replace("p_IdExpediente", IdExpediente);
       link = link.replace("p_NumOperacion", numOperacion);
       link = link.replace("amp;", "");

        $("#ValidarDocuEtapa2").find(".info-container").load(link, function () {

            $("#ValidarDocuEtapa2").find(".progressbar-container").hide();
            $("#ValidarDocuEtapa2").find(".selectpicker").selectpicker('render');
            $("#ValidarDocuEtapa2").customdatepicker();
            $("#ValidarDocuEtapa2").custominputs("refresh");
            $("#ValidarDocuEtapa2").find("[data-set-focus]").focus();
		});

   });

    function generarInstruccionesRemate() {
        var id = $("input[name=IdInstruccionesRemate]").val();
        if (id !== undefined && id !== null) {
			var link = '@Url.Action("GenerarInstruccionesRemate", "InstruccionesRemate", new { pId = "p_Id" })';
            link = link.replace("p_Id", id);

			window.open(link, "_blank");
		}
    }

    function agregarCalcLiquidacion() {
        var idExpedienteJudicial = $(this).attr("IdExpedienteJudicial");
        var tramiteCobro = $(this).attr("TramiteCobro");
        var numOperacion = $(this).attr("NumOperacion");
        var remate = $(this).attr("Remate");

        $("#calculo-liquidacion-modal").find(".info-container").html('');
        $("#calculo-liquidacion-modal").find(".progressbar-container").show();
        $("#calculo-liquidacion-modal").modal("show");

        let link = '@Url.Action("DetalleRegistro", "CalculoLiquidacionRemate", new { pIdExpediente = "p_IdExpediente", pNumOperacion = "p_NumOperacion", pIdTramite = "p_IdTramite", pRemate = "p_Remate" })';
        link = link.replace("p_IdExpediente", idExpedienteJudicial);
        link = link.replace("p_NumOperacion", numOperacion);
        link = link.replace("p_IdTramite", tramiteCobro);
        link = link.replace("p_Remate", remate);
        link = link.replace("&amp;", "&");
        link = link.replace("&amp;", "&");
        link = link.replace("&amp;", "&");

        $("#calculo-liquidacion-modal").find(".info-container").load(link, function () {
            $("#calculo-liquidacion-modal").find(".progressbar-container").hide();
            $("#calculo-liquidacion-modal").find(".selectpicker").selectpicker('render');
            $("#calculo-liquidacion-modal").customdatepicker();
            $("#calculo-liquidacion-modal").custominputs("refresh");
            $("#calculo-liquidacion-modal").find("[data-set-focus]").focus();
        });
    }

    function ExpedienteGarantia(p_Id, p_IdExpediente, p_NumOperacion) {
        ExpedienteGarantia.prototype.Init = function () {
            ConsultarExpedienteGarantia(p_Id, p_IdExpediente, p_NumOperacion);
        }

        this.Init();
    }

    function ConsultarExpedienteGarantia(p_Id, pIdExpediente, p_NumOperacion) {

		var link = '@Url.Action("DetalleExpedienteGarantia", "Rel_ExpedienteGarantia",
                   new
                   {
                       p_IdExpediente = "pIdExpediente",
                       p_NumOperacion = "pNumOperacion"
                   })';
        link = link.replace("pIdExpediente", pIdExpediente);
        link = link.replace("pNumOperacion", p_NumOperacion);
        link = link.replace("&amp;", "&");

        $(p_Id).find("#exp-grnt-info-container-" + pIdExpediente).load(link, function () { });
    }

    function validarAsgCodAbogado() {
        $("#val-asg-cod-abog-modal").find(".info-container").html('');
        $("#val-asg-cod-abog-modal").find(".progressbar-container").show();
        $("#val-asg-cod-abog-modal").modal("show");
        var idExpediente = $(this).attr("IdExpediente");
        var numOperacion = $(this).attr("NumOperacion");
        var idTramite = $(this).attr("TramiteCobro");

        let link = '@Url.Action("DetalleValAsigAbogado", "AsignacionCodAbogado", new { pIdExpediente = "p_IdExpediente", pNumOperacion = "p_NumOperacion", pIdTramite = "p_IdTramite" })';
        link = link.replace("p_IdExpediente", idExpediente);
        link = link.replace("p_NumOperacion", numOperacion);
        link = link.replace("p_IdTramite", idTramite);
        link = link.replace("&amp;", "&");
        link = link.replace("&amp;", "&");
        link = link.replace("&amp;", "&");

        $("#val-asg-cod-abog-modal").find(".info-container").load(link, function () {
            $("#val-asg-cod-abog-modal").find(".progressbar-container").hide();
            $("#val-asg-cod-abog-modal").find(".selectpicker").selectpicker('render');
            $("#val-asg-cod-abog-modal").customdatepicker();
            $("#val-asg-cod-abog-modal").custominputs("refresh");
            $("#val-asg-cod-abog-modal").find("[data-set-focus]").focus();
        });
    }

    function mostrarCaratulaBienesAdj() {
        $("#caratula-bienes-adj-modal").find(".info-container").html('');
        $("#caratula-bienes-adj-modal").find(".progressbar-container").show();
        $("#caratula-bienes-adj-modal").modal("show");
        var idExpediente = $(this).attr("IdExpediente");
        var numOperacion = $(this).attr("NumOperacion");
        var idTramite = $(this).attr("TramiteCobro");

        let link = '@Url.Action("DetalleRegistro", "CaratulaBienesAdjudicados", new { pIdExpediente = "p_IdExpediente", pNumOperacion = "p_NumOperacion", pIdTramite = "p_IdTramite" })';
        link = link.replace("p_IdExpediente", idExpediente);
        link = link.replace("p_NumOperacion", numOperacion);
        link = link.replace("p_IdTramite", idTramite);
        link = link.replace("&amp;", "&");
        link = link.replace("&amp;", "&");
        link = link.replace("&amp;", "&");

        $("#caratula-bienes-adj-modal").find(".info-container").load(link, function () {
            $("#caratula-bienes-adj-modal").find(".progressbar-container").hide();
            $("#caratula-bienes-adj-modal").find(".selectpicker").selectpicker('render');
            $("#caratula-bienes-adj-modal").customdatepicker();
            $("#caratula-bienes-adj-modal").custominputs("refresh");
            $("#caratula-bienes-adj-modal").find("[data-set-focus]").focus();
        });
    }


    $('.lnkOpciones').click(function (event) {
        event.preventDefault();
        $(this).parent().parent().find('.active').removeClass('active');
        $(this).addClass('active');
        var element = $(this);

        $('.panelExp').fadeOut('fast', function () {
            $('#' + element.data('showtab')).fadeIn();
        })
    })


    /******* Calculadora **********/

    //function CalcularDiasInteresCorriente() {
    $(document).on('change', '.CalcularDiasInteresCorriente', function () {
        var idexpediente = $(this).data('idexpediente');

        var modelo = $("#calcint" + idexpediente).getModel(),
            $container = $("#calcint" + idexpediente),
            validateCorriente = true;

        if (!moment($(".txtFechaUltimoPagoCalculadora" + idexpediente).val(), "DD/MM/YYYY", true).isValid()) {
            console.log('* El campo fecha último pago no es válido', ' FechaUltimoPago');
            var PropertyName = "FechaUltimoPago";
            var Message = "* El campo fecha último pago no es válido";
            var $element = $container.find("small[for='_calculadora." + PropertyName + "']");
            if ($element !== undefined) {
                $element.text(Message);
            }
            validateCorriente = false;

            if (!validateCorriente) return false;
        }
        else if (!moment($(".txtFechaCorteInteresCorrienteCalculadora" + idexpediente).val(), "DD/MM/YYYY", true).isValid()) {
            console.log('* El campo fecha corte interés corriente no es válido"', ' FechaCorteInteresCorriente');
            var PropertyName = "FechaCorteInteresCorriente";
            var Message = "* El campo fecha corte interés corriente no es válido";
            var $element = $container.find("small[for='_calculadora." + PropertyName + "']");
            if ($element !== undefined) {
                $element.text(Message);
            }
            validateCorriente = false;

            if (!validateCorriente) return false;
        }
        else {
            console.log($(".txtFechaUltimoPagoCalculadora" + idexpediente).val(), ' FechaUltimoPago');
            var PropertyName = "FechaUltimoPago";
            var Message = "";
            try {
                var $element = $container.find("small[for='_calculadora." + PropertyName + "']");
                if ($element !== undefined) {
                    $element.text(Message);
                }
            } catch (e) {}


            console.log($(".txtFechaCorteInteresCorrienteCalculadora" + idexpediente).val(), ' FechaCorteInteresCorriente');
            var PropertyName2 = "FechaCorteInteresCorriente";
            var Message2 = "";
            try {
                var $element2 = $container.find("small[for='_calculadora." + PropertyName2 + "']");
                if ($element2 !== undefined) {
                    $element2.text(Message2);
                }
            } catch (e) { }

            validateCorriente = true;

            //Formula: --> DiasInteresCorriente = (FechaUltimoPago - FechaCorteInteresCorriente) + 1 dia
            //Explicación: -->  Se saca la diferencia de dias entre las fechas y se le suma un dia adicional
            var fechaUltimoPago = moment($(".txtFechaUltimoPagoCalculadora" + idexpediente).val(), 'DD/MM/YYYY');
            var fechaCorteInteresCorriente = moment($(".txtFechaCorteInteresCorrienteCalculadora" + idexpediente).val(), 'DD/MM/YYYY');

            var diasDiferencia = fechaCorteInteresCorriente.diff(fechaUltimoPago, 'days');
            console.log(diasDiferencia, ' dias de diferencia');

            if (!isNaN(diasDiferencia + 1)) {
                $(".DiasInteresCorrienteCalculadora" + idexpediente).val(diasDiferencia + 1);
            }
            else {
                $(".DiasInteresCorrienteCalculadora" + idexpediente).val('');
            }

            $('.CalcularMontoInteresCorriente' + idexpediente).change();

            CalcularTotalDiasCorrienteMora(idexpediente);

            RecalcularFechaCorteInteresMoraDemanda(idexpediente);

            CalcularDiasInteresMoraDemanda(idexpediente);

            $('.TasaInteresCorrienteCalculadora' + idexpediente).change();

        }
    })


    $(document).on('change', '.CalcularMontoInteresCorriente', function () {
    //function CalcularMontoInteresCorriente() {
        var idexpediente = $(this).data('idexpediente');

        var modelo = $("#calcint" + idexpediente).getModel(),
            $container = $("#calcint" + idexpediente),
            validate = true;

        if (modelo.TasaInteresCorriente > 100) {

            $container.find("small[for='TasaInteresCorriente']").text("* El campo no puede ser superior a 100");
            validate = false;

            if (!validate) return false;
        }
        else {

            $container.find("small[for='_calculadora.TasaInteresCorriente']").text("");
            validate = true;

            //Formula: --> MontoInteresCorriente = MontoCapital * TasaInteresCorriente / 365 * DiasInteresCorriente
            var montoCapital = parseFloat($(".MontoCapitalCalculadora" + idexpediente).val().replace(/,/g, ''));//parseFloat($("#MontoCapital").val());
            var tasaInteresCorriente = parseFloat($(".TasaInteresCorrienteCalculadora" + idexpediente).val());
            var periocidad = 365;
            var diasInteresCorriente = parseInt($(".DiasInteresCorrienteCalculadora" + idexpediente).val());
            var montoInteresCorriente = 0;

            if (isNaN(montoCapital)) {
                montoCapital = 0;
            }
            if (isNaN(tasaInteresCorriente)) {
                tasaInteresCorriente = 0;
            }
            if (isNaN(diasInteresCorriente)) {
                diasInteresCorriente = 0;
            }
            montoInteresCorriente = (montoCapital * ((tasaInteresCorriente / 100) / periocidad) * diasInteresCorriente);//((montoCapital * (tasaInteresCorriente/100)) / periocidad * diasInteresCorriente);
            console.log(typeof montoCapital, montoCapital, 'montoCapital');
            console.log(typeof tasaInteresCorriente, tasaInteresCorriente, 'tasaInteresCorriente');
            console.log(typeof periocidad, periocidad, 'periocidad');
            console.log(typeof diasInteresCorriente, diasInteresCorriente, 'diasInteresCorriente');
            console.log(typeof montoInteresCorriente, montoInteresCorriente, 'montoInteresCorriente');

            if (!isNaN(montoInteresCorriente)) {
                $(".MontoInteresCorrienteCalculadora" + idexpediente).val(parseFloat(formatNumber(montoInteresCorriente)));//.toFixed(2);
            }
            else {
                $(".MontoInteresCorrienteCalculadora" + idexpediente).val('');
            }

            CalcularMontoTotalInteres(idexpediente);
        }
    })

    function CalcularMontoTotalInteres(idexpediente) {

        //Formula: --> MontoTotalInteres = DiasInteresCorriente -  DiasInteresMora

        var montoInteresCorriente = parseFloat($(".MontoInteresCorrienteCalculadora" + idexpediente).val());
        var montoInteresMora = parseFloat($(".MontoInteresMoraCalculadora" + idexpediente).val());
        var montoTotalInteres = 0;

        if (isNaN(montoInteresCorriente)) {
            montoInteresCorriente = 0;
        }
        if (isNaN(montoInteresMora)) {
            montoInteresMora = 0;
        }

        montoTotalInteres = montoInteresCorriente + montoInteresMora;

        console.log('TOTALIZAR');
        console.log(typeof montoInteresCorriente, montoInteresCorriente, 'montoInteresCorriente');
        console.log(typeof montoInteresMora, montoInteresMora, 'montoInteresMora');
        console.log(typeof montoTotalInteres, montoTotalInteres, 'montoTotalInteres');

        var saldoTotal = 0;
        if ($('.MontoCapitalCalculadora' + idexpediente).val() != '') {
            saldoTotal = parseFloat($('.MontoCapitalCalculadora' + idexpediente).val().replace(/,/g, ""));
        }

        if (!isNaN(montoTotalInteres)) {
            document.getElementById("MontoTotalInteresCalculadora").value = montoTotalInteres.toFixed(2);
            $('#MontoCuantiCalculadora').val((montoTotalInteres + saldoTotal).toFixed(2));
        }
        else {
            document.getElementById("MontoTotalInteresCalculadora").value = '';
            $('#MontoCuantiCalculadora').val("0.00");
        }
    }

    function CalcularTotalDiasCorrienteMora(idexpediente) {

        //Formula: --> DiferenciaDiasCorrienteMora = DiasInteresCorriente -  DiasInteresMora
        var diasInteresCorriente = parseInt($(".DiasInteresCorrienteCalculadora" + idexpediente).val());
        var diasInteresMora = parseInt($(".DiasInteresMoraCalculadora" + idexpediente).val());
        var diferenciaDiasCorrienteMora = 0;

        if (isNaN(diasInteresCorriente)) {
            diasInteresCorriente = 0;
        }
        if (isNaN(diasInteresMora)) {
            diasInteresMora = 0;
        }

        diferenciaDiasCorrienteMora = diasInteresCorriente + diasInteresMora;

        if (!isNaN(diferenciaDiasCorrienteMora)) {
            $(".DiasInteresDiferenciaCorrienteMoraCalculadora" + idexpediente).val(diferenciaDiasCorrienteMora);
        }
        else {
            $(".DiasInteresDiferenciaCorrienteMoraCalculadora" + idexpediente).val('');
        }
    }

    function RecalcularFechaCorteInteresMoraDemanda(idexpediente) {

        var today = moment($(".txtFechaCorteInteresCorrienteCalculadora" + idexpediente).val(), 'DD/MM/YYYY');
        var tomorrow = moment(today).add(1, 'days');
        console.log(tomorrow, ' tomorrow');

        if (!isNaN(tomorrow)) {
            $(".txtFechaCorteInteresMoraCalculadora" + idexpediente).val(moment(tomorrow, 'DD-MM-YYYY').format('DD/MM/YYYY'));
        }
        else {
            $(".txtFechaCorteInteresMoraCalculadora" + idexpediente).val('');
        }
    }

    $('.txtFechaLiquidacionDemandaCalculadora').change(function () {
        var idexpediente = $(this).data('idexpediente');
        CalcularDiasInteresMoraLiquidacion(idexpediente);

    });

    function CalcularDiasInteresMoraDemanda(idexpediente) {

        var modelo = $("#calcint" + idexpediente).getModel(),
            $container = $("#calcint" + idexpediente),
            validateMora = true;

        var PropertyName = "FechaCorteInteresMora";
        var Message = "";
        var $element = $container.find("small[for='_calculadora." + PropertyName + "']");
        if ($element !== undefined) {
            $element.text(Message);
        }

        var PropertyName2 = "FechaLiquidacionDemanda";
        var Message2 = "";
        var $element2 = $container.find("small[for='_calculadora." + PropertyName2 + "']");
        if ($element2 !== undefined) {
            $element2.text(Message2);
        }


        if (!moment($(".txtFechaCorteInteresMoraCalculadora" + idexpediente).val(), "DD/MM/YYYY", true).isValid()) {

            var PropertyName = "FechaCorteInteresMora";
            var Message = "* El campo fecha hasta no es válido";
            var $element = $container.find("small[for='_calculadora." + PropertyName + "']");
            if ($element !== undefined) {
                $element.text(Message);
            }

            validateMora = false;

            if (!validateMora) return false;
        }
        else if (!moment($(".txtFechaLiquidacionDemandaCalculadora" + idexpediente).val(), "DD/MM/YYYY", true).isValid()) {

            var PropertyName2 = "FechaLiquidacionDemanda";
            var Message = "* El campo fecha liquidación demanda no es válido";
            var $element = $container.find("small[for='_calculadora." + PropertyName2 + "']");
            if ($element !== undefined) {
                $element.text(Message);
            }
            validateMora = false;

            if (!validateMora) return false;
        }
        else {



            validateMora = true;

            //Formula: --> DiasInteresMora = (FechaCorteInteresMora - FechaLiquidacionDemanda) + 1 dia
            //Explicación: -->  Se saca la diferencia de dias entre las fechas y se le suma un dia adicional
            var fechaCorteInteresMora = moment($(".txtFechaCorteInteresMoraCalculadora" + idexpediente).val(), 'DD/MM/YYYY');
            console.log(fechaCorteInteresMora, ' fechaCorteInteresMora');
            var fechaLiquidacionDemanda = moment($(".txtFechaLiquidacionDemandaCalculadora" + idexpediente).val(), 'DD/MM/YYYY');
            console.log(fechaLiquidacionDemanda, ' fechaLiquidacionDemanda');

            var diasDiferencia = fechaLiquidacionDemanda.diff(fechaCorteInteresMora, 'days');
            console.log(diasDiferencia, ' dias de diferencia');

            if (!isNaN(diasDiferencia + 1)) {
                $(".DiasInteresMoraCalculadora" + idexpediente).value = diasDiferencia + 1;
            }
            else {
                $(".DiasInteresMoraCalculadora" + idexpediente).value = '';
            }

            $('#TasaInteresMoraCalculadora' + idexpediente).change();

            CalcularTotalDiasCorrienteMora(idexpediente);
        }
    }

    $(document).on('change', '.CalcularMontoInteresMoraDemanda', function() {

        var idexpediente = $(this).data('idexpediente');

        var $container = $("#calcint" + idexpediente);

        //Formula: --> MontoInteresCorriente = MontoCapital * TasaInteresCorriente / 365 * DiasInteresCorriente
        var montoCapital = parseFloat($(".MontoCapitalCalculadora" + idexpediente).val().replace(/,/g, ''));
        var tasaInteresMora = parseFloat($(".TasaInteresMoraCalculadora" + idexpediente).val());

        if (tasaInteresMora > 100) {

            $container.find("small[for='TasaInteresMora']").text("* El campo no puede ser superior a 100");
            validate = false;

            if (!validate) return false;
        } else {
            var periocidad = 365;
            var diasInteresMora = parseInt($(".DiasInteresMoraCalculadora" + idexpediente).val());
            var montoInteresMora = 0;

            if (isNaN(montoCapital)) {
                montoCapital = 0;
            }
            if (isNaN(tasaInteresMora)) {
                tasaInteresMora = 0;
            }
            if (isNaN(diasInteresMora)) {
                diasInteresMora = 0;
            }

            montoInteresMora = (montoCapital * ((tasaInteresMora / 100) / periocidad) * diasInteresMora);

            console.log(typeof montoCapital, montoCapital, 'montoCapital');
            console.log(typeof tasaInteresMora, tasaInteresMora, 'tasaInteresMora');
            console.log(typeof periocidad, periocidad, 'periocidad');
            console.log(typeof diasInteresMora, diasInteresMora, 'diasInteresMora');
            console.log(typeof montoInteresMora, montoInteresMora, 'montoInteresMora');

            if (!isNaN(montoInteresMora)) {
                $(".MontoInteresMoraCalculadora" + idexpediente).val(montoInteresMora.toFixed(2));
            }
            else {
                $(".MontoInteresMoraCalculadora" + idexpediente).val('');
            }

            CalcularMontoTotalInteres(idexpediente);
        }


    })


    function HabilitarOcultarCampos() {
        //Ocultar o Mostrar Campos en base al combo del tipo de calculadora

        /*var idTipoCalculadora = $("#cboIdTipoCalculadora").val();

        //Calculadora Demanda
        if (idTipoCalculadora == 1) {*/

            //Mostrar Campos Mora
            $('#myDivTasaInteresMora').show();
            $('#myDivFechaCorteInteresMora').show();
            $('#myDivDiasInteresMora').show();
            $('#myDivMontoInteresMora').show();

            //Mostrar Datos Demanda
            $('#myDivFechaLiquidacionDemanda').show();

            //Mostrar Campos Corriente
            $('#myDivTasaInteresCorriente').show();
            $('#myDivFechaCorteInteresCorriente').show();
            $('#myDivDiasInteresCorriente').show();
            $('#myDivMontoInteresCorriente').show();

            //Mostrar el Total de Dias (Corrientes + Mora)
            $('#myDivDiasInteresDiferenciaCorrienteMora').show();

            //Mostrar el Total de Interes (Corrientes + Mora)
            $('#myDivMontoTotalInteres').show();

            //Ocultar y Limpiar Datos de Liquidacion
            $('#myDivMontoHonorariosLiquidacion').hide();
            $("#MontoHonorariosLiquidacionCalculadora").val('');

            //Add ReadOnly
            $("#txtFechaUltimoPagoCalculadora").attr("readonly", true);
            $("#txtFechaCorteInteresMoraCalculadora").attr("readonly", true);

            //
            //RecalcularFechaCorteInteresMoraDemanda(); Pendiente validar
        /*}
        //Calculadora Liquidacion
        if (idTipoCalculadora == 2) {

            //Mostrar Campos Mora
            $('#myDivTasaInteresMora').show();
            $('#myDivFechaCorteInteresMora').show();
            $('#myDivDiasInteresMora').show();
            $('#myDivMontoInteresMora').show();

            //Ocultar y Limpiar Datos Demanda
            $('#myDivFechaLiquidacionDemanda').hide();
            $("#txtFechaLiquidacionDemandaCalculadora").val('');

            //Ocultar y Limpiar Campos Corriente
            $('#myDivTasaInteresCorriente').hide();
            $('#myDivFechaCorteInteresCorriente').hide();
            $('#myDivDiasInteresCorriente').hide();
            $('#myDivMontoInteresCorriente').hide();
            $("#TasaInteresCorrienteCalculadora").val('');
            $("#txtFechaCorteInteresCorrienteCalculadora").val('');
            $("#DiasInteresCorrienteCalculadora").val('');
            $("#MontoInteresCorrienteCalculadora").val('');

            //Ocultar y Limpiar el Total de Dias (Corrientes + Mora)
            $('#myDivDiasInteresDiferenciaCorrienteMora').hide();
            $("#DiasInteresDiferenciaCorrienteMoraCalculadora").val('');

            //Ocultar y Limpiar el Total de Intereses (Corrientes + Mora)
            $('#myDivMontoTotalInteres').hide();
            $('#MontoTotalInteresCalculadora').val('');

            //Mostrar Datos de Liquidacion
            $('#myDivMontoHonorariosLiquidacion').show();

            //Add ReadOnly
            $("#txtFechaUltimoPagoCalculadora").attr("readonly", false);
            $("#txtFechaCorteInteresMoraCalculadora").attr("readonly", false);

            //
            RecalcularFechaCorteInteresMoraLiquidacion();
        }*/
    }






    function RecalcularFechaCorteInteresMoraLiquidacion() {

        var today = moment($("#txtFechaUltimoPagoCalculadora").val(), 'DD/MM/YYYY');
        var tomorrow = moment(today).add(1, 'days');
        console.log(tomorrow, ' tomorrow');

        if (!isNaN(tomorrow)) {
            document.getElementById("txtFechaCorteInteresMoraCalculadora").value = moment(tomorrow, 'DD-MM-YYYY').format('DD/MM/YYYY');
        }
        else {
            document.getElementById("txtFechaCorteInteresMoraCalculadora").value = '';
        }
    }


    function CalcularDiasInteresMoraLiquidacion(idexpediente) {

        var modelo = $("#calcint" + idexpediente).getModel(),
            $container = $("#calcint" + idexpediente),
            validateMora = true;

        if (!moment($("#txtFechaUltimoPagoCalculadora").val(), "DD/MM/YYYY", true).isValid()) {

            var PropertyName = "FechaUltimoPago";
            var Message = "* El campo fecha último pago no es válido";
            var $element = $container.find("small[for='_calculadora." + PropertyName + "']");
            if ($element !== undefined) {
                $element.text(Message);
            }
            validateMora = false;

            if (!validateMora) return false;
        }
        else if (!moment($("#txtFechaCorteInteresMoraCalculadora").val(), "DD/MM/YYYY", true).isValid()) {

            var PropertyName = "FechaCorteInteresMora";
            var Message = "* El campo fecha hasta no es válido";
            var $element = $container.find("small[for='_calculadora." + PropertyName + "']");
            if ($element !== undefined) {
                $element.text(Message);
            }
            validateMora = false;

            if (!validateMora) return false;
        }
        else {

            var PropertyName = "FechaUltimoPago";
            var Message = "";
            var $element = $container.find("small[for='_calculadora." + PropertyName + "']");
            if ($element !== undefined) {
                $element.text(Message);
            }

            var PropertyName2 = "FechaCorteInteresMora";
            var Message2 = "";
            var $element2 = $container.find("small[for='_calculadora." + PropertyName2 + "']");
            if ($element2 !== undefined) {
                $element2.text(Message2);
            }

            validateMora = true;

            //Formula: --> DiasInteresMora = (FechaUltimoPago - FechaCorteInteresMora) + 1 dia
            //Explicación: -->  Se saca la diferencia de dias entre las fechas y se le suma un dia adicional

            var fechaUltimoPago = moment($(".txtFechaCorteInteresCorrienteCalculadora" + idexpediente).val(), 'DD/MM/YYYY');
            console.log(fechaUltimoPago, ' fechaUltimoPago');

            var Message2 = "";
            var $element2 = $container.find("small[for='_calculadora.FechaLiquidacionDemanda']");
            if ($element2 !== undefined) {
                $element2.text(Message2);
            }

            var fechaCorteInteresMora = moment($(".txtFechaLiquidacionDemandaCalculadora" + idexpediente).val(), 'DD/MM/YYYY');
            console.log(fechaCorteInteresMora, ' fechaCorteInteresMora');

            var diasDiferencia = fechaCorteInteresMora.diff(fechaUltimoPago, 'days');
            console.log(diasDiferencia, ' dias de diferencia');

            if (!isNaN(diasDiferencia)) {
                $(".DiasInteresMoraCalculadora" + idexpediente).val(diasDiferencia);
            }
            else {
                $(".DiasInteresMoraCalculadora" + idexpediente).val('');
            }

            CalcularMontoInteresMoraLiquidacion(idexpediente);

            CalcularTotalDiasCorrienteMora(idexpediente);
        }
    }


    function CalcularMontoInteresMoraLiquidacion(idexpediente) {

        //Formula: --> MontoInteresCorriente = MontoCapital * TasaInteresCorriente / 365 * DiasInteresCorriente
        var montoCapital = parseFloat($(".MontoCapitalCalculadora" + idexpediente).val().replace(/,/g, ''));
        var tasaInteresMora = parseFloat($(".TasaInteresMoraCalculadora" + idexpediente).val());
        var periocidad = 365;

        var diasInteresMora = parseInt($(".DiasInteresMoraCalculadora" + idexpediente).val());
        var montoInteresMora = 0;

        if (isNaN(montoCapital)) {
            montoCapital = 0;
        }
        if (isNaN(tasaInteresMora)) {
            tasaInteresMora = 0;
        }
        if (isNaN(diasInteresMora)) {
            diasInteresMora = 0;
        }

        montoInteresMora = (montoCapital * ((tasaInteresMora / 100) / periocidad) * diasInteresMora);

        console.log(typeof montoCapital, montoCapital, 'montoCapital');
        console.log(typeof tasaInteresMora, tasaInteresMora, 'tasaInteresMora');
        console.log(typeof periocidad, periocidad, 'periocidad');
        console.log(typeof diasInteresMora, diasInteresMora, 'diasInteresMora');
        console.log(typeof montoInteresMora, montoInteresMora, 'montoInteresMora');

        if (!isNaN(montoInteresMora)) {
            $(".MontoInteresMoraCalculadora" + idexpediente).val(montoInteresMora.toFixed(2));
        }
        else {
            $(".MontoInteresMoraCalculadora" + idexpediente).val('');
        }

        CalcularMontoTotalInteres(idexpediente);

        CalcularMontoHonorariosLiquidacion(idexpediente);
    }

    function CalcularMontoHonorariosLiquidacion(idexpediente) {

        //MontoHonorariosLiquidacion = MontoInteresMora * 10%
        var montoInteresMora = parseFloat($(".MontoInteresMoraCalculadora" + idexpediente).val());
        var porcentaje10 = 0.10;
        var montoHonorariosLiquidacion = 0;

        if (isNaN(montoInteresMora)) {
            montoInteresMora = 0;
        }

        montoHonorariosLiquidacion = (montoInteresMora * porcentaje10);

        if (!isNaN(montoHonorariosLiquidacion)) {
            $(".MontoHonorariosLiquidacionCalculadora" + idexpediente).val(montoHonorariosLiquidacion.toFixed(2));
        }
        else {
            $(".MontoHonorariosLiquidacionCalculadora" + idexpediente).val('');
        }
    }

    var formatNumber = function (num) {
        return parseFloat(num).toFixed(2).toLocaleString();
    };

    $('.MontoTotalInteresCalculadora, .MontoCapitalCalculadora').change(function () {
        var idexpediente = $(this).data('idexpediente');
        var capital = parseFloat($('.MontoCapitalCalculadora' + idexpediente).val());
        var intereses = parseFloat($('.MontoTotalInteresCalculadora' + idexpediente).val());

        $('.MontoCuantiCalculadora' + idexpediente).val((capital + intereses).toFixed(2).toLocaleString());
    })

    $(".btnActualizarCalculadora").on("click", async function () {
        var idexpediente = $(this).data('idexpediente');
        var contenedor = $("#calcint" + idexpediente);
        //debugger;
        if ($('.IdCalculadoraDemandaLiquidacion' + idexpediente).val() != null && $('.IdCalculadoraDemandaLiquidacion' + idexpediente).val() != '' &&
            (($('#tasainteresh' + idexpediente).val() != null && $('#tasainteresh' + idexpediente).val() != $('.TasaInteresCorrienteCalculadora' + idexpediente).val()) ||
            ($('#tasainteresmorah' + idexpediente).val() != null && $('#tasainteresmorah' + idexpediente).val() != $('.TasaInteresMoraCalculadora' + idexpediente).val())) ) {

            Swal.fire({
                title: 'Actualiza Calculadora',
                text: 'Modificar la tasa de interes puede ocacionar diferencias en los montos de la factura generada.',
              showCancelButton: true,
              confirmButtonText: 'Guardar',
              cancelButtonText: `Cancelar`,
            }).then((result) => {
              /* Read more about isConfirmed, isDenied below */
              if (result.isConfirmed) {
                  ActualizarCalculadora(contenedor, idexpediente);
              } else if (result.isDenied) {
              }
            })
        }
        else {

            ActualizarCalculadora(contenedor, idexpediente);
        }
    })

    function cancelar() {}

    //$(".btnActualizarCalculadora2").on("click", async function ()
    function ActualizarCalculadora(contenedor, idexpediente) {

        var modelo = $("#calcint" + idexpediente).getModel(),
        validate = true;

        if (modelo.TasaInteresCorriente > 100) {

            $container.find("small[for='TasaInteresCorriente']").text("* El campo no puede ser superior a 100");
            validate = false;

        }


        if (modelo.TasaInteresMora > 100) {

            $container.find("small[for='TasaInteresMora']").text("* El campo no puede ser superior a 100");
            validate = false;

        }

        if (!validate) return false;

        contenedor.find(".progressbar-container").show();
        contenedor.find(".progressbar-container *").attr("disabled", "disabled");

		var link = '@Url.Action("GuardarRegistro", controllerName)';

        $.ajax({
            type: "POST",
            contentType: 'application/json; charset=utf-8',
            url: link,
            data: JSON.stringify(modelo),
            success: function (mensaje) {
                contenedor.find(".progressbar-container").hide();
                Alerta('Guardar Registro Calculadora Demanda', mensaje, 'success', refrescar);
                window.location.reload();
            },
            error: function (jqXHR, textStatus, errorThrown) {
                contenedor.find("small[for]").text("");
                contenedor.find(".progressbar-container").hide();
                if (jqXHR.status == 409) {
                    var errors = jqXHR.responseJSON;
                    if (Array.isArray(errors)) {
                        for (var i = 0; i < errors.length; i++) {
                            var reg = errors[i];
                            if (reg.PropertyName !== undefined && reg.Message !== undefined) {
                                var $element = contenedor.find("small[for='_calculadora." + reg.PropertyName + "']");

                                if ($element !== undefined) {
                                    $element.text(reg.Message);
                                    $("#DetalleRegistro").find(".progressbar-container").hide();

                                }
                            }
                        }
                    }
                }
                else {
                    Alerta('Guardar Registro Calculadora Demanda', jqXHR.responseText, 'danger');
                }
            }
        });
    };

    function refrescar() {
        window.location.reload();
    }

    function habilitarInput(elemento, hideElemento) {

        if ($('#esadministrador').val().toUpperCase() == "TRUE") {
            if (hideElemento == '')
                elemento.removeAttribute("readonly");
            else {

                $('#' + elemento.parentNode.offsetParent.id).fadeOut();
                $('#' + hideElemento).fadeIn();
            }
        }
        else Alerta('Comuníquese con un supervisor para modificar este campo')

    }

    /******* Fin Calculadora *******/

    //Redireccionar y refrescar Tramite Detalle
    function RefrescarTramiteDetalleRedireccionarTab(IdTramiteJudicial, NumeroOperacion, p_IdExpediente, Tab) {
        var idtramitecobro =  IdTramiteJudicial;
        var Operacion = NumeroOperacion;
        var IdExpediente = p_IdExpediente;
        console.log("IdExpediente", IdExpediente)

        if (IdExpediente == null) {
            IdExpediente = 0;
        }

		var link = '@Url.Action("ConsultarDetalle", "TramiteDetalle", new { id = "p_idtramitecobro", operacion = "p_Operacion", IdExpediente = "p_IdExpediente", TabMostrar = "p_TabMostrar" })';
        link = link.replace("p_idtramitecobro", idtramitecobro).replace("p_Operacion", Operacion).replace("p_IdExpediente", IdExpediente).replace("p_TabMostrar", Tab);

		if (idtramitecobro !== null) {
			window.location.href = link;
		}
    }

</script>

<script src="~/js/Modulos/RematesAdjudicaciones/ExpedienteGarantia.js"></script>